<!DOCTYPE html><html lang="ja"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><link rel="icon" type="image/svg+xml" href="/logo.png"><link rel="canonical" href="https://astro-paper.pages.dev/posts/nextjs-openai-amotion-app/"><meta name="generator" content="Astro v3.2.3"><!-- General Meta Tags --><title>Next.jsã¨OpenAIã§æ„Ÿæƒ…åˆ†æã‚¢ãƒ—ãƒªã‚’ä½œã‚‹</title><meta name="title" content="Next.jsã¨OpenAIã§æ„Ÿæƒ…åˆ†æã‚¢ãƒ—ãƒªã‚’ä½œã‚‹"><meta name="description" content="Next.js13ã¨OpenAIã§æ„Ÿæƒ…åˆ†æã‚’ã—ã¦ãã‚Œã‚‹AIã‚¢ãƒ—ãƒªã®ä½œã‚Šæ–¹ã‚’è§£èª¬ã—ã¾ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼æ©Ÿèƒ½ã‚’ä½œã‚Šã€ãƒ¦ãƒ¼ã‚¶ãƒ¼IDã§æ„Ÿæƒ…åˆ†æãƒ‡ãƒ¼ã‚¿ã‚’ç®¡ç†ã—ã¾ã™ã€‚ãƒ‡ãƒ¼ã‚¿ã¯Prismaã‚’çµŒç”±ã—ã€Supabaseã«ä¿å­˜ã—ã¾ã™ã€‚æœ¬æ›¸ã§ã¯ãƒ•ãƒ«ã‚¹ã‚¿ãƒƒã‚¯ã‚¢ãƒ—ãƒªã‚’ä½œã‚Šä¸Šã’ã¾ã™ğŸ’ªã€‚æ‰€ã€…Next.jsã®ã‚³ãƒ¼ãƒ‰é€²è¡Œã®ãƒã‚¤ãƒ³ãƒˆã‚’è§£èª¬ã—ã¦ã„ã¾ã™ã€‚Next.jsã®å…¥é–€æ›¸ã¨ã—ã¦ã‚‚ãŠä½¿ã„é ‚ã‘ã‚‹å†…å®¹ã«ãªã£ã¦ãŠã‚Šã¾ã™ğŸ˜ƒ"><meta name="author" content="kapucode"><link rel="sitemap" href="/sitemap-index.xml"><!-- Open Graph / Facebook --><meta property="og:title" content="Next.jsã¨OpenAIã§æ„Ÿæƒ…åˆ†æã‚¢ãƒ—ãƒªã‚’ä½œã‚‹"><meta property="og:description" content="Next.js13ã¨OpenAIã§æ„Ÿæƒ…åˆ†æã‚’ã—ã¦ãã‚Œã‚‹AIã‚¢ãƒ—ãƒªã®ä½œã‚Šæ–¹ã‚’è§£èª¬ã—ã¾ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼æ©Ÿèƒ½ã‚’ä½œã‚Šã€ãƒ¦ãƒ¼ã‚¶ãƒ¼IDã§æ„Ÿæƒ…åˆ†æãƒ‡ãƒ¼ã‚¿ã‚’ç®¡ç†ã—ã¾ã™ã€‚ãƒ‡ãƒ¼ã‚¿ã¯Prismaã‚’çµŒç”±ã—ã€Supabaseã«ä¿å­˜ã—ã¾ã™ã€‚æœ¬æ›¸ã§ã¯ãƒ•ãƒ«ã‚¹ã‚¿ãƒƒã‚¯ã‚¢ãƒ—ãƒªã‚’ä½œã‚Šä¸Šã’ã¾ã™ğŸ’ªã€‚æ‰€ã€…Next.jsã®ã‚³ãƒ¼ãƒ‰é€²è¡Œã®ãƒã‚¤ãƒ³ãƒˆã‚’è§£èª¬ã—ã¦ã„ã¾ã™ã€‚Next.jsã®å…¥é–€æ›¸ã¨ã—ã¦ã‚‚ãŠä½¿ã„é ‚ã‘ã‚‹å†…å®¹ã«ãªã£ã¦ãŠã‚Šã¾ã™ğŸ˜ƒ"><meta property="og:url" content="https://astro-paper.pages.dev/posts/nextjs-openai-amotion-app/"><meta property="og:image" content="https://astro-paper.pages.dev/posts/nextjs%E3%81%A8openai%E3%81%A7%E6%84%9F%E6%83%85%E5%88%86%E6%9E%90%E3%82%A2%E3%83%97%E3%83%AA%E3%82%92%E4%BD%9C%E3%82%8B.png"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://astro-paper.pages.dev/posts/nextjs-openai-amotion-app/"><meta property="twitter:title" content="Next.jsã¨OpenAIã§æ„Ÿæƒ…åˆ†æã‚¢ãƒ—ãƒªã‚’ä½œã‚‹"><meta property="twitter:description" content="Next.js13ã¨OpenAIã§æ„Ÿæƒ…åˆ†æã‚’ã—ã¦ãã‚Œã‚‹AIã‚¢ãƒ—ãƒªã®ä½œã‚Šæ–¹ã‚’è§£èª¬ã—ã¾ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼æ©Ÿèƒ½ã‚’ä½œã‚Šã€ãƒ¦ãƒ¼ã‚¶ãƒ¼IDã§æ„Ÿæƒ…åˆ†æãƒ‡ãƒ¼ã‚¿ã‚’ç®¡ç†ã—ã¾ã™ã€‚ãƒ‡ãƒ¼ã‚¿ã¯Prismaã‚’çµŒç”±ã—ã€Supabaseã«ä¿å­˜ã—ã¾ã™ã€‚æœ¬æ›¸ã§ã¯ãƒ•ãƒ«ã‚¹ã‚¿ãƒƒã‚¯ã‚¢ãƒ—ãƒªã‚’ä½œã‚Šä¸Šã’ã¾ã™ğŸ’ªã€‚æ‰€ã€…Next.jsã®ã‚³ãƒ¼ãƒ‰é€²è¡Œã®ãƒã‚¤ãƒ³ãƒˆã‚’è§£èª¬ã—ã¦ã„ã¾ã™ã€‚Next.jsã®å…¥é–€æ›¸ã¨ã—ã¦ã‚‚ãŠä½¿ã„é ‚ã‘ã‚‹å†…å®¹ã«ãªã£ã¦ãŠã‚Šã¾ã™ğŸ˜ƒ"><meta property="twitter:image" content="https://astro-paper.pages.dev/posts/nextjs%E3%81%A8openai%E3%81%A7%E6%84%9F%E6%83%85%E5%88%86%E6%9E%90%E3%82%A2%E3%83%97%E3%83%AA%E3%82%92%E4%BD%9C%E3%82%8B.png"><!-- Google Font --><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:ital,wght@0,400;0,500;0,600;0,700;1,400;1,600&display=swap" rel="stylesheet"><meta name="theme-color" content=""><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><!-- google ã‚¢ãƒ‰ã‚»ãƒ³ã‚¹ã€€è¨­å®š --><!-- åºƒå‘Š --><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5112185578414045" crossorigin="anonymous"></script><!-- åºƒå‘Šæç›Šã®å›åç”³å‘Š --><script async src="https://fundingchoicesmessages.google.com/i/pub-5112185578414045?ers=1" nonce="HMJQo9KJ2O48OU1iQYuTKQ"></script><script nonce="HMJQo9KJ2O48OU1iQYuTKQ">
      (function () {
        function signalGooglefcPresent() {
          if (!window.frames["googlefcPresent"]) {
            if (document.body) {
              const iframe = document.createElement("iframe");
              iframe.style =
                "width: 0; height: 0; border: none; z-index: -1000; left: -1000px; top: -1000px;";
              iframe.style.display = "none";
              iframe.name = "googlefcPresent";
              document.body.appendChild(iframe);
            } else {
              setTimeout(signalGooglefcPresent, 0);
            }
          }
        }
        signalGooglefcPresent();
      })();
    </script><script src="/toggle-theme.js"></script><link rel="stylesheet" href="/_astro/index.555ecc1a.css" />
<style>.breadcrumb:where(.astro-ilhxcym7){margin-left:auto;margin-right:auto;margin-bottom:.25rem;margin-top:2rem;width:100%;max-width:48rem;padding-left:1rem;padding-right:1rem}.breadcrumb:where(.astro-ilhxcym7) ul:where(.astro-ilhxcym7) li:where(.astro-ilhxcym7){display:inline}.breadcrumb:where(.astro-ilhxcym7) ul:where(.astro-ilhxcym7) li:where(.astro-ilhxcym7) a:where(.astro-ilhxcym7){text-transform:capitalize;opacity:.7}.breadcrumb:where(.astro-ilhxcym7) ul:where(.astro-ilhxcym7) li:where(.astro-ilhxcym7) span:where(.astro-ilhxcym7){opacity:.7}.breadcrumb:where(.astro-ilhxcym7) ul:where(.astro-ilhxcym7) li:where(.astro-ilhxcym7):not(:last-child) a:where(.astro-ilhxcym7):hover{opacity:1}#main-content:where(.astro-hsp6otuf){margin-left:auto;margin-right:auto;width:100%;max-width:48rem;padding-left:1rem;padding-right:1rem;padding-bottom:3rem}#main-content:where(.astro-hsp6otuf) h1:where(.astro-hsp6otuf){font-size:1.5rem;line-height:2rem;font-weight:600}@media (min-width: 640px){#main-content:where(.astro-hsp6otuf) h1:where(.astro-hsp6otuf){font-size:1.875rem;line-height:2.25rem}}#main-content:where(.astro-hsp6otuf) p:where(.astro-hsp6otuf){margin-bottom:1.5rem;margin-top:.5rem;font-style:italic}
a:where(.astro-blwjyjpt){position:relative;text-decoration-line:underline;text-decoration-style:dashed}a:where(.astro-blwjyjpt):hover{top:-.125rem;--tw-text-opacity: 1;color:rgba(var(--color-accent),var(--tw-text-opacity))}a:where(.astro-blwjyjpt):focus-visible{padding:.25rem}a:where(.astro-blwjyjpt) svg:where(.astro-blwjyjpt){margin-right:-1.25rem;height:1.5rem;width:1.5rem;--tw-scale-x: .95;--tw-scale-y: .95;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));--tw-text-opacity: 1;color:rgba(var(--color-text-base),var(--tw-text-opacity));opacity:.8}.group:where(.astro-blwjyjpt):hover a:where(.astro-blwjyjpt) svg:where(.astro-blwjyjpt){fill:rgb(var(--color-accent))}
a:where(.astro-5eunqzkt):hover{--tw-text-opacity: 1;color:rgba(var(--color-accent),var(--tw-text-opacity))}
@keyframes astroFadeInOut{0%{opacity:1}to{opacity:0}}@keyframes astroFadeIn{0%{opacity:0}}@keyframes astroFadeOut{to{opacity:0}}@keyframes astroSlideFromRight{0%{transform:translate(100%)}}@keyframes astroSlideFromLeft{0%{transform:translate(-100%)}}@keyframes astroSlideToRight{to{transform:translate(100%)}}@keyframes astroSlideToLeft{to{transform:translate(-100%)}}@media (prefers-reduced-motion){::view-transition-group(*),::view-transition-old(*),::view-transition-new(*){animation:none!important}[data-astro-transition-scope]{animation:none!important}}
.social-icons:where(.astro-upu6fzxr){flex-wrap:wrap;justify-content:center;gap:.25rem}.link-button:where(.astro-upu6fzxr){padding:.5rem}.link-button:where(.astro-upu6fzxr):hover{--tw-rotate: 6deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}@media (min-width: 640px){.link-button:where(.astro-upu6fzxr){padding:.25rem}}footer:where(.astro-sz7xmlte){margin-bottom:2rem;width:100%}.footer-wrapper:where(.astro-sz7xmlte){display:flex;flex-direction:column;align-items:center;justify-content:space-around;padding-top:1.5rem;padding-bottom:1.5rem}@media (min-width: 640px){.footer-wrapper:where(.astro-sz7xmlte){flex-direction:row-reverse;padding-top:1rem;padding-bottom:1rem}}.link-button:where(.astro-sz7xmlte){margin-top:.25rem;margin-bottom:.25rem;padding:.5rem}.link-button:where(.astro-sz7xmlte):hover{--tw-rotate: 6deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.link-button:where(.astro-sz7xmlte) svg:where(.astro-sz7xmlte){--tw-scale-x: 1.25;--tw-scale-y: 1.25;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.copyright-wrapper:where(.astro-sz7xmlte){margin-top:.5rem;margin-bottom:.5rem;display:flex;flex-direction:column;align-items:center;white-space:nowrap}@media (min-width: 640px){.copyright-wrapper:where(.astro-sz7xmlte){flex-direction:row}}.separator:where(.astro-sz7xmlte){display:none}@media (min-width: 640px){.separator:where(.astro-sz7xmlte){display:inline}}
main:where(.astro-vj4tpspi){margin-left:auto;margin-right:auto;width:100%;max-width:48rem;padding-left:1rem;padding-right:1rem;padding-bottom:3rem}.post-title:where(.astro-vj4tpspi){font-size:1.5rem;line-height:2rem;font-weight:600;--tw-text-opacity: 1;color:rgba(var(--color-accent),var(--tw-text-opacity))}.tags-container:where(.astro-vj4tpspi){margin-top:2rem;margin-bottom:2rem}
.pagination-wrapper:where(.astro-eenky23y){margin-bottom:2rem;margin-top:auto;display:flex;justify-content:center}.disabled:where(.astro-eenky23y){pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none;opacity:.5}.disabled:where(.astro-eenky23y):hover{--tw-text-opacity: 1;color:rgba(var(--color-text-base),var(--tw-text-opacity))}.group:where(.astro-eenky23y):hover .disabled:where(.astro-eenky23y){fill:rgb(var(--color-text-base))}.group:where(.astro-eenky23y):hover .disabled-svg:where(.astro-eenky23y){fill:rgb(var(--color-text-base))!important}
</style><script type="module" src="/_astro/hoisted.064b2101.js"></script><style>[data-astro-transition-scope="astro-plk3gbjq-1"] { view-transition-name: nextjs_openai; }@layer astro { ::view-transition-old(nextjs_openai) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }::view-transition-new(nextjs_openai) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back]::view-transition-old(nextjs_openai) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back]::view-transition-new(nextjs_openai) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; } }[data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-plk3gbjq-1"],
			[data-astro-transition-fallback="old"][data-astro-transition-scope="astro-plk3gbjq-1"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-plk3gbjq-1"],
			[data-astro-transition-fallback="new"][data-astro-transition-scope="astro-plk3gbjq-1"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back][data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-plk3gbjq-1"],
			[data-astro-transition=back][data-astro-transition-fallback="old"][data-astro-transition-scope="astro-plk3gbjq-1"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back][data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-plk3gbjq-1"],
			[data-astro-transition=back][data-astro-transition-fallback="new"][data-astro-transition-scope="astro-plk3gbjq-1"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }</style><style>[data-astro-transition-scope="astro-36ssibgs-2"] { view-transition-name: nextjs; }@layer astro { ::view-transition-old(nextjs) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }::view-transition-new(nextjs) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back]::view-transition-old(nextjs) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back]::view-transition-new(nextjs) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; } }[data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-36ssibgs-2"],
			[data-astro-transition-fallback="old"][data-astro-transition-scope="astro-36ssibgs-2"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-36ssibgs-2"],
			[data-astro-transition-fallback="new"][data-astro-transition-scope="astro-36ssibgs-2"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back][data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-36ssibgs-2"],
			[data-astro-transition=back][data-astro-transition-fallback="old"][data-astro-transition-scope="astro-36ssibgs-2"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back][data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-36ssibgs-2"],
			[data-astro-transition=back][data-astro-transition-fallback="new"][data-astro-transition-scope="astro-36ssibgs-2"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }</style><style>[data-astro-transition-scope="astro-36ssibgs-3"] { view-transition-name: openai; }@layer astro { ::view-transition-old(openai) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }::view-transition-new(openai) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back]::view-transition-old(openai) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back]::view-transition-new(openai) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; } }[data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-36ssibgs-3"],
			[data-astro-transition-fallback="old"][data-astro-transition-scope="astro-36ssibgs-3"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-36ssibgs-3"],
			[data-astro-transition-fallback="new"][data-astro-transition-scope="astro-36ssibgs-3"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back][data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-36ssibgs-3"],
			[data-astro-transition=back][data-astro-transition-fallback="old"][data-astro-transition-scope="astro-36ssibgs-3"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back][data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-36ssibgs-3"],
			[data-astro-transition=back][data-astro-transition-fallback="new"][data-astro-transition-scope="astro-36ssibgs-3"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }</style><style>[data-astro-transition-scope="astro-36ssibgs-4"] { view-transition-name: prisma; }@layer astro { ::view-transition-old(prisma) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }::view-transition-new(prisma) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back]::view-transition-old(prisma) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back]::view-transition-new(prisma) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; } }[data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-36ssibgs-4"],
			[data-astro-transition-fallback="old"][data-astro-transition-scope="astro-36ssibgs-4"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-36ssibgs-4"],
			[data-astro-transition-fallback="new"][data-astro-transition-scope="astro-36ssibgs-4"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back][data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-36ssibgs-4"],
			[data-astro-transition=back][data-astro-transition-fallback="old"][data-astro-transition-scope="astro-36ssibgs-4"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back][data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-36ssibgs-4"],
			[data-astro-transition=back][data-astro-transition-fallback="new"][data-astro-transition-scope="astro-36ssibgs-4"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }</style><style>[data-astro-transition-scope="astro-36ssibgs-5"] { view-transition-name: supabase; }@layer astro { ::view-transition-old(supabase) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }::view-transition-new(supabase) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back]::view-transition-old(supabase) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back]::view-transition-new(supabase) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; } }[data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-36ssibgs-5"],
			[data-astro-transition-fallback="old"][data-astro-transition-scope="astro-36ssibgs-5"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-36ssibgs-5"],
			[data-astro-transition-fallback="new"][data-astro-transition-scope="astro-36ssibgs-5"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back][data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-36ssibgs-5"],
			[data-astro-transition=back][data-astro-transition-fallback="old"][data-astro-transition-scope="astro-36ssibgs-5"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back][data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-36ssibgs-5"],
			[data-astro-transition=back][data-astro-transition-fallback="new"][data-astro-transition-scope="astro-36ssibgs-5"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }</style><style>[data-astro-transition-scope="astro-36ssibgs-6"] { view-transition-name: clerk; }@layer astro { ::view-transition-old(clerk) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }::view-transition-new(clerk) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back]::view-transition-old(clerk) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back]::view-transition-new(clerk) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; } }[data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-36ssibgs-6"],
			[data-astro-transition-fallback="old"][data-astro-transition-scope="astro-36ssibgs-6"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-36ssibgs-6"],
			[data-astro-transition-fallback="new"][data-astro-transition-scope="astro-36ssibgs-6"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back][data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-36ssibgs-6"],
			[data-astro-transition=back][data-astro-transition-fallback="old"][data-astro-transition-scope="astro-36ssibgs-6"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back][data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-36ssibgs-6"],
			[data-astro-transition=back][data-astro-transition-fallback="new"][data-astro-transition-scope="astro-36ssibgs-6"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }</style></head><body><header class="astro-3ef6ksr2"><a id="skip-to-content" href="#main-content" class="astro-3ef6ksr2">Skip to content</a><div class="nav-container astro-3ef6ksr2"><div class="top-nav-wrap astro-3ef6ksr2"><a href="/" class="logo whitespace-nowrap astro-3ef6ksr2">ã‚«ãƒ—ã‚³ãƒ¼ãƒ‰</a><nav id="nav-menu" class="astro-3ef6ksr2"><button class="hamburger-menu focus-outline astro-3ef6ksr2" aria-label="Open Menu" aria-expanded="false" aria-controls="menu-items"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="menu-icon astro-3ef6ksr2"><line x1="7" y1="12" x2="21" y2="12" class="line astro-3ef6ksr2"></line><line x1="3" y1="6" x2="21" y2="6" class="line astro-3ef6ksr2"></line><line x1="12" y1="18" x2="21" y2="18" class="line astro-3ef6ksr2"></line><line x1="18" y1="6" x2="6" y2="18" class="close astro-3ef6ksr2"></line><line x1="6" y1="6" x2="18" y2="18" class="close astro-3ef6ksr2"></line></svg></button><ul id="menu-items" class="display-none sm:flex astro-3ef6ksr2"><li class="astro-3ef6ksr2"><a href="/posts" class=" astro-3ef6ksr2">
è¨˜äº‹ä¸€è¦§
</a></li><li class="astro-3ef6ksr2"><a href="/tags" class=" astro-3ef6ksr2">
ã‚¿ã‚°
</a></li><li class="astro-3ef6ksr2"><a href="/about" class=" astro-3ef6ksr2">
ãƒ¡ãƒ³ã‚¿ãƒ¼
</a></li><li class="astro-3ef6ksr2"><a href="/craft" class=" astro-3ef6ksr2">
åˆ¶ä½œ
</a></li><li class="astro-3ef6ksr2"><a href="/search" tabindex="0" class="group inline-block focus-outline p-3 sm:p-1  flex astro-3ef6ksr2 astro-5eunqzkt" aria-label="search" title="Search"><svg xmlns="http://www.w3.org/2000/svg" class="scale-125 sm:scale-100 astro-3ef6ksr2"><path d="M19.023 16.977a35.13 35.13 0 0 1-1.367-1.384c-.372-.378-.596-.653-.596-.653l-2.8-1.337A6.962 6.962 0 0 0 16 9c0-3.859-3.14-7-7-7S2 5.141 2 9s3.14 7 7 7c1.763 0 3.37-.66 4.603-1.739l1.337 2.8s.275.224.653.596c.387.363.896.854 1.384 1.367l1.358 1.392.604.646 2.121-2.121-.646-.604c-.379-.372-.885-.866-1.391-1.36zM9 14c-2.757 0-5-2.243-5-5s2.243-5 5-5 5 2.243 5 5-2.243 5-5 5z" class="astro-3ef6ksr2"></path></svg></a></li><li class="astro-3ef6ksr2"><button id="theme-btn" class="focus-outline astro-3ef6ksr2" title="Toggles light & dark" aria-label="auto" aria-live="polite"><svg xmlns="http://www.w3.org/2000/svg" id="moon-svg" class="astro-3ef6ksr2"><path d="M20.742 13.045a8.088 8.088 0 0 1-2.077.271c-2.135 0-4.14-.83-5.646-2.336a8.025 8.025 0 0 1-2.064-7.723A1 1 0 0 0 9.73 2.034a10.014 10.014 0 0 0-4.489 2.582c-3.898 3.898-3.898 10.243 0 14.143a9.937 9.937 0 0 0 7.072 2.93 9.93 9.93 0 0 0 7.07-2.929 10.007 10.007 0 0 0 2.583-4.491 1.001 1.001 0 0 0-1.224-1.224zm-2.772 4.301a7.947 7.947 0 0 1-5.656 2.343 7.953 7.953 0 0 1-5.658-2.344c-3.118-3.119-3.118-8.195 0-11.314a7.923 7.923 0 0 1 2.06-1.483 10.027 10.027 0 0 0 2.89 7.848 9.972 9.972 0 0 0 7.848 2.891 8.036 8.036 0 0 1-1.484 2.059z" class="astro-3ef6ksr2"></path></svg><svg xmlns="http://www.w3.org/2000/svg" id="sun-svg" class="astro-3ef6ksr2"><path d="M6.993 12c0 2.761 2.246 5.007 5.007 5.007s5.007-2.246 5.007-5.007S14.761 6.993 12 6.993 6.993 9.239 6.993 12zM12 8.993c1.658 0 3.007 1.349 3.007 3.007S13.658 15.007 12 15.007 8.993 13.658 8.993 12 10.342 8.993 12 8.993zM10.998 19h2v3h-2zm0-17h2v3h-2zm-9 9h3v2h-3zm17 0h3v2h-3zM4.219 18.363l2.12-2.122 1.415 1.414-2.12 2.122zM16.24 6.344l2.122-2.122 1.414 1.414-2.122 2.122zM6.342 7.759 4.22 5.637l1.415-1.414 2.12 2.122zm13.434 10.605-1.414 1.414-2.122-2.122 1.414-1.414z" class="astro-3ef6ksr2"></path></svg></button></li></ul></nav></div></div><div class="max-w-3xl mx-auto px-4"><hr class="border-skin-line" aria-hidden="true"></div></header><div class="mx-auto flex w-full max-w-3xl justify-start px-2 astro-vj4tpspi"><button class="focus-outline mb-2 mt-8 flex hover:opacity-75 astro-vj4tpspi" onclick="
      history.back()
      "><svg xmlns="http://www.w3.org/2000/svg" class="astro-vj4tpspi"><path d="M13.293 6.293 7.586 12l5.707 5.707 1.414-1.414L10.414 12l4.293-4.293z" class="astro-vj4tpspi"></path></svg><span class="astro-vj4tpspi">Go back</span></button></div><main id="main-content" class="astro-vj4tpspi"><h1 class="post-title astro-vj4tpspi" data-astro-transition-scope="astro-plk3gbjq-1">Next.jsã¨OpenAIã§æ„Ÿæƒ…åˆ†æã‚¢ãƒ—ãƒªã‚’ä½œã‚‹</h1><div class="flex items-center space-x-2 opacity-80 my-2 astro-vj4tpspi"><svg xmlns="http://www.w3.org/2000/svg" class="scale-100 inline-block h-6 w-6 fill-skin-base" aria-hidden="true"><path d="M7 11h2v2H7zm0 4h2v2H7zm4-4h2v2h-2zm0 4h2v2h-2zm4-4h2v2h-2zm0 4h2v2h-2z"></path><path d="M5 22h14c1.103 0 2-.897 2-2V6c0-1.103-.897-2-2-2h-2V2h-2v2H9V2H7v2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2zM19 8l.001 12H5V8h14z"></path></svg><span class="sr-only">Posted on:</span><span class="italic text-base">2023å¹´10æœˆ1æ—¥<span aria-hidden="true"> | </span><span class="sr-only">Â atÂ </span>00:22</span></div><article id="article" role="article" class="prose mx-auto mt-8 max-w-3xl astro-vj4tpspi"><p>*è£œè¶³:
ãƒ»ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ ã«Lexical(metaé–‹ç™ºã®ãƒªãƒƒãƒãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒ‡ã‚£ã‚¿)ã‚’ä½¿ã„ã¾ã™ãŒæœ¬æ›¸ã®è¶£æ—¨ã¨ã¯ç•°ãªã‚‹ã®ã§Lexicalã®è§£èª¬ã¯æ·±ãã—ã¦ãŠã‚Šã¾ã›ã‚“ã€‚ï¼ˆè¦æœ›ãŒã‚ã‚Œã°è¿½è¨˜ã„ãŸã—ã¾ã™ï¼‰
ãƒ»OpenAI APIã‚­ãƒ¼ã®å–å¾—ã«ã¯ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆç™»éŒ²ãŒå¿…è¦ã§ã™ã€‚(åˆã‚ã®3ãƒ¶æœˆã¯$18ã¾ã§APIã®åˆ©ç”¨ãŒç„¡æ–™ã§ã§ãã¾ã™)</p>
<h2 id="table-of-contents">Table of contents</h2>
<p></p><details><summary>Open Table of contents</summary><p></p>
<ul>
<li><a href="#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB">ã¯ã˜ã‚ã«</a>
<ul>
<li><a href="#%E4%BD%BF%E7%94%A8%E6%8A%80%E8%A1%93">ä½¿ç”¨æŠ€è¡“</a></li>
<li><a href="#%E9%96%8B%E7%99%BA%E5%86%85%E5%AE%B9">é–‹ç™ºå†…å®¹</a></li>
<li><a href="#%E4%BA%8B%E5%89%8D%E6%BA%96%E5%82%99">äº‹å‰æº–å‚™</a></li>
<li><a href="#%E3%83%AA%E3%83%9D%E3%82%B8%E3%83%88%E3%83%AA">ãƒªãƒã‚¸ãƒˆãƒª</a></li>
<li><a href="#%E8%B3%AA%E5%95%8F%E3%81%AA%E3%81%A9%E3%81%8A%E5%BE%85%E3%81%A1%E3%81%97%E3%81%A6%E3%81%BE%E3%81%99">è³ªå•ãªã©ãŠå¾…ã¡ã—ã¦ã¾ã™</a></li>
</ul>
</li>
<li><a href="#nextjs%E3%81%AE%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%82%92%E4%BD%9C%E6%88%90">Next.jsã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆ</a>
<ul>
<li><a href="#clerk%E3%81%AE%E3%82%A2%E3%83%97%E3%83%AA%E8%A8%AD%E5%AE%9A">clerkã®ã‚¢ãƒ—ãƒªè¨­å®š</a></li>
<li><a href="#clerk%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB">clerkã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</a></li>
</ul>
</li>
<li><a href="#clerk%E3%81%A7%E8%AA%8D%E8%A8%BC%E6%A9%9F%E8%83%BD%E3%82%92%E5%AE%9F%E8%A3%85">clerkã§èªè¨¼æ©Ÿèƒ½ã‚’å®Ÿè£…</a>
<ul>
<li><a href="#%E8%AA%8D%E8%A8%BC%E3%83%87%E3%82%A3%E3%83%AC%E3%82%AF%E3%83%88%E3%83%AA%E3%81%AE%E4%BD%9C%E6%88%90">èªè¨¼ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä½œæˆ</a></li>
<li><a href="#%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88%E3%82%92%E4%BD%9C%E6%88%90">ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½œæˆ</a></li>
<li><a href="#%E3%83%87%E3%82%A3%E3%83%AC%E3%82%AF%E3%83%88%E3%83%AA%E3%82%92%E4%BD%9C%E6%88%90">ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆ</a></li>
<li><a href="#%E3%83%87%E3%82%A3%E3%83%AC%E3%82%AF%E3%83%88%E3%83%AA%E3%82%92%E4%BD%9C%E6%88%90-1">ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆ</a></li>
<li><a href="#%E3%83%9A%E3%83%BC%E3%82%B8%E9%81%B7%E7%A7%BB%E7%94%A8%E3%81%AEsite%E3%81%AB%E3%83%8A%E3%83%93%E3%82%B2%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%83%90%E3%83%BC%E3%82%92%E4%BD%9C%E3%82%8B">ãƒšãƒ¼ã‚¸é·ç§»ç”¨ã®(site)ã«ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ã‚’ä½œã‚‹</a>
<ul>
<li><a href="#%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE%E8%A7%A3%E8%AA%AC">ã‚³ãƒ¼ãƒ‰ã®è§£èª¬</a></li>
<li><a href="#%E3%83%8A%E3%83%93%E3%82%B2%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%83%90%E3%83%BC%E3%82%92%E8%A1%A8%E7%A4%BA%E3%81%95%E3%81%9B%E3%82%8B">ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ã‚’è¡¨ç¤ºã•ã›ã‚‹</a></li>
</ul>
</li>
<li><a href="#%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB">ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</a></li>
<li><a href="#%E3%83%8E%E3%83%BC%E3%83%88%E3%83%9A%E3%83%BC%E3%82%B8%E3%81%AB%E3%83%86%E3%82%AD%E3%82%B9%E3%83%88%E3%82%A8%E3%83%87%E3%82%A3%E3%82%BF%E3%82%92%E8%A1%A8%E7%A4%BA%E3%81%95%E3%81%9B%E3%82%8B">ãƒãƒ¼ãƒˆãƒšãƒ¼ã‚¸ã«ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒ‡ã‚£ã‚¿ã‚’è¡¨ç¤ºã•ã›ã‚‹</a>
<ul>
<li><a href="#%E3%83%86%E3%82%AD%E3%82%B9%E3%83%88%E3%82%A8%E3%83%87%E3%82%A3%E3%82%BF%E3%81%AE%E3%82%B9%E3%82%BF%E3%82%A4%E3%83%AB%E3%82%92%E8%BF%BD%E5%8A%A0">ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒ‡ã‚£ã‚¿ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’è¿½åŠ </a></li>
<li><a href="#%E3%83%AD%E3%83%BC%E3%82%AB%E3%83%AB%E3%83%9B%E3%82%B9%E3%83%88%E3%82%92%E7%AB%8B%E3%81%A1%E4%B8%8A%E3%81%92%E3%81%A6%E7%A2%BA%E8%AA%8D%E3%81%97%E3%81%A6%E3%81%BF%E3%81%BE%E3%81%97%E3%82%87%E3%81%86">ãƒ­ãƒ¼ã‚«ãƒ«ãƒ›ã‚¹ãƒˆã‚’ç«‹ã¡ä¸Šã’ã¦ç¢ºèªã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</a></li>
<li><a href="#%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE%E8%A7%A3%E8%AA%AC-1">ã‚³ãƒ¼ãƒ‰ã®è§£èª¬</a></li>
<li><a href="#genaratebutton%E3%82%92%E4%BD%9C%E3%82%8A%E3%81%BE%E3%81%99">GenarateButtonã‚’ä½œã‚Šã¾ã™</a></li>
<li><a href="#%E3%82%B3%E3%83%BC%E3%83%89%E3%82%92%E8%A7%A3%E8%AA%AC">ã‚³ãƒ¼ãƒ‰ã‚’è§£èª¬</a></li>
<li><a href="#supabase%E3%82%BB%E3%83%83%E3%83%88%E3%82%A2%E3%83%83%E3%83%97">Supabaseã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—</a></li>
<li><a href="#prisma%E3%81%AE%E3%82%B9%E3%82%AD%E3%83%BC%E3%83%9E%E3%82%92%E4%BD%9C%E6%88%90">Prismaã®ã‚¹ã‚­ãƒ¼ãƒã‚’ä½œæˆ</a></li>
</ul>
</li>
<li><a href="#prisma%E3%81%AE%E3%83%87%E3%83%BC%E3%82%BF%E3%83%99%E3%83%BC%E3%82%B9%E3%81%AB%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9">Prismaã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹</a>
<ul>
<li><a href="#%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE%E8%A7%A3%E8%AA%AC-2">ã‚³ãƒ¼ãƒ‰ã®è§£èª¬</a></li>
</ul>
</li>
<li><a href="#api%E4%BD%9C%E6%88%90">APIä½œæˆ</a>
<ul>
<li><a href="#%E5%85%A8%E3%81%A6%E3%81%AE%E3%83%87%E3%83%BC%E3%82%BF%E3%82%92%E5%8F%96%E5%BE%97">å…¨ã¦ã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—</a>
<ul>
<li><a href="#%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE%E8%A7%A3%E8%AA%AC-3">ã‚³ãƒ¼ãƒ‰ã®è§£èª¬</a></li>
</ul>
</li>
<li><a href="#%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E4%BD%9C%E6%88%90">ãƒ‡ãƒ¼ã‚¿ã®ä½œæˆ</a>
<ul>
<li><a href="#%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE%E8%A7%A3%E8%AA%AC-4">ã‚³ãƒ¼ãƒ‰ã®è§£èª¬</a></li>
</ul>
</li>
<li><a href="#%E7%89%B9%E5%AE%9A%E3%81%AE%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AEapi%E3%82%92%E4%BD%9C%E6%88%90">ç‰¹å®šã®ãƒ‡ãƒ¼ã‚¿ã®APIã‚’ä½œæˆ</a>
<ul>
<li><a href="#%E3%83%87%E3%82%A3%E3%83%AC%E3%82%AF%E3%83%88%E3%83%AA%E3%82%92%E8%BF%BD%E5%8A%A0">ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’è¿½åŠ </a></li>
<li><a href="#%E6%8C%87%E5%AE%9A%E3%81%97%E3%81%9Fid%E3%81%AE%E3%83%87%E3%83%BC%E3%82%BF%E3%82%92%E5%8F%96%E5%BE%97">æŒ‡å®šã—ãŸidã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—</a></li>
</ul>
</li>
<li><a href="#%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE%E8%A7%A3%E8%AA%AC-5">ã‚³ãƒ¼ãƒ‰ã®è§£èª¬</a>
<ul>
<li><a href="#%E6%8C%87%E5%AE%9A%E3%81%97%E3%81%9Fid%E3%81%AE%E3%83%87%E3%83%BC%E3%82%BF%E3%82%92%E6%9B%B4%E6%96%B0">æŒ‡å®šã—ãŸidã®ãƒ‡ãƒ¼ã‚¿ã‚’æ›´æ–°</a></li>
</ul>
</li>
<li><a href="#%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE%E8%A7%A3%E8%AA%AC-6">ã‚³ãƒ¼ãƒ‰ã®è§£èª¬</a></li>
<li><a href="#%E6%8C%87%E5%AE%9A%E3%81%97%E3%81%9Fid%E3%81%AE%E5%89%8A%E9%99%A4">æŒ‡å®šã—ãŸIdã®å‰Šé™¤</a></li>
<li><a href="#%E6%8C%87%E5%AE%9A%E3%81%97%E3%81%9Fid%E3%81%AE%E6%84%9F%E6%83%85%E5%88%86%E6%9E%90%E7%B5%90%E6%9E%9C%E3%81%AE%E6%9B%B4%E6%96%B0">æŒ‡å®šã—ãŸIdã®æ„Ÿæƒ…åˆ†æçµæœã®æ›´æ–°</a>
<ul>
<li><a href="#%E3%83%87%E3%82%A3%E3%83%AC%E3%82%AF%E3%83%88%E3%83%AA%E3%81%AE%E8%BF%BD%E5%8A%A0">ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®è¿½åŠ </a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#%E6%8A%95%E7%A8%BF%E3%83%9C%E3%82%BF%E3%83%B3%E4%BD%9C%E6%88%90">æŠ•ç¨¿ãƒœã‚¿ãƒ³ä½œæˆ</a>
<ul>
<li>
<ul>
<li>
<ul>
<li><a href="#api%E3%83%87%E3%83%BC%E3%82%BF%E3%82%92%E3%83%95%E3%82%A7%E3%83%83%E3%83%81%E3%81%99%E3%82%8B%E3%81%9F%E3%82%81%E3%81%AE%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8%E3%82%92%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB">apiãƒ‡ãƒ¼ã‚¿ã‚’ãƒ•ã‚§ãƒƒãƒã™ã‚‹ãŸã‚ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</a></li>
<li><a href="#%E7%8A%B6%E6%85%8B%E7%AE%A1%E7%90%86%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8%E3%82%92%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB">çŠ¶æ…‹ç®¡ç†ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</a></li>
<li><a href="#%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88%E4%BD%9C%E6%88%90">ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆä½œæˆ</a></li>
<li><a href="#%E5%85%A8%E3%81%A6%E3%81%AE%E3%83%87%E3%83%BC%E3%82%BF%E3%82%92%E5%8F%96%E5%BE%97-1">å…¨ã¦ã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—</a></li>
</ul>
</li>
<li><a href="#post%E3%83%9C%E3%82%BF%E3%83%B3%E3%82%92%E4%BD%9C%E6%88%90">Postãƒœã‚¿ãƒ³ã‚’ä½œæˆ</a></li>
<li><a href="#%E3%82%B3%E3%83%BC%E3%83%89%E3%82%92%E8%A7%A3%E8%AA%AC-1">ã‚³ãƒ¼ãƒ‰ã‚’è§£èª¬</a></li>
</ul>
</li>
<li><a href="#%E3%83%87%E3%83%BC%E3%82%BF%E3%83%95%E3%82%A7%E3%83%83%E3%83%81">ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚§ãƒƒãƒ</a>
<ul>
<li><a href="#%E3%82%B5%E3%82%A4%E3%83%88%E3%81%AB%E8%BF%BD%E5%8A%A0%E3%81%97%E3%81%BE%E3%81%99">ã‚µã‚¤ãƒˆã«è¿½åŠ ã—ã¾ã™ã€‚</a></li>
</ul>
</li>
<li><a href="#%E3%83%86%E3%82%AD%E3%82%B9%E3%83%88id%E3%82%92%E7%AE%A1%E7%90%86%E3%81%99%E3%82%8B%E3%82%AB%E3%82%B9%E3%82%BF%E3%83%A0%E3%83%95%E3%83%83%E3%82%AF">ãƒ†ã‚­ã‚¹ãƒˆidã‚’ç®¡ç†ã™ã‚‹ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯</a></li>
<li><a href="#%E8%A1%A8%E7%A4%BA%E3%82%92%E5%88%87%E3%82%8A%E6%9B%BF%E3%81%88%E3%82%8B%E3%82%AB%E3%82%B9%E3%82%BF%E3%83%A0%E3%83%95%E3%83%83%E3%82%AF">è¡¨ç¤ºã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯</a></li>
<li><a href="#%E3%83%8E%E3%83%BC%E3%83%88%E3%83%9A%E3%83%BC%E3%82%B8%E3%81%AE%E8%A1%A8%E7%A4%BA%E3%83%AD%E3%82%B8%E3%83%83%E3%82%AF">ãƒãƒ¼ãƒˆãƒšãƒ¼ã‚¸ã®è¡¨ç¤ºãƒ­ã‚¸ãƒƒã‚¯</a>
<ul>
<li><a href="#%E3%82%B3%E3%83%BC%E3%83%89%E3%82%92%E8%A7%A3%E8%AA%AC-2">ã‚³ãƒ¼ãƒ‰ã‚’è§£èª¬</a></li>
<li><a href="#text%E3%81%AE%E4%B8%80%E7%95%AA%E5%88%9D%E3%82%81%E3%81%AE%E8%A1%8C%E3%81%AE%E3%83%86%E3%82%AD%E3%82%B9%E3%83%88%E3%81%A0%E3%81%91%E3%82%92%E5%8F%96%E5%BE%97">textã®ä¸€ç•ªåˆã‚ã®è¡Œã®ãƒ†ã‚­ã‚¹ãƒˆã ã‘ã‚’å–å¾—</a></li>
<li><a href="#processdata%E3%81%AF%E5%8F%96%E5%BE%97%E3%81%97%E3%81%9F%E3%83%86%E3%82%AD%E3%82%B9%E3%83%88%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AEtext%E3%81%AE%E4%B8%80%E7%95%AA%E5%88%9D%E3%82%81%E3%81%AE%E8%A1%8C%E3%81%AE%E3%83%86%E3%82%AD%E3%82%B9%E3%83%88%E3%81%A8json%E5%BD%A2%E5%BC%8F%E3%81%AE%E3%83%86%E3%82%AD%E3%82%B9%E3%83%88%E3%81%8C%E4%B8%80%E8%87%B4%E3%81%99%E3%82%8B%E3%81%8B%E6%A4%9C%E8%A8%BC%E3%81%99%E3%82%8B">processData()ã¯å–å¾—ã—ãŸãƒ†ã‚­ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®textã®ä¸€ç•ªåˆã‚ã®è¡Œã®ãƒ†ã‚­ã‚¹ãƒˆã¨JSONå½¢å¼ã®ãƒ†ã‚­ã‚¹ãƒˆãŒä¸€è‡´ã™ã‚‹ã‹æ¤œè¨¼ã™ã‚‹</a></li>
<li><a href="#%E5%AE%9F%E9%9A%9B%E3%81%AB%E7%94%BB%E9%9D%A2%E3%81%AE%E8%A1%A8%E7%A4%BA">å®Ÿéš›ã«ç”»é¢ã®è¡¨ç¤º</a></li>
</ul>
</li>
<li><a href="#%E3%83%86%E3%82%AD%E3%82%B9%E3%83%88%E3%82%A8%E3%83%87%E3%82%A3%E3%82%BF%E3%81%8C%E7%94%BB%E9%9D%A2%E3%81%AB%E8%A1%A8%E7%A4%BA%E3%81%97%E3%81%A6%E3%81%84%E3%82%8B%E3%82%B9%E3%83%86%E3%83%BC%E3%83%88%E3%82%92%E5%88%87%E3%82%8A%E6%9B%BF%E3%81%88%E3%82%8B">ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒ‡ã‚£ã‚¿ãŒç”»é¢ã«è¡¨ç¤ºã—ã¦ã„ã‚‹ã‚¹ãƒ†ãƒ¼ãƒˆã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹</a></li>
<li><a href="#%E3%83%9A%E3%83%BC%E3%82%B8%E3%81%AB%E8%BF%BD%E5%8A%A0">ãƒšãƒ¼ã‚¸ã«è¿½åŠ </a></li>
<li><a href="#%E5%8B%95%E4%BD%9C%E7%A2%BA%E8%AA%8D">å‹•ä½œç¢ºèª</a>
<ul>
<li><a href="#%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE%E8%A7%A3%E8%AA%AC-7">ã‚³ãƒ¼ãƒ‰ã®è§£èª¬</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#api%E3%82%92%E5%8F%A9%E3%81%84%E3%81%A6%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E6%9B%B4%E6%96%B0%E3%81%A8%E5%89%8A%E9%99%A4%E3%81%AE%E3%83%9C%E3%82%BF%E3%83%B3%E3%82%92%E4%BD%9C%E3%82%8A%E3%81%BE%E3%81%99">APIã‚’å©ã„ã¦ãƒ‡ãƒ¼ã‚¿ã®æ›´æ–°ã¨å‰Šé™¤ã®ãƒœã‚¿ãƒ³ã‚’ä½œã‚Šã¾ã™ã€‚</a></li>
<li><a href="#%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E6%9B%B4%E6%96%B0">ãƒ‡ãƒ¼ã‚¿ã®æ›´æ–°</a></li>
<li><a href="#%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E5%89%8A%E9%99%A4">ãƒ‡ãƒ¼ã‚¿ã®å‰Šé™¤</a></li>
<li><a href="#emotion%E3%82%92%E6%9B%B4%E6%96%B0">Emotionã‚’æ›´æ–°</a></li>
</ul>
<p></p></details><p></p>
<h2 id="ã¯ã˜ã‚ã«">ã¯ã˜ã‚ã«</h2>
<p>ã“ã®æœ¬ã¯Next.jsã¨OpenAIã‚’ä½¿ã„ã€ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒ‡ã‚£ã‚¿ã«æ–‡å­—ã‚’å…¥åŠ›ã™ã‚‹ã¨AIãŒå…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã«åŸºã¥ã„ã¦æ„Ÿæƒ…åˆ†æã‚’ã—ã¦ãã‚Œã‚‹ã‚¢ãƒ—ãƒªã§ã™ã€‚
æ„Ÿæƒ…åˆ†æçµæœã‚’supabaseã«ä¿å­˜ã™ã‚‹ã¨ã“ã‚ã¾ã§ã‚’å®Ÿè£…ã—ã¾ã™ã€‚</p>
<p>ãªãŠã€AIã®ãƒ­ã‚¸ãƒƒã‚¯ã‚’æ·±ãèª¬æ˜ã—ã¦ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚Next.jsã«ã©ã†ã‚„ã£ã¦AIã‚’çµ„ã¿è¾¼ã‚€ã‹ã¨è¨€ã†AIã‚µãƒ¼ãƒ“ã‚¹é–‹ç™ºã®å…¥é–€ã«ãªã‚Šã¾ã™ã€‚èª­è€…æ§˜è‡ªèº«ã®ã‚¢ã‚¤ãƒ‡ã‚¢ã®å½¢ã«ã™ã‚‹æ‰‹åŠ©ã‘ã‚’ã™ã‚‹ãŸã‚ã®æœ¬ã§ã™ã€‚</p>
<h3 id="ä½¿ç”¨æŠ€è¡“">ä½¿ç”¨æŠ€è¡“</h3>
<p>ã“ã®æœ¬ã§ã¯ä»¥ä¸‹ã®æŠ€è¡“ã‚’å–ã‚Šæ‰±ã„ã¾ã™ã€‚</p>
<ul>
<li>Next.js(Typescript)</li>
<li>Prisma(ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«ä½œæˆ)</li>
<li>supabaseï¼ˆãƒ‡ãƒ¼ã‚¿ç½®ãå ´)</li>
<li>clerk(ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼æ©Ÿèƒ½)</li>
</ul>
<p>Next.jsã§ã¯App routerã‚’ä½¿ç”¨ã—ã¾ã™ã€‚</p>
<h3 id="é–‹ç™ºå†…å®¹">é–‹ç™ºå†…å®¹</h3>
<p>é–‹ç™ºå†…å®¹ã¯ä»¥ä¸‹ã®ã¨ãŠã‚Šã§ã™ã€‚</p>
<ul>
<li>Prismaã§ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«ã®ä½œæˆæ–¹æ³•</li>
<li>Clerkã§ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼æ©Ÿèƒ½å®Ÿè£…æ–¹æ³•</li>
<li>OpenAIAPIã®ä½¿ã„æ–¹</li>
<li>ãƒ†ã‚­ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®åˆ†ææ–¹æ³•</li>
<li>supabaseã¸ãƒ‡ãƒ¼ã‚¿ã®æ ¼ç´æ–¹æ³•</li>
</ul>
<h3 id="äº‹å‰æº–å‚™">äº‹å‰æº–å‚™</h3>
<p>ãŠä½¿ã„ã®ãƒ‡ãƒã‚¤ã‚¹ã«ä»¥ä¸‹ã‚’ã‚¤ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãŠã„ã¦ãã ã•ã„</p>
<ul>
<li>node</li>
<li>npm(ã‚‚ã—ãã¯yarn)</li>
<li>ã‚³ãƒ¼ãƒ‰ã‚¨ãƒ‡ã‚£ã‚¿</li>
</ul>
<h3 id="ãƒªãƒã‚¸ãƒˆãƒª">ãƒªãƒã‚¸ãƒˆãƒª</h3>
<p>å®Œæˆã®ã‚³ãƒ¼ãƒ‰ã¯ã“ã¡ã‚‰ã§ã™ã€‚
<a href="https://github.com/ryotarofr/Emotional-analysis-apps">https://github.com/ryotarofr/Emotional-analysis-apps</a>
<br>
ãƒ‡ãƒ¢ã‚µã‚¤ãƒˆ
<a href="https://emotional-analysis-apps.vercel.app/">https://emotional-analysis-apps.vercel.app/</a></p>
<h3 id="è³ªå•ãªã©ãŠå¾…ã¡ã—ã¦ã¾ã™">è³ªå•ãªã©ãŠå¾…ã¡ã—ã¦ã¾ã™</h3>
<p>ã“ã“ãŒã‚ã‹ã‚Šã«ãã„ã¨ã‹è¬ã®ã‚¨ãƒ©ãƒ¼ãŒå‡ºãŸã¨ã‹ã‚ã‚Šã¾ã—ãŸã‚‰è³ªå•ã—ã¦ã„ãŸã ã‘ã‚Œã°éšæ™‚å¯¾å¿œã—ã¦ã„ãã¾ã™ã®ã§ã©ã‚“ã©ã‚“è³ªå•ã—ã¦ãã ã•ã„ã¾ã›ã€‚</p>
<h2 id="nextjsã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆ">Next.jsã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆ</h2>
<p>ä»Šå›ã¯Next.jsã®æœ€æ–°ç‰ˆã‚’ä½¿ã†ã®ã§ä»¥ä¸‹ã®ã‚ˆã†ãªã‚³ãƒãƒ³ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #61AFEF">npx</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">create-next-app@latest</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">./</span></span></code></pre>
<p>åˆæœŸè¨­å®šã«ã¤ã„ã¦èã‹ã‚Œã¾ã™ãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§å¤§ä¸ˆå¤«ä»¥ä¸‹ã®ã‚ˆã†ã«è¨­å®šã—ã¾ã™</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #abb2bf">Ok to proceed? (y) y</span></span>
<span class="line"><span style="color: #abb2bf">âœ” What is your project named? â€¦ ./</span></span>
<span class="line"><span style="color: #abb2bf">âœ” Would you like to use TypeScript? â€¦ Yes</span></span>
<span class="line"><span style="color: #abb2bf">âœ” Would you like to use ESLint? â€¦ Yes</span></span>
<span class="line"><span style="color: #abb2bf">âœ” Would you like to use Tailwind CSS? â€¦ Yes</span></span>
<span class="line"><span style="color: #abb2bf">âœ” Would you like to use `src/` directory? â€¦ Yes</span></span>
<span class="line"><span style="color: #abb2bf">âœ” Would you like to use App Router? (recommended) â€¦ Yes</span></span>
<span class="line"><span style="color: #abb2bf">âœ” Would you like to customize the default import alias? â€¦ No</span></span>
<span class="line"><span style="color: #abb2bf">...</span></span>
<span class="line"><span style="color: #abb2bf">Success!</span></span></code></pre>
<p>Success!ã¨è¡¨ç¤ºã•ã‚Œã‚Œã°å®Œäº†ã§ã™ã€‚</p>
<p>åˆæœŸè¨­å®šãŒçµ‚ã‚ã£ãŸã‚‰ãƒ–ãƒ©ã‚¦ã‚¶ã§ã‚’ç«‹ã¡ä¸Šã’ã¾ã™ã€‚
ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å…¥åŠ›ã—ã¦<a href="http://localhost:3000/%E3%82%92%E7%AB%8B%E3%81%A1%E4%B8%8A%E3%81%92%E3%81%A6%E3%81%8F%E3%81%A0%E3%81%95%E3%81%84">http://localhost:3000/ã‚’ç«‹ã¡ä¸Šã’ã¦ãã ã•ã„</a></p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #abb2bf">npm run dev</span></span></code></pre>
<p><img src="https://storage.googleapis.com/zenn-user-upload/8bbdd0ee5c05-20230927.png" alt="">
ã“ã®ã‚ˆã†ãªç”»é¢ãŒè¡¨ç¤ºã•ã‚Œã‚Œã°ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—å®Œäº†ã§ã™ã€‚
ã“ã‚Œã§æœ€åˆã®æº–å‚™ã¯æ•´ã„ã¾ã—ãŸã€‚ã†ã¾ãå‹•ã‹ãªã„å ´åˆã¯ç’°å¢ƒè¨­å®šãŒã†ã¾ãã„ã£ã¦ã„ãªã„å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã®ã§ã€ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãªã©ã‚’ç¢ºèªã—ã¦ã¿ã¦ãã ã•ã„ã€‚</p>
<p>ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¯é£›ã°ã—ã¦èª­ã¿é€²ã‚ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ã„ã‚‰ãªã„ã‚ˆã£ã¦æ–¹ã¯ä»¥é™ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¸ã€‚
clerkã‚’ä½¿ãˆã°ã¨ã¦ã‚‚ç°¡å˜ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼æ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
<a href="https://clerk.com/docs">clerkå…¬å¼ã‚µã‚¤ãƒˆ</a></p>
<br>
<br>
<h3 id="clerkã®ã‚¢ãƒ—ãƒªè¨­å®š">clerkã®ã‚¢ãƒ—ãƒªè¨­å®š</h3>
<p>å…¬å¼ã®ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãã ã•ã„ã€‚
Add applicationã‚’æŠ¼ã™ã¨ä»¥ä¸‹ã®ã‚ˆã†ãªç”»é¢ã«é·ç§»ã—ã¾ã™ã€‚
ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ãƒ ã‚’ä½¿ã†èªè¨¼ãƒ—ãƒ­ãƒã‚¤ãƒ€ã®è¨­å®šã‚’ã—ã¦create applicationã‚’æŠ¼ã—ã¾ã™ã€‚
ä»Šå›ã¯Email addresã¨Googleãƒ—ãƒ­ãƒã‚¤ãƒ€ã‚’ä½¿ã„ã¾ã™ã€‚
<img src="https://storage.googleapis.com/zenn-user-upload/596b563cdf8e-20230927.png" alt=""></p>
<p>ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«.env.localã‚’ä½œæˆã—APIã‚­ãƒ¼ã‚’è²¼ã‚Šä»˜ã‘ã¾ã™ã€‚
<img src="https://storage.googleapis.com/zenn-user-upload/5e675fa6dc82-20230927.png" alt=""></p>
<h3 id="clerkã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«">clerkã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</h3>
<p>ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã«ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’æ‰“ã¡è¾¼ã¿ã¾ã™</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #abb2bf">npm i @clerk/nextjs</span></span></code></pre>
<h2 id="clerkã§èªè¨¼æ©Ÿèƒ½ã‚’å®Ÿè£…">clerkã§èªè¨¼æ©Ÿèƒ½ã‚’å®Ÿè£…</h2>
<p>ã‚ã¾ã‚Šæœ¬è³ªçš„ãªéƒ¨åˆ†ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã®ã§ãµãƒ¼ã‚“ã£ã¦æ€ã£ã¦ã‚‚ã‚‰ãˆã‚Œã°å¤§ä¸ˆå¤«ã§ã™ã€‚ã‚³ãƒ”ãƒšã§æ§‹ã„ã¾ã›ã‚“ã€‚
ã¾ãšã¯ã€ã‚¢ãƒ—ãƒªå…¨ä½“ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ã‚’é©å¿œã•ã›ã¾ã™ã€‚
ClerkProviderã§ã‚¿ã‚°ã‚’ãƒ©ãƒƒãƒ—ã—ã¾ã™ã€‚
app/layout.tsx</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">ClerkProvider</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'@clerk/nextjs'</span></span>
<span class="line"><span style="color: #ABB2BF">...</span></span>
<span class="line"><span style="color: #ABB2BF">...</span></span>
<span class="line"><span style="color: #C678DD">export</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">default</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">RootLayout</span><span style="color: #ABB2BF">({</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75; font-style: italic">children</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">}: {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">children</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">React</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">ReactNode</span></span>
<span class="line"><span style="color: #ABB2BF">}) {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> (</span></span>
<span class="line"><span style="color: #ABB2BF">    &#x3C;</span><span style="color: #E5C07B">ClerkProvider</span><span style="color: #ABB2BF">> //è¿½åŠ </span></span>
<span class="line"><span style="color: #ABB2BF">      &#x3C;</span><span style="color: #E06C75">html</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">lang</span><span style="color: #56B6C2">=</span><span style="color: #98C379">"en"</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">        &#x3C;</span><span style="color: #E06C75">body</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">className</span><span style="color: #56B6C2">=</span><span style="color: #C678DD">{</span><span style="color: #E5C07B">inter</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">className</span><span style="color: #C678DD">}</span><span style="color: #ABB2BF">></span><span style="color: #C678DD">{</span><span style="color: #E06C75">children</span><span style="color: #C678DD">}</span><span style="color: #ABB2BF">&#x3C;/</span><span style="color: #E06C75">body</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">      &#x3C;/</span><span style="color: #E06C75">html</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">    &#x3C;/</span><span style="color: #E5C07B">ClerkProvider</span><span style="color: #ABB2BF">>ã€€ </span><span style="color: #7F848E; font-style: italic">//è¿½åŠ </span></span>
<span class="line"><span style="color: #ABB2BF">  )</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span>
<span class="line"></span></code></pre>
<h3 id="èªè¨¼ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä½œæˆ">èªè¨¼ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä½œæˆ</h3>
<p>ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«èªè¨¼ãƒšãƒ¼ã‚¸ã‚’ä½œæˆã—ã¦ã„ãã¾ã™ã€‚
src/appãƒ•ã‚©ãƒ«ãƒ€ã®ä¸­ã«æ¬¡ã®ãƒ•ã‚©ãƒ«ãƒ€ã¨ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¦ãã ã•ã„
<img src="https://storage.googleapis.com/zenn-user-upload/c4fd8bac720a-20230927.png" alt=""></p>
<p>Next.js13ã®App routerã§ã¯layout.tsxã‚„loading.tsxæ™‚ã¾ã£ãŸãƒšãƒ¼ã‚¸åãŒç”¨æ„ã•ã‚Œã¦ã„ã¾ã™ã€‚
layout.tsxã¯å…±é€šã™ã‚‹ã‚¹ã‚¿ã‚¤ãƒ«ã‚„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ç®¡ç†ã§ãã¾ã™ã€‚
(auth)ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œã‚‹ã“ã¨ã§(auth)ãƒšãƒ¼ã‚¸ã ã‘ã®layout.tsxã‚’ä½œã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
(auth)/layout.tsxã¨ã™ã‚‹ã“ã¨ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ç”»é¢ã®å…±é€šãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’è¦ªã®app/layout.tsxã‚’åˆ†ã‘ã¦æ±ºã‚ã‚‹ã“ã¨ãŒã§ãæµã®ã§ã‚ˆã‚ŠæŸ”è»Ÿã«é–‹ç™ºãŒã§ãã¾ã™ã€‚</p>
<p>app/(auth)/layout.tsx</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">AuthLayout</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> ({</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">children</span></span>
<span class="line"><span style="color: #ABB2BF">}: {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">children</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">React</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">ReactNode</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">}) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> (</span></span>
<span class="line"><span style="color: #ABB2BF">    &#x3C;</span><span style="color: #E06C75">main</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">className</span><span style="color: #56B6C2">=</span><span style="color: #98C379">"min-h-screen flex items-center justify-center"</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #C678DD">{</span><span style="color: #E06C75">children</span><span style="color: #C678DD">}</span></span>
<span class="line"><span style="color: #ABB2BF">    &#x3C;/</span><span style="color: #E06C75">main</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">  );</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">export</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">default</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">AuthLayout</span><span style="color: #ABB2BF">;</span></span></code></pre>
<p>ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ç®¡ç†ã™ã‚‹ãƒ•ã‚©ãƒ«ãƒ€ã‚’ä½œã‚Šã¾ã™ã€‚
ä»¥ä¸‹ã®ãƒ•ã‚©ãƒ«ãƒ€ã¨ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œã£ã¦ãã ã•ã„
<strong>app/components/ui</strong>
ä»Šå›ã¯uiã¨ã„ã†ãƒ•ã‚©ãƒ«ãƒ€ã§ãƒœã‚¿ãƒ³ãªã©ã®uiã‚’ç®¡ç†ã—ã¾ã™ã€‚
ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆã«ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã™ã‚‹uiã‚’è¿½åŠ ã—ã¾ã™ã€‚
empty.pngã¯æ·»ä»˜ã—ãŸgithubã®publicãƒ•ã‚©ãƒ«ãƒ€ã«ã‚ã‚‚ã®ã‚’ä½¿ã£ã¦ãã ã•ã„ã€‚</p>
<p>components/ui/empty.tsx</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">Image</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"next/image"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">interface</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">EmptyProps</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">label</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">export</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">Empty</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> ({</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">label</span></span>
<span class="line"><span style="color: #ABB2BF">}: </span><span style="color: #E5C07B">EmptyProps</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> (</span></span>
<span class="line"><span style="color: #ABB2BF">    &#x3C;</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">className</span><span style="color: #56B6C2">=</span><span style="color: #98C379">"h-full p-20 flex flex-col items-center justify-center"</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">      &#x3C;</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">className</span><span style="color: #56B6C2">=</span><span style="color: #98C379">"relative h-72 w-72"</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">        &#x3C;</span><span style="color: #E5C07B">Image</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">src</span><span style="color: #56B6C2">=</span><span style="color: #98C379">"/empty.png"</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">fill</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">alt</span><span style="color: #56B6C2">=</span><span style="color: #98C379">"Empty"</span><span style="color: #ABB2BF"> /></span></span>
<span class="line"><span style="color: #ABB2BF">      &#x3C;/</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">      &#x3C;</span><span style="color: #E06C75">p</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">className</span><span style="color: #56B6C2">=</span><span style="color: #98C379">"text-muted-foreground text-sm text-center"</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #C678DD">{</span><span style="color: #E06C75">label</span><span style="color: #C678DD">}</span></span>
<span class="line"><span style="color: #ABB2BF">      &#x3C;/</span><span style="color: #E06C75">p</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">    &#x3C;/</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">  );</span></span>
<span class="line"><span style="color: #ABB2BF">};</span></span></code></pre>
<p>ã‚¨ãƒ©ãƒ¼ãƒšãƒ¼ã‚¸ã‚’ä½œã‚Šã¾ã™ã€‚
:::message
ãƒã‚¤ãƒ³ãƒˆ
empty.tsxã«propsã‚’æŒãŸã›ã¦ã„ã¾ã™
label=â€œSomething went wrong.â€
ã“ã®ã‚ˆã†ã«ã™ã‚‹ã“ã¨ã§ã‚¨ãƒ©ãƒ¼ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å†…å®¹ã‚’ã‚’ãƒšãƒ¼ã‚¸ã”ã¨ã«å¤‰æ›´ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™
:::
â€œuse clientâ€ã¨è¡¨è¨˜ã™ã‚‹ã®ã¯Next.js13ã®app routerã§ã¯<strong>ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ</strong>ã«ãªã£ã¦ã„ã‚‹ã®ã§ã€Œ<strong>ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰ã®ã‚³ãƒ¼ãƒ‰ã§ã™ã‚ˆ</strong>ã€ã¨Next.jsã«æ•™ãˆã¦ã‚ã’ã‚‹ãŸã‚ã§ã™ã€‚
ã€€ã‚¨ãƒ©ãƒ¼ã¯ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰ã§è¡¨ç¤ºã•ã›ã‚‹ã®ã§ã“ã®ã‚ˆã†ãªè¨˜è¿°ãŒå¿…è¦ã«ãªã‚‹ã‚ã‘ã§ã™ã€‚
app/(auth)/error.tsx</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #98C379">"use client"</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">Empty</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"../components/ui/empty"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">Error</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> () </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> (</span></span>
<span class="line"><span style="color: #ABB2BF">    &#x3C;</span><span style="color: #E5C07B">Empty</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">label</span><span style="color: #56B6C2">=</span><span style="color: #98C379">"Something went wrong."</span><span style="color: #ABB2BF"> /></span></span>
<span class="line"><span style="color: #ABB2BF">  );</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">export</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">default</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">Error</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span></code></pre>
<p>ã‚µã‚¤ãƒ³ã‚¤ãƒ³ãƒ»ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—ã®ãƒšãƒ¼ã‚¸ã‚’è¿½åŠ ã—ã¾ã™ã€‚
ã“ã‚Œã‚‚ç°¡å˜ãªã‚³ãƒ¼ãƒ‰ã§ã™ã€‚
(auth)/sign-in/[[â€¦sign-in]]/page.tsx</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">SignIn</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"@clerk/nextjs"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">export</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">default</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">Page</span><span style="color: #ABB2BF">() {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> &#x3C;</span><span style="color: #E5C07B">SignIn</span><span style="color: #ABB2BF"> />;</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span></code></pre>
<p>(auth)/sign-up/[[â€¦sign-up]]/page.tsx</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">SignUp</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"@clerk/nextjs"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">export</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">default</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">Page</span><span style="color: #ABB2BF">() {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> &#x3C;</span><span style="color: #E5C07B">SignUp</span><span style="color: #ABB2BF"> />;</span></span>
<span class="line"><span style="color: #ABB2BF">};</span></span></code></pre>
<p>ã‚³ãƒ¼ãƒ‰ãŒæ›¸ã‘ãŸã‚‰ã€€<a href="http://localhost:3000/">http://localhost:3000/</a>ã€€ãŒä»¥ä¸‹ã®ã‚ˆã†ãªè¡¨ç¤ºã«ãªã‚Šã¾ã™ã€‚</p>
<p><img src="https://storage.googleapis.com/zenn-user-upload/8f4ccd7a99c2-20230927.png" alt=""></p>
<p>ã—ã‹ã—ã€ãƒšãƒ¼ã‚¸ã«å…¥ã£ãŸã‚‰ã™ãã«ãƒ­ã‚°ã‚¤ãƒ³ã—ã£ã¦ã¦ã®ã¯ã‚¢ãƒ—ãƒªã¨ã—ã¦ã¯å¤‰ã§ã™ã‚ˆã­ã€‚
ãã“ã§ã€publicRoutesã¨ã„ã†ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãªãã¦ã‚‚ã¿ã‚Œã¾ã™ã‚ˆã£ã¦è¨˜è¿°ã‚’ã—ã¦ã„ãã¾ã™ã€‚
ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œã‚Šã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãã¾ã™ã€‚
src/middleware.ts</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">authMiddleware</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"@clerk/nextjs"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">export</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">default</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">authMiddleware</span><span style="color: #ABB2BF">({</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">publicRoutes</span><span style="color: #ABB2BF">: [</span><span style="color: #98C379">"/"</span><span style="color: #ABB2BF">],</span></span>
<span class="line"><span style="color: #ABB2BF">});</span></span></code></pre>
<p>ã“ã‚Œã§ <a href="http://localhost:3000/">http://localhost:3000/</a> ã®ãƒšãƒ¼ã‚¸ã§èªè¨¼ãƒšãƒ¼ã‚¸ã«é·ç§»ã—ãªã„ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</p>
<p>ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚’è¦‹ã‚‹ã¨</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #61AFEF">Clerk:</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">The</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">middleware</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">was</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">skipped</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">for</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">this</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">request</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">URL:</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">http://localhost:3000/_next/static/chunks/app/page.js.</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">For</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">performance</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">reasons,</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">it's recommended to your middleware matcher to:</span></span>
<span class="line"><span style="color: #98C379">export const config = {</span></span>
<span class="line"><span style="color: #98C379">  matcher: ["/((?!.+\\.[\\w]+$|_next).*)","/","/(api|trpc)(.*)"],</span></span>
<span class="line"><span style="color: #98C379">};</span></span></code></pre>
<p>ã“ã®ã‚ˆã†ãªè¡¨è¨˜ã•ã‚Œã¦ã„ã‚‹ã®ã§ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã«è¿½è¨˜ã—ã¾ã™ã€‚
ã“ã‚Œã¯Next.jsã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚’ã„ã„æ„Ÿã˜ã«ã—ã¦ãã‚Œã‚‹ãŠã¾ã˜ãªã„ã ã¨ã„ã†èªè­˜ã§å¤§ä¸ˆå¤«ã§ã™ã€‚
src/middleware.ts</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">authMiddleware</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"@clerk/nextjs"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">export</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">default</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">authMiddleware</span><span style="color: #ABB2BF">({</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">publicRoutes</span><span style="color: #ABB2BF">: [</span><span style="color: #98C379">"/"</span><span style="color: #ABB2BF">],</span></span>
<span class="line"><span style="color: #ABB2BF">});</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">//è¿½åŠ </span></span>
<span class="line"><span style="color: #C678DD">export</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">config</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">matcher</span><span style="color: #ABB2BF">: [</span><span style="color: #98C379">"/((?!.*</span><span style="color: #56B6C2">\\</span><span style="color: #98C379">..*|_next).*)"</span><span style="color: #ABB2BF">, </span><span style="color: #98C379">"/"</span><span style="color: #ABB2BF">, </span><span style="color: #98C379">"/(api|trpc)(.*)"</span><span style="color: #ABB2BF">],</span></span>
<span class="line"><span style="color: #ABB2BF">};</span></span></code></pre>
<p>ãã—ã¦ã€ã‚µã‚¤ãƒ³ã‚¤ãƒ³ãƒ»ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—ãŒå®Œäº†ã—ãŸã‚‰ã©ã“ã®ãƒšãƒ¼ã‚¸ã«é·ç§»ã™ã‚‹ã‹ã‚‚æ±ºã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
.env.localã«ä»¥ä¸‹ã®è¨˜è¿°ã‚’ã—ã¦ãã ã•ã„
ä»Šå›ã¯/noteã¨ã„ã†ãƒšãƒ¼ã‚¸ã«é·ç§»ã™ã‚‹ã“ã¨ã«ã—ã¾ã™ã€‚
.env.local</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #abb2bf">//è¿½åŠ </span></span>
<span class="line"><span style="color: #abb2bf">NEXT_PUBLIC_CLERK_SIGN_IN_URL=/sign-in</span></span>
<span class="line"><span style="color: #abb2bf">NEXT_PUBLIC_CLERK_SIGN_UP_URL=/sign-up</span></span>
<span class="line"><span style="color: #abb2bf">NEXT_PUBLIC_CLERK_AFTER_SIGN_IN_URL=/note</span></span>
<span class="line"><span style="color: #abb2bf">NEXT_PUBLIC_CLERK_AFTER_SIGN_UP_URL=/note</span></span></code></pre>
<h3 id="ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½œæˆ">ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½œæˆ</h3>
<p>Navbarã«èªè¨¼ãƒœã‚¿ãƒ³ã‚’å…¥ã‚Œã¦ã„ãã¾ã™ã€‚
components/Navbar/landing-navbar.tsx
ã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œã‚Šã¾ã™ã€‚
ãã“ã«clerkã‹ã‚‰ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’å‘¼ã³å‡ºã—ã¾ã™ã€‚
/landing-navbar.tsx</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #98C379">"use client"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">Link</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"next/link"</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">useAuth</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"@clerk/nextjs"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">export</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">LandingNavbar</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> () </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> { </span><span style="color: #E5C07B">isSignedIn</span><span style="color: #ABB2BF"> } </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">useAuth</span><span style="color: #ABB2BF">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> (</span></span>
<span class="line"><span style="color: #ABB2BF">    &#x3C;</span><span style="color: #E06C75">nav</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">        &#x3C;</span><span style="color: #E5C07B">Link</span></span>
<span class="line"><span style="color: #ABB2BF">          </span><span style="color: #D19A66; font-style: italic">href</span><span style="color: #56B6C2">=</span><span style="color: #C678DD">{</span><span style="color: #E06C75">isSignedIn</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">?</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"/note"</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">:</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"/sign-up"</span><span style="color: #C678DD">}</span></span>
<span class="line"><span style="color: #ABB2BF">        ></span></span>
<span class="line"><span style="color: #ABB2BF">          ãƒ­ã‚°ã‚¤ãƒ³</span></span>
<span class="line"><span style="color: #ABB2BF">        &#x3C;/</span><span style="color: #E5C07B">Link</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">    &#x3C;/</span><span style="color: #E06C75">nav</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">  )</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span>
<span class="line"></span></code></pre>
<p>Tailwindcssã§å°‘ã—ã‚¹ã‚¿ã‚¤ãƒ«ã‚’å½“ã¦ã¾ã™ã€‚
/landing-navbar.tsx</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #98C379">"use client"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">Image</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"next/image"</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">Link</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"next/link"</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">useAuth</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"@clerk/nextjs"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">export</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">LandingNavbar</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> () </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> { </span><span style="color: #E5C07B">isSignedIn</span><span style="color: #ABB2BF"> } </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">useAuth</span><span style="color: #ABB2BF">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> (</span></span>
<span class="line"><span style="color: #ABB2BF">    &#x3C;</span><span style="color: #E06C75">nav</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #D19A66; font-style: italic">className</span><span style="color: #56B6C2">=</span><span style="color: #98C379">"mx-4 py-8 bg-transparent flex items-center justify-between</span></span>
<span class="line"><span style="color: #98C379">      md:mx-20</span></span>
<span class="line"><span style="color: #98C379">    "</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">      &#x3C;</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">className</span><span style="color: #56B6C2">=</span><span style="color: #98C379">"flex items-center gap-x-2"</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">        &#x3C;</span><span style="color: #E5C07B">Link</span></span>
<span class="line"><span style="color: #ABB2BF">          </span><span style="color: #D19A66; font-style: italic">href</span><span style="color: #56B6C2">=</span><span style="color: #C678DD">{</span><span style="color: #E06C75">isSignedIn</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">?</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"/note"</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">:</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"/sign-up"</span><span style="color: #C678DD">}</span></span>
<span class="line"><span style="color: #ABB2BF">          </span><span style="color: #D19A66; font-style: italic">className</span><span style="color: #56B6C2">=</span><span style="color: #98C379">"no-underline text-white bg-indigo-900 px-4 py-2 rounded-full hover:bg-indigo-800"</span></span>
<span class="line"><span style="color: #ABB2BF">        ></span></span>
<span class="line"><span style="color: #ABB2BF">          ãƒ­ã‚°ã‚¤ãƒ³</span></span>
<span class="line"><span style="color: #ABB2BF">        &#x3C;/</span><span style="color: #E5C07B">Link</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">      &#x3C;/</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">    &#x3C;/</span><span style="color: #E06C75">nav</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">  )</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span></code></pre>
<p>ä½œã£ãŸã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’è¡¨ç¤ºã•ã›ã¾ã™
src/app/page.tsx</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #7F848E; font-style: italic">//...</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">LandingNavbar</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'./components/Navbar/landing-navbar'</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">export</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">default</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">Home</span><span style="color: #ABB2BF">() {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> (</span></span>
<span class="line"><span style="color: #ABB2BF">    &#x3C;</span><span style="color: #E06C75">main</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">className</span><span style="color: #56B6C2">=</span><span style="color: #98C379">"flex min-h-screen flex-col items-center justify-between p-24"</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">      &#x3C;</span><span style="color: #E5C07B">LandingNavbar</span><span style="color: #ABB2BF"> /> //è¿½åŠ </span></span>
<span class="line"><span style="color: #ABB2BF">     // ...çœç•¥</span></span>
<span class="line"><span style="color: #ABB2BF">    &#x3C;/</span><span style="color: #E06C75">main</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">  )</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span>
<span class="line"></span></code></pre>
<p>ãƒ­ã‚°ã‚¤ãƒ³ãƒœã‚¿ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã‹ãƒ­ãƒ¼ã‚«ãƒ«ãƒ›ã‚¹ãƒˆã‚’ç«‹ã¡ä¸Šã’ã¦ç¢ºèªã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚
å®Ÿéš›ã«ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã¿ã‚‹ã¨/noteã«ãƒšãƒ¼ã‚¸é·ç§»ã—ã¾ã™ã€‚
<img src="https://storage.googleapis.com/zenn-user-upload/c64d3984e42e-20230928.png" alt=""></p>
<p>ã“ã‚Œã§èªè¨¼æ©Ÿèƒ½ã¯å‡ºæ¥ä¸ŠãŒã‚Šã§ã™ã€‚</p>
<br>
<br>
Noteãƒšãƒ¼ã‚¸ã§ã¯ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚©ãƒ¼ãƒ ã‚’ä½œã‚Šã¾ã™ã€‚
<h3 id="ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆ">ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆ</h3>
<p>ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã—ã¾ã™ã€‚
app/(site)/layout.tsx
app/(site)/(routes)/note/page.tsx
(auth)ã®æ™‚ã¨åŒã˜ã‚ˆã†ã«ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œã‚Šã¾ã—ã™ã€‚
(site)ã¨ã„ã†åå‰ã«ã—ã¾ã—ãŸãŒã€ãªã‚“ã§ã‚‚ã„ã„ã§ã™ã€‚
(routes)ãƒ•ã‚©ãƒ«ãƒ€ã¯å€‹äººçš„ã«ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒ2ã¤ä»¥ä¸Šã«ãªã‚‹å ´åˆã¯ã‚ã£ãŸã»ã†ãŒã„ã„ã‹ãªã¨æ€ã„ã¾ã™ã€‚
<img src="https://storage.googleapis.com/zenn-user-upload/c5a447251b8b-20230928.png" alt=""></p>
<p>ãƒšãƒ¼ã‚¸ã®ç·¨é›†ã‚’ã—ã¦ã„ãã¾ã™ã€‚
(site)/layout.tsx</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">SiteLayout</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> ({</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">children</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">}: {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">children</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">React</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">ReactNode</span></span>
<span class="line"><span style="color: #ABB2BF">}) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> (</span></span>
<span class="line"><span style="color: #ABB2BF">    &#x3C;</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #C678DD">{</span><span style="color: #E06C75">children</span><span style="color: #C678DD">}</span></span>
<span class="line"><span style="color: #ABB2BF">    &#x3C;/</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">  )</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">export</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">default</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">SiteLayout</span></span></code></pre>
<p>(site)/(routes)/note/page.tsx</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">NotePage</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> () </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #C678DD">return</span><span style="color: #ABB2BF">(&#x3C;></span></span>
<span class="line"><span style="color: #ABB2BF">	&#x3C;</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">>note&#x3C;/</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">&#x3C;/>)</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span></code></pre>
<p>è¦‹æ „ãˆãŒæ‚ªã„ã®ã§global.cssã‚’ä¿®æ­£ã—ã¾ã™ã€‚
app/global.css</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">@tailwind</span><span style="color: #ABB2BF"> base;</span></span>
<span class="line"><span style="color: #C678DD">@tailwind</span><span style="color: #ABB2BF"> components;</span></span>
<span class="line"><span style="color: #C678DD">@tailwind</span><span style="color: #ABB2BF"> utilities;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">/* ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆ */</span></span>
<span class="line"><span style="color: #7F848E; font-style: italic">/* :root {</span></span>
<span class="line"><span style="color: #7F848E; font-style: italic">  --foreground-rgb: 0, 0, 0;</span></span>
<span class="line"><span style="color: #7F848E; font-style: italic">  --background-start-rgb: 214, 219, 220;</span></span>
<span class="line"><span style="color: #7F848E; font-style: italic">  --background-end-rgb: 255, 255, 255;</span></span>
<span class="line"><span style="color: #7F848E; font-style: italic">} */</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">@media</span><span style="color: #ABB2BF"> (prefers-color-scheme: dark) {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #56B6C2">:root</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">--foreground-rgb</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">255</span><span style="color: #ABB2BF">, </span><span style="color: #D19A66">255</span><span style="color: #ABB2BF">, </span><span style="color: #D19A66">255</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">--background-start-rgb</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">0</span><span style="color: #ABB2BF">, </span><span style="color: #D19A66">0</span><span style="color: #ABB2BF">, </span><span style="color: #D19A66">0</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">--background-end-rgb</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">0</span><span style="color: #ABB2BF">, </span><span style="color: #D19A66">0</span><span style="color: #ABB2BF">, </span><span style="color: #D19A66">0</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  }</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E06C75">body</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  color: </span><span style="color: #56B6C2">rgb</span><span style="color: #ABB2BF">(</span><span style="color: #56B6C2">var</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">--foreground-rgb</span><span style="color: #ABB2BF">));</span></span>
<span class="line"><span style="color: #ABB2BF">  background: </span><span style="color: #56B6C2">linear-gradient</span><span style="color: #ABB2BF">(</span></span>
<span class="line"><span style="color: #ABB2BF">      to </span><span style="color: #D19A66">bottom</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #D19A66">transparent</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #56B6C2">rgb</span><span style="color: #ABB2BF">(</span><span style="color: #56B6C2">var</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">--background-end-rgb</span><span style="color: #ABB2BF">))</span></span>
<span class="line"><span style="color: #ABB2BF">    )</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #56B6C2">rgb</span><span style="color: #ABB2BF">(</span><span style="color: #56B6C2">var</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">--background-start-rgb</span><span style="color: #ABB2BF">));</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span></code></pre>
<br>
<br>
<p>ãƒãƒ£ãƒ¼ãƒˆãƒšãƒ¼ã‚¸ã§ã¯ã€æ„Ÿæƒ…åˆ†æã®çµæœã‚’ã‚°ãƒ©ãƒ•ã«æç”»ã—ã¦ã„ãã¾ã™ã€‚</p>
<h3 id="ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆ-1">ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆ</h3>
<p>noteã¨åŒã˜ã‚ˆã†ã«ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã—ã¾ã™ã€‚
app/(site)/(routes)/chart/page.tsx</p>
<p>ãƒšãƒ¼ã‚¸ã®ç·¨é›†ã‚’ã—ã¦ã„ãã¾ã™ã€‚
(site)/(routes)/chart/page.tsx</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">ChartPage</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> () </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> (</span></span>
<span class="line"><span style="color: #ABB2BF">    &#x3C;></span></span>
<span class="line"><span style="color: #ABB2BF">      &#x3C;</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">>ãƒãƒ£ãƒ¼ãƒˆãƒšãƒ¼ã‚¸&#x3C;/</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">    &#x3C;/></span></span>
<span class="line"><span style="color: #ABB2BF">  )</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">export</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">default</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">ChartPage</span></span></code></pre>
<h3 id="ãƒšãƒ¼ã‚¸é·ç§»ç”¨ã®siteã«ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ã‚’ä½œã‚‹">ãƒšãƒ¼ã‚¸é·ç§»ç”¨ã®(site)ã«ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ã‚’ä½œã‚‹</h3>
<p>å…ˆã«ã‚¢ã‚¤ã‚³ãƒ³ã‚’ä½¿ã†ã®ã§ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚
ã‚¿ãƒ¼ãƒŸãƒŠãƒ«</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #61AFEF">npm</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">i</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">react-icons</span></span></code></pre>
<p>å…ˆã»ã©ä½œã£ãŸcomponents/Navbarã«ã€€<strong>site-navbar.tsx</strong>ã€€ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¿½åŠ ã—ã¾ã™ã€‚
ãã‚Œã§ã¯ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ã„ãã¾ã™ã€‚
components/Navbarsite-navbar.tsx</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #98C379">"use client"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">usePathname</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"next/navigation"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">Link</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"next/link"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">Image</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"next/image"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">UserButton</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"@clerk/nextjs"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">AiOutlineBarChart</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"react-icons/ai"</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">GiNotebook</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"react-icons/gi"</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">navItems</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> [</span></span>
<span class="line"><span style="color: #ABB2BF">  {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">path</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">"/note"</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">"Note"</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">icon</span><span style="color: #ABB2BF">: &#x3C;</span><span style="color: #E5C07B">GiNotebook</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">size</span><span style="color: #56B6C2">=</span><span style="color: #C678DD">{</span><span style="color: #D19A66">24</span><span style="color: #C678DD">}</span><span style="color: #ABB2BF"> /></span></span>
<span class="line"><span style="color: #ABB2BF">  },</span></span>
<span class="line"><span style="color: #ABB2BF">  {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">path</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">"/chart"</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">"Chart"</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">icon</span><span style="color: #ABB2BF">: &#x3C;</span><span style="color: #E5C07B">AiOutlineBarChart</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">size</span><span style="color: #56B6C2">=</span><span style="color: #C678DD">{</span><span style="color: #D19A66">24</span><span style="color: #C678DD">}</span><span style="color: #ABB2BF"> /></span></span>
<span class="line"><span style="color: #ABB2BF">  },</span></span>
<span class="line"><span style="color: #ABB2BF">];</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">export</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">default</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">NavBar</span><span style="color: #ABB2BF">() {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">let</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">pathname</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">usePathname</span><span style="color: #ABB2BF">() </span><span style="color: #56B6C2">||</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"/"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> (</span></span>
<span class="line"><span style="color: #ABB2BF">    &#x3C;</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">className</span><span style="color: #56B6C2">=</span><span style="color: #98C379">" p-[0.4rem] rounded-lg mb-12 sticky top-4 z-[100]"</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">      &#x3C;</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">className</span><span style="color: #56B6C2">=</span><span style="color: #98C379">"flex gap-2 relative justify-around items-center w-full z-[100]  rounded-lg"</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">        &#x3C;</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">className</span><span style="color: #56B6C2">=</span><span style="color: #98C379">"hidden sm:block"</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">          &#x3C;</span><span style="color: #E5C07B">Link</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">href</span><span style="color: #56B6C2">=</span><span style="color: #98C379">"/"</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">className</span><span style="color: #56B6C2">=</span><span style="color: #98C379">"flex items-center no-underline text-zinc-900"</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">            &#x3C;</span><span style="color: #E5C07B">Image</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">width</span><span style="color: #56B6C2">=</span><span style="color: #C678DD">{</span><span style="color: #D19A66">36</span><span style="color: #C678DD">}</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">height</span><span style="color: #56B6C2">=</span><span style="color: #C678DD">{</span><span style="color: #D19A66">36</span><span style="color: #C678DD">}</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">alt</span><span style="color: #56B6C2">=</span><span style="color: #98C379">"Logo"</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">src</span><span style="color: #56B6C2">=</span><span style="color: #98C379">"/logo.png"</span><span style="color: #ABB2BF"> /></span></span>
<span class="line"><span style="color: #ABB2BF">            &#x3C;</span><span style="color: #E06C75">span</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">className</span><span style="color: #56B6C2">=</span><span style="color: #98C379">"text-2xl"</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">              My-App</span></span>
<span class="line"><span style="color: #ABB2BF">            &#x3C;/</span><span style="color: #E06C75">span</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">          &#x3C;/</span><span style="color: #E5C07B">Link</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">        &#x3C;/</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">        &#x3C;</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">className</span><span style="color: #56B6C2">=</span><span style="color: #98C379">"flex"</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">          </span><span style="color: #C678DD">{</span><span style="color: #E5C07B">navItems</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">map</span><span style="color: #ABB2BF">((</span><span style="color: #E06C75; font-style: italic">item</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">index</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">            </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">isActive</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">item</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">path</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">===</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">pathname</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">            </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> (</span></span>
<span class="line"><span style="color: #ABB2BF">              &#x3C;</span><span style="color: #E5C07B">Link</span></span>
<span class="line"><span style="color: #ABB2BF">                </span><span style="color: #D19A66; font-style: italic">key</span><span style="color: #56B6C2">=</span><span style="color: #C678DD">{</span><span style="color: #E5C07B">item</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">path</span><span style="color: #C678DD">}</span></span>
<span class="line"><span style="color: #ABB2BF">                </span><span style="color: #D19A66; font-style: italic">className</span><span style="color: #56B6C2">=</span><span style="color: #C678DD">{</span><span style="color: #98C379">`px-4 py-2 rounded-md text-sm lg:text-base hover:bg-slate-200 relative no-underline duration-300 ease-in </span><span style="color: #C678DD">${</span><span style="color: #E06C75">isActive</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">?</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"text-zinc-400"</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">:</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"text-zinc-900"</span></span>
<span class="line"><span style="color: #ABB2BF">                  </span><span style="color: #C678DD">}</span><span style="color: #98C379">`</span><span style="color: #C678DD">}</span></span>
<span class="line"><span style="color: #ABB2BF">                </span><span style="color: #D19A66; font-style: italic">href</span><span style="color: #56B6C2">=</span><span style="color: #C678DD">{</span><span style="color: #E5C07B">item</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">path</span><span style="color: #C678DD">}</span></span>
<span class="line"><span style="color: #ABB2BF">              ></span></span>
<span class="line"><span style="color: #ABB2BF">                &#x3C;</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">className</span><span style="color: #56B6C2">=</span><span style="color: #98C379">"flex items-center"</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">                  &#x3C;</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">className</span><span style="color: #56B6C2">=</span><span style="color: #98C379">""</span><span style="color: #ABB2BF">></span><span style="color: #C678DD">{</span><span style="color: #E5C07B">item</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">icon</span><span style="color: #C678DD">}</span><span style="color: #ABB2BF">&#x3C;/</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">                  &#x3C;</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">className</span><span style="color: #56B6C2">=</span><span style="color: #98C379">"hidden sm:block"</span><span style="color: #ABB2BF">></span><span style="color: #C678DD">{</span><span style="color: #E5C07B">item</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">name</span><span style="color: #C678DD">}</span><span style="color: #ABB2BF">&#x3C;/</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">></span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">                &#x3C;/</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">              &#x3C;/</span><span style="color: #E5C07B">Link</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">            );</span></span>
<span class="line"><span style="color: #ABB2BF">          })</span><span style="color: #C678DD">}</span></span>
<span class="line"><span style="color: #ABB2BF">        &#x3C;/</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">></span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">        &#x3C;</span><span style="color: #E5C07B">UserButton</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">afterSignOutUrl</span><span style="color: #56B6C2">=</span><span style="color: #98C379">"/"</span><span style="color: #ABB2BF"> /></span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">      &#x3C;/</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">    &#x3C;/</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">  );</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span></code></pre>
<h4 id="ã‚³ãƒ¼ãƒ‰ã®è§£èª¬">ã‚³ãƒ¼ãƒ‰ã®è§£èª¬</h4>
<p><strong>usePathname</strong>ã¯<strong>ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰</strong>ã®hooksã§ã™ã€‚ãªã®ã§â€use clientâ€ã‚’ã¤ã‘ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
usePathnameã¯æ–‡å­—åˆ—ã‚’è¿”ã—ã¾ã™ãŒã€ä»¥ä¸‹ã®å ´åˆã«nullã‚’è¿”ã—ã¾ã™ã€‚</p>
<ul>
<li>ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒ«ãƒ¼ãƒˆãŒãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã•ã‚Œã¦ã„ã‚‹ã¨ã</li>
<li>Next.jsãŒè‡ªå‹•çš„ã«é™çš„æœ€é©åŒ–ã—ãŸãƒšãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã¨ã</li>
<li>ãƒ«ãƒ¼ã‚¿ãƒ¼ãŒæº–å‚™ã§ãã¦ã„ãªã„ã¨ã
ã“ã®ã‚ˆã†ãªå ´åˆã«ã€nullã‚’è¿”ã™ã®ã§ã¯ãªãã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ãƒ‘ã‚¹åã‚’è¨­å®šã—ãŸã„ã¨ãã«ã€||ã¨ã„ã†æ¼”ç®—å­ã‚’ä½¿ã„ã¾ã™ã€‚||ã¯ã€è«–ç†å’Œï¼ˆORï¼‰ã¨å‘¼ã°ã‚Œã‚‹æ¼”ç®—å­ã§ã€å·¦å´ã®å€¤ãŒçœŸï¼ˆtruthyï¼‰ã§ã‚ã‚Œã°ãã®å€¤ã‚’è¿”ã—ã€å½ï¼ˆfalsyï¼‰ã§ã‚ã‚Œã°å³å´ã®å€¤ã‚’è¿”ã—ã¾ã™ã€‚nullã¯å½ã¨ã¿ãªã•ã‚Œã‚‹ã®ã§ã€usePathname()ãŒnullã‚’è¿”ã—ãŸã‚‰ã€å³å´ã®â€/â€œãŒä»£ã‚ã‚Šã«è¿”ã•ã‚Œã¾ã™ã€‚</li>
</ul>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">let</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">pathname</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">usePathname</span><span style="color: #ABB2BF">() </span><span style="color: #56B6C2">||</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"/"</span><span style="color: #ABB2BF">;</span></span></code></pre>
<p>navItemsã¨ã„ã†é…åˆ—ã‚’mapãƒ¡ã‚½ãƒƒãƒ‰ã§åå¾©å‡¦ç†ã—ã¦ã€å„è¦ç´ ã«å¯¾ã—ã¦Linkã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’è¿”ã™ã‚‚ã®ã§ã™ã€‚Linkã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯Next.jsã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°æ©Ÿèƒ½ã‚’åˆ©ç”¨ã—ã¦ã€ãƒšãƒ¼ã‚¸é–“ã®é·ç§»ã‚’è¡Œã†ã‚‚ã®ã§ã™ã€‚
item.pathã¨ç¾åœ¨ã®ãƒ‘ã‚¹åï¼ˆpathnameï¼‰ãŒä¸€è‡´ã™ã‚‹ã‹ã©ã†ã‹ã‚’isActiveã¨ã„ã†å¤‰æ•°ã«ä»£å…¥ã—ã¦ã„ã¾ã™ã€‚ã“ã‚Œã¯ã€ç¾åœ¨ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã‚¢ã‚¤ãƒ†ãƒ ã‚’åˆ¤åˆ¥ã™ã‚‹ãŸã‚ã«ä½¿ã‚ã‚Œã¾ã™ã€‚</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #ABB2BF">...</span></span>
<span class="line"><span style="color: #ABB2BF">{</span><span style="color: #E5C07B">navItems</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">map</span><span style="color: #ABB2BF">((</span><span style="color: #E06C75; font-style: italic">item</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">            </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">isActive</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">item</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">path</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">===</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">pathname</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">            </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> (</span></span>
<span class="line"><span style="color: #ABB2BF">              &#x3C;</span><span style="color: #E5C07B">Link</span></span>
<span class="line"><span style="color: #ABB2BF">                </span><span style="color: #D19A66; font-style: italic">key</span><span style="color: #56B6C2">=</span><span style="color: #C678DD">{</span><span style="color: #E5C07B">item</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">path</span><span style="color: #C678DD">}</span></span>
<span class="line"><span style="color: #ABB2BF">                </span><span style="color: #D19A66; font-style: italic">className</span><span style="color: #56B6C2">=</span><span style="color: #C678DD">{</span><span style="color: #98C379">`px-4 py-2 rounded-md text-sm lg:text-base hover:bg-slate-200 relative no-underline duration-300 ease-in </span><span style="color: #C678DD">${</span><span style="color: #E06C75">isActive</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">?</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"text-zinc-400"</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">:</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"text-zinc-900"</span></span>
<span class="line"><span style="color: #ABB2BF">                  </span><span style="color: #C678DD">}</span><span style="color: #98C379">`</span><span style="color: #C678DD">}</span></span>
<span class="line"><span style="color: #ABB2BF">                </span><span style="color: #D19A66; font-style: italic">href</span><span style="color: #56B6C2">=</span><span style="color: #C678DD">{</span><span style="color: #E5C07B">item</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">path</span><span style="color: #C678DD">}</span></span>
<span class="line"><span style="color: #ABB2BF">              ></span></span>
<span class="line"><span style="color: #ABB2BF">                &#x3C;</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">className</span><span style="color: #56B6C2">=</span><span style="color: #98C379">"flex items-center"</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">                  &#x3C;</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">className</span><span style="color: #56B6C2">=</span><span style="color: #98C379">""</span><span style="color: #ABB2BF">></span><span style="color: #C678DD">{</span><span style="color: #E5C07B">item</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">icon</span><span style="color: #C678DD">}</span><span style="color: #ABB2BF">&#x3C;/</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">                  &#x3C;</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">className</span><span style="color: #56B6C2">=</span><span style="color: #98C379">"hidden sm:block"</span><span style="color: #ABB2BF">></span><span style="color: #C678DD">{</span><span style="color: #E5C07B">item</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">name</span><span style="color: #C678DD">}</span><span style="color: #ABB2BF">&#x3C;/</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">></span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">                &#x3C;/</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">              &#x3C;/</span><span style="color: #E5C07B">Link</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">            );</span></span>
<span class="line"><span style="color: #ABB2BF">          })}</span></span>
<span class="line"><span style="color: #ABB2BF">...</span></span></code></pre>
<h4 id="ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ã‚’è¡¨ç¤ºã•ã›ã‚‹">ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ã‚’è¡¨ç¤ºã•ã›ã‚‹</h4>
<p>ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ã¯å…±é€šã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãªã®ã§(site)/layout.tsxã«è¿½åŠ ã—ã¦ã„ãã¾ã™ã€‚
(site)/layout.tsx</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">NavBar</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"../components/Navbar/site-navbar"</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">SiteLayout</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> ({</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">children</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">}: {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">children</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">React</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">ReactNode</span></span>
<span class="line"><span style="color: #ABB2BF">}) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> (</span></span>
<span class="line"><span style="color: #ABB2BF">    &#x3C;</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">      &#x3C;</span><span style="color: #E5C07B">NavBar</span><span style="color: #ABB2BF"> /></span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #C678DD">{</span><span style="color: #E06C75">children</span><span style="color: #C678DD">}</span></span>
<span class="line"><span style="color: #ABB2BF">    &#x3C;/</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">  )</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">export</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">default</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">SiteLayout</span></span></code></pre>
<p>ä»¥ä¸‹ã®ã‚ˆã†ã«è¡¨ç¤ºã‚Œã¦ã„ã¾ã™ã€‚
ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨ãƒšãƒ¼ã‚¸ã®é·ç§»ãŒã§ãã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ã€‚
<img src="https://storage.googleapis.com/zenn-user-upload/b9bed3b2db21-20230928.png" alt=""></p>
<br>
<br>
<p>ä»Šå›Lexicalã«ã¤ã„ã¦æ·±ãè§£èª¬ã—ã¾ã›ã‚“ã€‚
ãŠæ‰‹æ•°ã§ã™ãŒã€app/componentsã«githubã®ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒšã—ã¦ãŠä½¿ã„ãã ã•ã„m(_ _)m
<a href="https://github.com/ryotarofr/lexacal-example">Lexicalã‚¨ãƒ‡ã‚£ã‚¿</a>
â†“ã“ã“ã«ã‚³ãƒ”ãƒš
app/components/Editor/â€¦
<img src="https://storage.googleapis.com/zenn-user-upload/eb7acaf386ee-20230928.png" alt=""></p>
<h3 id="ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«">ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</h3>
<p>ã¾ãšã¯ä»¥ä¸‹ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãã ã•ã„
ã‚¿ãƒ¼ãƒŸãƒŠãƒ«
lexicalã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯0.11.0ã‚’ä½¿ã„ã¾ã™ã€‚
ãƒªãƒƒãƒã‚¨ãƒ‡ã‚£ã‚¿ãƒ„ãƒ¼ãƒ«</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #61AFEF">npm</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">install</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">@lexical/list@0.11.0</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">@lexical/react@0.11.0</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">lexical@0.11.0</span></span></code></pre>
<p>å‡¦ç†çµæœã®é€šçŸ¥ã‚’ç”»é¢ã«è¡¨ç¤ºã™ã‚‹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #61AFEF">npm</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">i</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">react-hot-toast</span></span></code></pre>
<h3 id="ãƒãƒ¼ãƒˆãƒšãƒ¼ã‚¸ã«ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒ‡ã‚£ã‚¿ã‚’è¡¨ç¤ºã•ã›ã‚‹">ãƒãƒ¼ãƒˆãƒšãƒ¼ã‚¸ã«ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒ‡ã‚£ã‚¿ã‚’è¡¨ç¤ºã•ã›ã‚‹</h3>
<p>ã‚¨ãƒ‡ã‚£ã‚¿ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’è¡¨ç¤ºã•ã›ã¾ã™ã€‚ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ã—ã¦ãã ã•ã„
(site)/(routes)/note/page.tsx</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">Editor</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"@/app/components/Editor/text-editor"</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">NotePage</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> () </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> (</span></span>
<span class="line"><span style="color: #ABB2BF">    &#x3C;</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">      &#x3C;</span><span style="color: #E5C07B">Editor</span><span style="color: #ABB2BF"> /></span></span>
<span class="line"><span style="color: #ABB2BF">    &#x3C;/</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">  )</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">export</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">default</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">NotePage</span></span></code></pre>
<h4 id="ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒ‡ã‚£ã‚¿ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’è¿½åŠ ">ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒ‡ã‚£ã‚¿ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’è¿½åŠ </h4>
<p>ã“ã¡ã‚‰ã‚‚ã‚³ãƒ”ãƒšã§ãŠä½¿ã„ãã ã•ã„
<a href="https://github.com/ryotarofr/lexacal-example/blob/main/styles.css">ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒ‡ã‚£ã‚¿ã®ã‚¹ã‚¿ã‚¤ãƒ«</a>
ä»¥ä¸‹ã®å ´æ‰€ã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¿½åŠ 
(site)/styles.css
<img src="https://storage.googleapis.com/zenn-user-upload/e0c42e199f9d-20230928.png" alt=""></p>
<p>æœ€å¾Œã«layout.tsxã«ã‚¹ã‚¿ã‚¤ãƒ«ã‚’é©å¿œã•ã›ã¾ã™ã€‚
(site)/layout.tsx</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"./styles.css"</span></span></code></pre>
<h4 id="ãƒ­ãƒ¼ã‚«ãƒ«ãƒ›ã‚¹ãƒˆã‚’ç«‹ã¡ä¸Šã’ã¦ç¢ºèªã—ã¦ã¿ã¾ã—ã‚‡ã†">ãƒ­ãƒ¼ã‚«ãƒ«ãƒ›ã‚¹ãƒˆã‚’ç«‹ã¡ä¸Šã’ã¦ç¢ºèªã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</h4>
<p>/noteã®ãƒšãƒ¼ã‚¸ã«ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒ‡ã‚£ã‚¿ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚Œã°OKã§ã™ã€‚
<img src="https://storage.googleapis.com/zenn-user-upload/50041e402505-20230928.png" alt=""></p>
<p>ã¡ãªã¿ã«ã§ã™ãŒã€ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œã‚‚ãƒãƒƒãƒãƒªã§ã™ã€‚
<img src="https://storage.googleapis.com/zenn-user-upload/606429b4510e-20230928.png" alt=""></p>
<br>
<br>
<p>OpenAIã®APIã‚’ä½¿ã£ã¦æ„Ÿæƒ…åˆ†æã‚’ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ã„ãã¾ã™ã€‚
ã¯ã˜ã‚ã«OpenAIã®APIã‚­ãƒ¼ã‚’å–å¾—ã—ã¾ã™ã€‚(APIã‚­ãƒ¼ã®å–å¾—ã«ã¯ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆç™»éŒ²ãŒå¿…è¦ã§ã™ã€‚æœ€åˆã®3ãƒ¶æœˆã¯$18ã¾ã§ç„¡æ–™ã§ã™ã€‚ï¼‰
ä»¥ä¸‹ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒšãƒ¼ã‚¸ã‹ã‚‰
View API Keys >> Create new secret key
ã§APIã‚­ãƒ¼ã‚’ç™ºè¡Œã§ãã¾ã™ã€‚
<a href="https://platform.openai.com/docs/introduction">OpenAI ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</a>
<img src="https://storage.googleapis.com/zenn-user-upload/817d9fce5cb7-20230928.png" alt=""></p>
<p>ãã‚Œã§ã¯ã€text-editor.tsxã«ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ã—ã¾ã™ã€‚</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #7F848E; font-style: italic">//...</span></span>
<span class="line"><span style="color: #C678DD">export</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">Editor</span><span style="color: #ABB2BF">() {</span></span>
<span class="line"><span style="color: #7F848E; font-style: italic">//è¿½åŠ </span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> [</span><span style="color: #E5C07B">generateData</span><span style="color: #ABB2BF">, </span><span style="color: #E5C07B">setGenarateData</span><span style="color: #ABB2BF">] </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">useState</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">"{}"</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #7F848E; font-style: italic">//è¿½åŠ </span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #7F848E; font-style: italic">// AIã«ãƒ‡ãƒ¼ã‚¿æ¸¡ã™</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #7F848E; font-style: italic">// JSONã¨ã—ã¦è§£æ</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">parsedData</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">JSON</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">parse</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">generateData</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #7F848E; font-style: italic">// å¿…è¦ãªãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡º</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">textObjects</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">any</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> [];</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">extractText</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">obj</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">any</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #7F848E; font-style: italic">// objãŒnullã‚„ç©ºã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãªã‚‰returnã™ã‚‹</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #56B6C2">!</span><span style="color: #E06C75">obj</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">||</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">Object</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">keys</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">obj</span><span style="color: #ABB2BF">).</span><span style="color: #E06C75">length</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">===</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">0</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #E5C07B">obj</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">type</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">===</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'text'</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">            </span><span style="color: #E5C07B">textObjects</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">push</span><span style="color: #ABB2BF">(</span><span style="color: #E5C07B">obj</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">text</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">        } </span><span style="color: #C678DD">else</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #E5C07B">obj</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">children</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">&#x26;&#x26;</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">obj</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">children</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">length</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">></span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">0</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">            </span><span style="color: #E5C07B">obj</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">children</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">forEach</span><span style="color: #ABB2BF">((</span><span style="color: #E06C75; font-style: italic">child</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">any</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">extractText</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">child</span><span style="color: #ABB2BF">));</span></span>
<span class="line"><span style="color: #ABB2BF">        }</span></span>
<span class="line"><span style="color: #ABB2BF">    }</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #7F848E; font-style: italic">// parsedData.rootãŒundefinedã§ãªã„ã“ã¨ã‚’ç¢ºèªã™ã‚‹</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #E5C07B">parsedData</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">root</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #61AFEF">extractText</span><span style="color: #ABB2BF">(</span><span style="color: #E5C07B">parsedData</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">root</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">    }</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">textData</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">textObjects</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">join</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">','</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">    </span></span>
<span class="line"><span style="color: #7F848E; font-style: italic">//è¿½åŠ </span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">exportAsJson</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75; font-style: italic">contenAsJson</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #61AFEF">setGenarateData</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">contenAsJson</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">contenAsJson</span></span>
<span class="line"><span style="color: #ABB2BF">    };</span></span>
<span class="line"><span style="color: #7F848E; font-style: italic">//...</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> (</span></span>
<span class="line"><span style="color: #ABB2BF">        &#x3C;</span><span style="color: #E5C07B">LexicalComposer</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">initialConfig</span><span style="color: #56B6C2">=</span><span style="color: #C678DD">{</span><span style="color: #E06C75">editorConfig</span><span style="color: #C678DD">}</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">            &#x3C;</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">className</span><span style="color: #56B6C2">=</span><span style="color: #98C379">"editor-container"</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">                &#x3C;</span><span style="color: #E5C07B">ToolbarPlugin</span><span style="color: #ABB2BF"> /></span></span>
<span class="line"><span style="color: #ABB2BF">                &#x3C;</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">className</span><span style="color: #56B6C2">=</span><span style="color: #98C379">"editor-inner"</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">                    &#x3C;</span><span style="color: #E5C07B">RichTextPlugin</span></span>
<span class="line"><span style="color: #ABB2BF">                        </span><span style="color: #D19A66; font-style: italic">contentEditable</span><span style="color: #56B6C2">=</span><span style="color: #C678DD">{</span><span style="color: #ABB2BF">&#x3C;</span><span style="color: #E5C07B">ContentEditable</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">className</span><span style="color: #56B6C2">=</span><span style="color: #98C379">"editor-input"</span><span style="color: #ABB2BF"> /></span><span style="color: #C678DD">}</span></span>
<span class="line"><span style="color: #ABB2BF">                        </span><span style="color: #D19A66; font-style: italic">placeholder</span><span style="color: #56B6C2">=</span><span style="color: #C678DD">{</span><span style="color: #ABB2BF">&#x3C;</span><span style="color: #E5C07B">Placeholder</span><span style="color: #ABB2BF"> /></span><span style="color: #C678DD">}</span></span>
<span class="line"><span style="color: #ABB2BF">                        </span><span style="color: #D19A66; font-style: italic">ErrorBoundary</span><span style="color: #56B6C2">=</span><span style="color: #C678DD">{</span><span style="color: #E06C75">LexicalErrorBoundary</span><span style="color: #C678DD">}</span></span>
<span class="line"><span style="color: #ABB2BF">                    /></span></span>
<span class="line"><span style="color: #ABB2BF">                    &#x3C;</span><span style="color: #E5C07B">ListPlugin</span><span style="color: #ABB2BF"> /></span></span>
<span class="line"><span style="color: #ABB2BF">                    &#x3C;</span><span style="color: #E5C07B">HistoryPlugin</span><span style="color: #ABB2BF"> /></span></span>
<span class="line"><span style="color: #ABB2BF">                    &#x3C;</span><span style="color: #E5C07B">AutoFocusPlugin</span><span style="color: #ABB2BF"> /></span></span>
<span class="line"><span style="color: #ABB2BF">                    &#x3C;</span><span style="color: #E5C07B">CodeHighlightPlugin</span><span style="color: #ABB2BF"> /></span></span>
<span class="line"><span style="color: #ABB2BF">                    &#x3C;</span><span style="color: #E5C07B">LinkPlugin</span><span style="color: #ABB2BF"> /></span></span>
<span class="line"><span style="color: #ABB2BF">                    &#x3C;</span><span style="color: #E5C07B">TabIndentationPlugin</span><span style="color: #ABB2BF"> /></span></span>
<span class="line"><span style="color: #ABB2BF">                    &#x3C;</span><span style="color: #E5C07B">AutoLinkPlugin</span><span style="color: #ABB2BF"> /></span></span>
<span class="line"><span style="color: #ABB2BF">		</span><span style="color: #C678DD">{</span><span style="color: #7F848E; font-style: italic">/* è¿½åŠ  */</span><span style="color: #C678DD">}</span><span style="color: #ABB2BF">		</span></span>
<span class="line"><span style="color: #ABB2BF">                    &#x3C;</span><span style="color: #E5C07B">ExportPluginJson</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">exportAsJSON</span><span style="color: #56B6C2">=</span><span style="color: #C678DD">{</span><span style="color: #E06C75">exportAsJson</span><span style="color: #C678DD">}</span><span style="color: #ABB2BF"> /></span></span>
<span class="line"><span style="color: #ABB2BF">                </span></span>
<span class="line"><span style="color: #ABB2BF">		&#x3C;</span><span style="color: #E5C07B">MarkdownShortcutPlugin</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">transformers</span><span style="color: #56B6C2">=</span><span style="color: #C678DD">{</span><span style="color: #E5C07B">TRANSFORMERS</span><span style="color: #C678DD">}</span><span style="color: #ABB2BF"> /></span></span>
<span class="line"><span style="color: #ABB2BF">		</span><span style="color: #C678DD">{</span><span style="color: #7F848E; font-style: italic">/* è¿½åŠ  GenarateButtonã¯ä¸‹ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ä½œã‚Šã¾ã™ã€‚ */</span><span style="color: #C678DD">}</span></span>
<span class="line"><span style="color: #ABB2BF">                    &#x3C;</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">className</span><span style="color: #56B6C2">=</span><span style="color: #98C379">"flex justify-end"</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">                        &#x3C;</span><span style="color: #E5C07B">GenarateButton</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">textData</span><span style="color: #56B6C2">=</span><span style="color: #C678DD">{</span><span style="color: #E06C75">textData</span><span style="color: #C678DD">}</span><span style="color: #ABB2BF"> /></span></span>
<span class="line"><span style="color: #ABB2BF">                    &#x3C;/</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">                &#x3C;/</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">		</span><span style="color: #C678DD">{</span><span style="color: #7F848E; font-style: italic">/* ... */</span><span style="color: #C678DD">}</span></span>
<span class="line"><span style="color: #ABB2BF">            &#x3C;/</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">        &#x3C;/</span><span style="color: #E5C07B">LexicalComposer</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">    );</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span>
<span class="line"></span></code></pre>
<h4 id="ã‚³ãƒ¼ãƒ‰ã®è§£èª¬-1">ã‚³ãƒ¼ãƒ‰ã®è§£èª¬</h4>
<p>Lexicalã§å…¥åŠ›ã—ãŸãƒ†ã‚­ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’stateã«æŒãŸã›ã¾ã™ã€‚</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #ABB2BF"> </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> [</span><span style="color: #E5C07B">generateData</span><span style="color: #ABB2BF">, </span><span style="color: #E5C07B">setGenarateData</span><span style="color: #ABB2BF">] </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">useState</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">"{}"</span><span style="color: #ABB2BF">)</span></span></code></pre>
<p>stateã¯jsonå½¢å¼ã§å‡ºåŠ›ã™ã‚‹ã®ã§Lexicalã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ä½¿ã„ã¾ã™ã€‚</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #ABB2BF">&#x3C;</span><span style="color: #E5C07B">ExportPluginJson</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">exportAsJSON</span><span style="color: #56B6C2">=</span><span style="color: #C678DD">{</span><span style="color: #E06C75">exportAsJson</span><span style="color: #C678DD">}</span><span style="color: #ABB2BF"> /></span></span></code></pre>
<p>exportAsJsonã¨ã„ã†é–¢æ•°ã«ã¯å…ˆã»ã©å®šç¾©ã—ãŸsetGenarateDataã«ãƒ‡ãƒ¼ã‚¿ã‚’æ¸¡ã™ã‚ˆã†ã«ã—ã¾ã™ã€‚</p>
<p>:::details å…·ä½“çš„ã«ã¯ã“ã‚“ãªæ„Ÿã˜ã®ãƒ‡ãƒ¼ã‚¿ãŒæ¸¡ã•ã‚Œã¾ã™ã€‚
ã“ã‚Œã¯ã€Œã“ã‚“ã«ã¡ã¯ã€ã¨ã„ã†ãƒ‡ãƒ¼ã‚¿ã§ã™ã€‚
{â€œrootâ€:{â€œchildrenâ€:[{â€œchildrenâ€:[{â€œdetailâ€:0,â€œformatâ€:0,â€œmodeâ€:â€œnormalâ€,â€œstyleâ€:"",â€œtextâ€:â€œã“ã‚“ã«ã¡ã¯â€,â€œtypeâ€:â€œtextâ€,â€œversionâ€:1}],â€œdirectionâ€:â€œltrâ€,â€œformatâ€:"",â€œindentâ€:0,â€œtypeâ€:â€œparagraphâ€,â€œversionâ€:1}],â€œdirectionâ€:â€œltrâ€,â€œformatâ€:"",â€œindentâ€:0,â€œtypeâ€:â€œrootâ€,â€œversionâ€:1}}
:::</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #ABB2BF"> </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">exportAsJson</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75; font-style: italic">contenAsJson</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">       </span><span style="color: #61AFEF">setGenarateData</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">contenAsJson</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">       </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">contenAsJson</span></span>
<span class="line"><span style="color: #ABB2BF">   };</span></span></code></pre>
<p>æ¬¡ã«å…ˆã»ã©ã®Jsonãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ãƒ†ã‚­ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’æŠœãå‡ºã—ã¾ã™ã€‚
å…ˆã»ã©ã®ä¾‹ã§è¡Œãã¨ã€Œã“ã‚“ã«ã¡ã¯ã€ã‚’æŠœãå‡ºã—ã¦ã„ãã¾ã™ã€‚</p>
<p>JSON.parse()ã§ãã‚‹ãƒ‡ãƒ¼ã‚¿ã«ã¯ä»¥ä¸‹ã®æ¡ä»¶ãŒã‚ã‚Šã¾ã™ã€‚
:::details JSON.parse()ã§ãã‚‹ãƒ‡ãƒ¼ã‚¿ã«ã¯æ¡ä»¶ãŒã‚ã‚Šã¾ã™ã€‚
1ã€€ã‚­ãƒ¼ï¼šå€¤ã¯ãƒ€ãƒ–ãƒ«ã‚¯ã‚©ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã§å›²ã‚€</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #98C379">'{"name": "John"}'</span><span style="color: #ABB2BF"> </span><span style="color: #7F848E; font-style: italic">// æ­£ã—ã„</span></span>
<span class="line"><span style="color: #98C379">'{"name": '</span><span style="color: #E06C75">John</span><span style="color: #98C379">'}'</span><span style="color: #ABB2BF"> </span><span style="color: #7F848E; font-style: italic">// ã‚¨ãƒ©ãƒ¼ - ã‚·ãƒ³ã‚°ãƒ«ã‚¯ã‚©ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã¯èªè­˜ã•ã‚Œãªã„</span></span></code></pre>
<p>2 æ•°å€¤ã¯ãƒ€ãƒ–ãƒ«ã‚¯ã‚©ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ãªã—</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #98C379">'{"age": 30}'</span><span style="color: #ABB2BF"> </span><span style="color: #7F848E; font-style: italic">// æ­£ã—ã„</span></span>
<span class="line"><span style="color: #98C379">'{"age": "30"}'</span><span style="color: #ABB2BF"> </span><span style="color: #7F848E; font-style: italic">// ã‚¨ãƒ©ãƒ¼ - ãƒ€ãƒ–ãƒ«ã‚¯ã‚©ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã§å›²ã¾ã‚ŒãŸæ•°å€¤ã¯æ–‡å­—åˆ—ã¨ã—ã¦æ‰±ã‚ã‚Œã‚‹</span></span></code></pre>
<p>3 ç‰¹æ®Šæ–‡å­—ã‚’é©åˆ‡ã«ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—(ãƒãƒƒã‚¯ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ã¨ãƒ€ãƒ–ãƒ«ã‚¯ã‚©ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã¯ãã®ã¾ã¾ä½¿ãˆãªã„ã®ã§\ã€€\ã‚’å‰ã«ã¤ã‘ã¾ã™ã€‚)</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #98C379">'{"text": "This is a </span><span style="color: #56B6C2">\\</span><span style="color: #98C379">"quoted</span><span style="color: #56B6C2">\\</span><span style="color: #98C379">" string."}'</span><span style="color: #ABB2BF"> </span><span style="color: #7F848E; font-style: italic">// ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã•ã‚ŒãŸãƒ€ãƒ–ãƒ«ã‚¯ã‚©ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³</span></span>
<span class="line"><span style="color: #98C379">'{"path": "C:</span><span style="color: #56B6C2">\\\\</span><span style="color: #98C379">Documents</span><span style="color: #56B6C2">\\\\</span><span style="color: #98C379">file.txt"}'</span><span style="color: #ABB2BF"> </span><span style="color: #7F848E; font-style: italic">// ãƒãƒƒã‚¯ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ã®ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—</span></span></code></pre>
<p>:::</p>
<p>ã“ã®ã‚ˆã†ã«ã™ã‚‹ã¨textDataã«ã€Œã“ã‚“ã«ã¡ã¯ã€ã¨ã„ã†ãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡ºã§ãã¾ã™ã€‚ã€‚</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #ABB2BF">   </span><span style="color: #7F848E; font-style: italic">// AIã«ãƒ‡ãƒ¼ã‚¿æ¸¡ã™</span></span>
<span class="line"><span style="color: #ABB2BF">   </span><span style="color: #7F848E; font-style: italic">// JSONã¨ã—ã¦è§£æ</span></span>
<span class="line"><span style="color: #ABB2BF">   </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">parsedData</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">JSON</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">parse</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">generateData</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">   </span><span style="color: #7F848E; font-style: italic">// å¿…è¦ãªãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡º</span></span>
<span class="line"><span style="color: #ABB2BF">   </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">textObjects</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">any</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> [];</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">   </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">extractText</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">obj</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">any</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">       </span><span style="color: #7F848E; font-style: italic">// objãŒnullã‚„ç©ºã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãªã‚‰returnã™ã‚‹</span></span>
<span class="line"><span style="color: #ABB2BF">       </span><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #56B6C2">!</span><span style="color: #E06C75">obj</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">||</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">Object</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">keys</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">obj</span><span style="color: #ABB2BF">).</span><span style="color: #E06C75">length</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">===</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">0</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">       </span><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #E5C07B">obj</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">type</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">===</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'text'</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">           </span><span style="color: #E5C07B">textObjects</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">push</span><span style="color: #ABB2BF">(</span><span style="color: #E5C07B">obj</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">text</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">       } </span><span style="color: #C678DD">else</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #E5C07B">obj</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">children</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">&#x26;&#x26;</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">obj</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">children</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">length</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">></span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">0</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">           </span><span style="color: #E5C07B">obj</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">children</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">forEach</span><span style="color: #ABB2BF">((</span><span style="color: #E06C75; font-style: italic">child</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">any</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">extractText</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">child</span><span style="color: #ABB2BF">));</span></span>
<span class="line"><span style="color: #ABB2BF">       }</span></span>
<span class="line"><span style="color: #ABB2BF">   }</span></span>
<span class="line"><span style="color: #ABB2BF">   </span><span style="color: #7F848E; font-style: italic">// parsedData.rootãŒundefinedã§ãªã„ã“ã¨ã‚’ç¢ºèªã™ã‚‹</span></span>
<span class="line"><span style="color: #ABB2BF">   </span><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #E5C07B">parsedData</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">root</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">       </span><span style="color: #61AFEF">extractText</span><span style="color: #ABB2BF">(</span><span style="color: #E5C07B">parsedData</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">root</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">   }</span></span>
<span class="line"><span style="color: #ABB2BF">   </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">textData</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">textObjects</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">join</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">','</span><span style="color: #ABB2BF">)</span></span></code></pre>
<p>æœ€å¾Œã«textDataã‚’GenarateButtonã«propsã«ã¾ã™ã€‚</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #ABB2BF">&#x3C;</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">className</span><span style="color: #56B6C2">=</span><span style="color: #98C379">"flex justify-end"</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">   &#x3C;</span><span style="color: #E5C07B">GenarateButton</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">textData</span><span style="color: #56B6C2">=</span><span style="color: #C678DD">{</span><span style="color: #E06C75">textData</span><span style="color: #C678DD">}</span><span style="color: #ABB2BF"> /></span></span>
<span class="line"><span style="color: #ABB2BF">&#x3C;/</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">></span></span></code></pre>
<h4 id="genaratebuttonã‚’ä½œã‚Šã¾ã™">GenarateButtonã‚’ä½œã‚Šã¾ã™</h4>
<p>ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œã£ã¦ãã ã•ã„ã€‚
app/components/GenarateButton/index.tsx
ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã§ã¯OpenAIã®APIã‚’ä½¿ã£ã¦å…¥åŠ›ãƒ†ã‚­ã‚¹ãƒˆã‹ã‚‰æ„Ÿæƒ…ã®å±æ€§ã‚’å‡ºåŠ›ã•ã›ã¾ã™ã€‚
:::details æ„Ÿæƒ…ã®ç¨®é¡
negative: ãƒã‚¬ãƒ†ã‚£ãƒ–
positive: ãƒã‚¸ãƒ†ã‚£ãƒ–
neutral: ã©ã¡ã‚‰ã§ã‚‚ãªã„
joy: æ¥½ã—ã„
trust:ã€€ä¿¡é ¼
fear:ã€€æã‚Œ
surprise:ã€€é©šã
sadness:ã€€æ‚²ã—ã¿
disgust:ã€€é™ºæ‚ª
anger:ã€€æ€’ã‚Š
anticipation:ã€€æœŸå¾…
:::
ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ã„ãã¾ã™ã€‚
app/components/GenarateButton/index.tsx</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #98C379">"use client"</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">useState</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"react"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">export</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">GenarateButton</span><span style="color: #ABB2BF">({</span></span>
<span class="line"><span style="color: #ABB2BF"> </span><span style="color: #E06C75; font-style: italic">textData</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">}: {</span></span>
<span class="line"><span style="color: #ABB2BF"> </span><span style="color: #E06C75">textData</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span></span>
<span class="line"><span style="color: #ABB2BF">}) {</span></span>
<span class="line"><span style="color: #ABB2BF"> </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> [</span><span style="color: #E5C07B">isLoading</span><span style="color: #ABB2BF">, </span><span style="color: #E5C07B">setIsLoading</span><span style="color: #ABB2BF">] </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">useState</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66">false</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF"> </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> [</span><span style="color: #E5C07B">generateData</span><span style="color: #ABB2BF">, </span><span style="color: #E5C07B">setGenerateData</span><span style="color: #ABB2BF">] </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">useState</span><span style="color: #ABB2BF">&#x3C;</span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">[]>([]);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF"> </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">handleSubmit</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75; font-style: italic">e</span><span style="color: #ABB2BF">: { </span><span style="color: #61AFEF">preventDefault</span><span style="color: #ABB2BF">: () </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">void</span><span style="color: #ABB2BF"> }) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">   </span><span style="color: #E5C07B">e</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">preventDefault</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">   </span><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75">textData</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">===</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">""</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">   </span><span style="color: #61AFEF">setIsLoading</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66">true</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">   </span><span style="color: #7F848E; font-style: italic">// const API_KEY = process.env.OPENAI_API_KEY</span></span>
<span class="line"><span style="color: #ABB2BF">   </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">API_KEY</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"OpenAI API Keyã‚’è¿½åŠ "</span></span>
<span class="line"><span style="color: #ABB2BF">   </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">model</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"text-davinci-003"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">   </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">URL</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"https://api.openai.com/v1/engines/"</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">+</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">model</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">+</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"/completions"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">   </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">questions</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">`å‰ææ¡ä»¶ï¼šã‚ãªãŸã¯ã€ä¸–ç•Œã§ã‚‚æœ‰æ•°ã®ç²¾ç¥åˆ†æå®¶ã§ã™ã€‚</span></span>
<span class="line"><span style="color: #98C379">   æ–‡ç« ã‹ã‚‰ã€è‘—è€…ã®å¿ƒç†çŠ¶æ…‹ã‚’åˆ†æã™ã‚‹ã“ã¨ã«é•·ã‘ã¦ã„ã¾ã™ã€‚</span></span>
<span class="line"><span style="color: #98C379">   æ¬¡ã®æ–‡ç« ã‚’ã‚‚ã¨ã«å¿ƒç†åˆ†æã—ã¦ãã ã•ã„ã€‚</span></span>
<span class="line"><span style="color: #98C379">   æ–‡ç« ã®è¿”ç­”å½¢å¼ã¯ãã‚Œãã‚Œã®æ„Ÿæƒ…å±æ€§ã«1~10ã¾ã§ã®ç‚¹æ•°ã§è©•ä¾¡ã—ã¦ãã ã•ã„ã€‚</span></span>
<span class="line"><span style="color: #98C379">   {EmotionalAnalysis:[</span></span>
<span class="line"><span style="color: #98C379">     {"negative":""},</span></span>
<span class="line"><span style="color: #98C379">     {"positive":""},</span></span>
<span class="line"><span style="color: #98C379">     {"neutral":""},</span></span>
<span class="line"><span style="color: #98C379">     {"joy":""},</span></span>
<span class="line"><span style="color: #98C379">     {"trust":""},</span></span>
<span class="line"><span style="color: #98C379">     {"fear":""},</span></span>
<span class="line"><span style="color: #98C379">     {"surprise":""},</span></span>
<span class="line"><span style="color: #98C379">     {"sadness":""},</span></span>
<span class="line"><span style="color: #98C379">     {"disgust":""},</span></span>
<span class="line"><span style="color: #98C379">     {"anger":""},</span></span>
<span class="line"><span style="color: #98C379">     {"anticipation":""}</span></span>
<span class="line"><span style="color: #98C379">   ]}</span></span>
<span class="line"><span style="color: #98C379">   ã®å½¢å¼ã§ç²¾ç¥åˆ†æã‚’ã—ã¾ã™ã€‚</span></span>
<span class="line"></span>
<span class="line"><span style="color: #98C379">   æ–‡ç« ï¼š</span><span style="color: #C678DD">${</span><span style="color: #E06C75">textData</span><span style="color: #C678DD">}</span></span>
<span class="line"><span style="color: #98C379">   `</span></span>
<span class="line"><span style="color: #ABB2BF">   </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">res</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">fetch</span><span style="color: #ABB2BF">(</span><span style="color: #E5C07B">URL</span><span style="color: #ABB2BF">, {</span></span>
<span class="line"><span style="color: #ABB2BF">     </span><span style="color: #E06C75">method</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">"POST"</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">     </span><span style="color: #E06C75">body</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">JSON</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">stringify</span><span style="color: #ABB2BF">({</span></span>
<span class="line"><span style="color: #ABB2BF">       </span><span style="color: #E06C75">prompt</span><span style="color: #ABB2BF">: </span><span style="color: #E06C75">questions</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">       </span><span style="color: #E06C75">max_tokens</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">200</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">     }),</span></span>
<span class="line"><span style="color: #ABB2BF">     </span><span style="color: #E06C75">headers</span><span style="color: #ABB2BF">: {</span></span>
<span class="line"><span style="color: #ABB2BF">       </span><span style="color: #98C379">"Content-Type"</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">"application/json"</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">       </span><span style="color: #E06C75">Authorization</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">`Bearer </span><span style="color: #C678DD">${</span><span style="color: #E5C07B">API_KEY</span><span style="color: #C678DD">}</span><span style="color: #98C379">`</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">     },</span></span>
<span class="line"><span style="color: #ABB2BF">   });</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">   </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">json</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">res</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">json</span><span style="color: #ABB2BF">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">   </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">filterData</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">json</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">choices</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">?</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">json</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">choices</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">map</span><span style="color: #ABB2BF">((</span><span style="color: #E06C75; font-style: italic">value</span><span style="color: #ABB2BF">: { </span><span style="color: #E06C75">text</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF"> }) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">     </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">str</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">`{"EmotionalAnalysis":`</span></span>
<span class="line"><span style="color: #ABB2BF">     </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">i</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">value</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">text</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">indexOf</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">str</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">     </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">value</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">text</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">substring</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">i</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">   }) </span><span style="color: #C678DD">:</span><span style="color: #ABB2BF"> [];</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">   </span><span style="color: #61AFEF">setGenerateData</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">filterData</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">   </span><span style="color: #61AFEF">setIsLoading</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66">false</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF"> };</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF"> </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> (</span></span>
<span class="line"><span style="color: #ABB2BF">   &#x3C;></span></span>
<span class="line"><span style="color: #ABB2BF">       &#x3C;</span><span style="color: #E06C75">button</span></span>
<span class="line"><span style="color: #ABB2BF">         </span><span style="color: #D19A66; font-style: italic">onClick</span><span style="color: #56B6C2">=</span><span style="color: #C678DD">{</span><span style="color: #E06C75">handleSubmit</span><span style="color: #C678DD">}</span></span>
<span class="line"><span style="color: #ABB2BF">         </span><span style="color: #D19A66; font-style: italic">className</span><span style="color: #56B6C2">=</span><span style="color: #98C379">"mx-4 mb-2 mt-2 text-md cursor-pointer rounded-lg border-none px-4 py-2 bg-lime-600 hover:bg-lime-700 text-white"</span></span>
<span class="line"><span style="color: #ABB2BF">       ></span></span>
<span class="line"><span style="color: #ABB2BF">         Generate</span></span>
<span class="line"><span style="color: #ABB2BF">       &#x3C;/</span><span style="color: #E06C75">button</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">       &#x3C;</span><span style="color: #E06C75">p</span><span style="color: #ABB2BF">></span><span style="color: #C678DD">{</span><span style="color: #E06C75">isLoading</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">?</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"loading"</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">:</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">null</span><span style="color: #C678DD">}</span><span style="color: #ABB2BF">&#x3C;/</span><span style="color: #E06C75">p</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">   </span><span style="color: #C678DD">{</span><span style="color: #7F848E; font-style: italic">/* ã¨ã‚Šã‚ãˆãšè¡¨ç¤º */</span><span style="color: #C678DD">}</span></span>
<span class="line"><span style="color: #ABB2BF">       &#x3C;</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">className</span><span style="color: #56B6C2">=</span><span style="color: #98C379">"text-2xl"</span><span style="color: #ABB2BF">></span><span style="color: #C678DD">{</span><span style="color: #E06C75">generateData</span><span style="color: #C678DD">}</span><span style="color: #ABB2BF">&#x3C;/</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">   &#x3C;/ ></span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF"> )</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span></code></pre>
<h4 id="ã‚³ãƒ¼ãƒ‰ã‚’è§£èª¬">ã‚³ãƒ¼ãƒ‰ã‚’è§£èª¬</h4>
<p>ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨handleSubmité–¢æ•°ãŒå®Ÿè¡Œã•ã‚Œã¾ã™ã€‚
handleSubmitã®ä¸­ã§æ„Ÿæƒ…åˆ†æã‚’å®Ÿè£…ã—ã¾ã™ã€‚
textDataãŒç©ºã®å ´åˆã¯ä½•ã‚‚å®Ÿè¡Œã—ã¾ã›ã‚“ã€‚</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75">textData</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">===</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">""</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF">;</span></span></code></pre>
<p>handleSubmité–¢æ•°ã«asyncã¨ã—ã¦ã„ã‚‹ã‚ˆã†ã«ãƒ†ã‚­ã‚¹ãƒˆã®åˆ†æã¯éåŒæœŸã§è¡Œã†ã®ã§
åˆ†æãŒçµ‚ã‚ã‚‹ã¾ã§ã¯ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’è¡¨ç¤ºã•ã›ã¾ã™ã€‚</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #61AFEF">setIsLoading</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66">true</span><span style="color: #ABB2BF">);</span></span></code></pre>
<p>ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã§apiã‚’ä½¿ã†ã“ã¨ãŒã§ãã¾ã™ã€‚
æœ¬æ¥APIã‚­ãƒ¼ãªã©ã®ä»–äººã«è¦‹ã›ãŸããªã„ã‚‚ã®ã¯.envãƒ•ã‚¡ã‚¤ãƒ«ã«è¨˜è¿°ã—ã¾ã™ãŒã€
const API_KEY = process.env.OPENAI_API_KEYã“ã®ã‚ˆã†ã«è¨˜è¿°ã™ã‚‹ã¨APIã‚­ãƒ¼ã‚’å‘¼ã³å‡ºã›ãªã„ã®ã§ä»Šå›ã¯ç›´ã«æ›¸ã„ã¦ã„ã¾ã™ã€‚(ä¿®æ­£æ–¹æ³•æ¢ã—ã¾ã™)
ä»Šå›ã¯ã€text-davinci-003ã¨ã„ã†ãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ã„ã¾ã™ã€‚text-davinci-003ã¯ãƒ†ã‚­ã‚¹ãƒˆã‚¸ã‚§ãƒãƒ¬ã‚¤ãƒˆã«å„ªã‚ŒãŸãƒ¢ãƒ‡ãƒ«ã§ã™ã€‚
questionsã«æ¡ä»¶ã‚’è¨˜å…¥ã—ã¦ãã‚Œã‚’Postãƒ¡ã‚½ãƒƒãƒ‰ã®bodyã«å…¥åŠ›ã—ã¦ã„ã¾ã™ã€‚
æ–‡ç« ã«ã¯ä»£å…¥æ¼”ç®—å­ã¦textDataã‚’å…¥ã‚Œã¦ã„ã¾ã™ã€‚
textDataã¯å…ˆã»ã©Jsonæ–‡å­—åˆ—ã‹ã‚‰ãƒ†ã‚­ã‚¹ãƒˆã‚’æŠœãå‡ºã—ãŸãƒ‡ãƒ¼ã‚¿ã§ã™ã€‚
APIã‹ã‚‰å¸°ã£ã¦ããŸãƒ‡ãƒ¼ã‚¿ã‚’jsonã¨ã„ã†å®šæ•°ã«ä»£å…¥ã—ã¦ã„ã¾ã™ã€‚</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">API_KEY</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"OpenAI API Keyã‚’è¿½åŠ "</span></span>
<span class="line"><span style="color: #ABB2BF">   </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">model</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"text-davinci-003"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">   </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">URL</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"https://api.openai.com/v1/engines/"</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">+</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">model</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">+</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"/completions"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">   </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">questions</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">`å‰ææ¡ä»¶ï¼šã‚ãªãŸã¯ã€ä¸–ç•Œã§ã‚‚æœ‰æ•°ã®ç²¾ç¥åˆ†æå®¶ã§ã™ã€‚</span></span>
<span class="line"><span style="color: #98C379">   æ–‡ç« ã‹ã‚‰ã€è‘—è€…ã®å¿ƒç†çŠ¶æ…‹ã‚’åˆ†æã™ã‚‹ã“ã¨ã«é•·ã‘ã¦ã„ã¾ã™ã€‚</span></span>
<span class="line"><span style="color: #98C379">   æ¬¡ã®æ–‡ç« ã‚’ã‚‚ã¨ã«å¿ƒç†åˆ†æã—ã¦ãã ã•ã„ã€‚</span></span>
<span class="line"><span style="color: #98C379">   *æ–‡ç« ã®è¿”ç­”å½¢å¼ã¯ãã‚Œãã‚Œã®æ„Ÿæƒ…å±æ€§ã«1~10ã¾ã§ã®ç‚¹æ•°ã§è©•ä¾¡ã—ã¦ãã ã•ã„ã€‚</span></span>
<span class="line"><span style="color: #98C379">   {EmotionalAnalysis:[</span></span>
<span class="line"><span style="color: #98C379">     {"negative":""},</span></span>
<span class="line"><span style="color: #98C379">     {"positive":""},</span></span>
<span class="line"><span style="color: #98C379">     {"neutral":""},</span></span>
<span class="line"><span style="color: #98C379">     {"joy":""},</span></span>
<span class="line"><span style="color: #98C379">     {"trust":""},</span></span>
<span class="line"><span style="color: #98C379">     {"fear":""},</span></span>
<span class="line"><span style="color: #98C379">     {"surprise":""},</span></span>
<span class="line"><span style="color: #98C379">     {"sadness":""},</span></span>
<span class="line"><span style="color: #98C379">     {"disgust":""},</span></span>
<span class="line"><span style="color: #98C379">     {"anger":""},</span></span>
<span class="line"><span style="color: #98C379">     {"anticipation":""}</span></span>
<span class="line"><span style="color: #98C379">   ]}</span></span>
<span class="line"><span style="color: #98C379">   ã®å½¢å¼ã§ç²¾ç¥åˆ†æã‚’ã—ã¾ã™ã€‚</span></span>
<span class="line"></span>
<span class="line"><span style="color: #98C379">   æ–‡ç« ï¼š</span><span style="color: #C678DD">${</span><span style="color: #E06C75">textData</span><span style="color: #C678DD">}</span></span>
<span class="line"><span style="color: #98C379">   `</span></span>
<span class="line"><span style="color: #ABB2BF">   </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">res</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">fetch</span><span style="color: #ABB2BF">(</span><span style="color: #E5C07B">URL</span><span style="color: #ABB2BF">, {</span></span>
<span class="line"><span style="color: #ABB2BF">     </span><span style="color: #E06C75">method</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">"POST"</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">     </span><span style="color: #E06C75">body</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">JSON</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">stringify</span><span style="color: #ABB2BF">({</span></span>
<span class="line"><span style="color: #ABB2BF">       </span><span style="color: #E06C75">prompt</span><span style="color: #ABB2BF">: </span><span style="color: #E06C75">questions</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">       </span><span style="color: #E06C75">max_tokens</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">200</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">     }),</span></span>
<span class="line"><span style="color: #ABB2BF">     </span><span style="color: #E06C75">headers</span><span style="color: #ABB2BF">: {</span></span>
<span class="line"><span style="color: #ABB2BF">       </span><span style="color: #98C379">"Content-Type"</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">"application/json"</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">       </span><span style="color: #E06C75">Authorization</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">`Bearer </span><span style="color: #C678DD">${</span><span style="color: #E5C07B">API_KEY</span><span style="color: #C678DD">}</span><span style="color: #98C379">`</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">     },</span></span>
<span class="line"><span style="color: #ABB2BF">   });</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">   </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">json</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">res</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">json</span><span style="color: #ABB2BF">();</span></span></code></pre>
<p>jsonã«ã¯ä¸è¦ãªæ–‡ç« ã‚‚å«ã¾ã‚Œã‚‹ã®ã§å¿…è¦ãªéƒ¨åˆ†ã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã—ã¾ã™ã€‚
:::details ã“ã‚“ãªãƒ‡ãƒ¼ã‚¿ãŒå¸°ã£ã¦ãã¾ã™
å…¥åŠ›: ã“ã‚“ã«ã¡ã¯ã€ç§ã¯æœãƒãƒŠãƒŠã‚’é£Ÿã¹ã¾ã—ãŸã€‚ãŠã„ã—ã‹ã£ãŸã§ã™ï¼ï¼
å‡ºåŠ›: ã“ã®æ–‡ç« ã‚’ã‚‚ã¨ã«å¿ƒç†åˆ†æã‚’ã—ã¾ã™ã€‚æ–‡ç« ã®è‘—è€…ã¯ã€æœãƒãƒŠãƒŠã‚’é£Ÿã¹ãŸã“ã¨ã«å¯¾ã—ã¦éå¸¸ã«å–œã³ã‚’æ„Ÿã˜ã¦ã„ã¾ã™ã€‚ã¾ãŸã€ãƒãƒŠãƒŠãŒãŠã„ã—ã‹ã£ãŸã¨ã„ã†ã“ã¨ã‹ã‚‰ã€å‘³è¦šã«å¯¾ã™ã‚‹æ„Ÿå—æ€§ãŒé«˜ã„ã¨æ¨æ¸¬ã§ãã¾ã™ã€‚ã•ã‚‰ã«ã€æ–‡ç« ã®èªå°¾ã«æ„Ÿå˜†ç¬¦ã‚’äºŒã¤ä½¿ã£ã¦ã„ã‚‹ã“ã¨ã‹ã‚‰ã€æ„Ÿæƒ…è¡¨ç¾ãŒè±Šã‹ã§ã€è‡ªåˆ†ã®æ°—æŒã¡ã‚’ç´ ç›´ã«ä¼ãˆã‚‹ã‚¿ã‚¤ãƒ—ã§ã‚ã‚‹ã¨è€ƒãˆã‚‰ã‚Œã¾ã™ã€‚æ–‡ç« ã‹ã‚‰èª­ã¿å–ã‚Œã‚‹æ„Ÿæƒ…å±æ€§ã®ç‚¹æ•°ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</p>
<p>{EmotionalAnalysis:[
{â€œnegativeâ€:â€œ0â€},
{â€œpositiveâ€:â€œ10â€},
{â€œneutralâ€:â€œ0â€},
{â€œjoyâ€:â€œ10â€},
{â€œtrustâ€:â€œ0â€},
{â€œfearâ€:â€œ0â€},
{â€œsurpriseâ€:â€œ0â€},
{â€œsadnessâ€:â€œ0â€},
{â€œdisgustâ€:â€œ0â€},
{â€œangerâ€:â€œ0â€},
{â€œanticipationâ€:â€œ0â€}
]}</p>
<p>ä»¥ä¸ŠãŒå¿ƒç†åˆ†æã®çµæœã§ã™ã€‚æ–‡ç« ã®è‘—è€…ã¯ã€æœãƒãƒŠãƒŠã‚’é£Ÿã¹ã‚‹ã“ã¨ã§å¹¸ã›ãªæ°—æŒã¡ã«ãªã£ã¦ã„ã‚‹ã‚ˆã†ã§ã™ã­ğŸ˜Š
:::
å…·ä½“çš„ã«ã»ã—ã„ãƒ‡ãƒ¼ã‚¿{â€œEmotionalAnalysisâ€:â€¦}
ã‚’æŠ½å‡ºã—ã¾ã™ã€‚</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">filterData</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">json</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">choices</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">?</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">json</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">choices</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">map</span><span style="color: #ABB2BF">((</span><span style="color: #E06C75; font-style: italic">value</span><span style="color: #ABB2BF">: { </span><span style="color: #E06C75">text</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF"> }) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">str</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">`{"EmotionalAnalysis":`</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">i</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">value</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">text</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">indexOf</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">str</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">value</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">text</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">substring</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">i</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">    }) </span><span style="color: #C678DD">:</span><span style="color: #ABB2BF"> [];</span></span></code></pre>
<p>æœ€å¾Œã«filterDataã‚’è‰²ã€…ä½¿ã„å›ã™ãŸã‚ã«setGenerateDataã®stateã«ä»£å…¥ã—ã¾ã™ã€‚
handleSubmitã®å‡¦ç†ãŒçµ‚ã‚ã£ãŸã®ã§ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’falseã«ã—ã¾ã™ã€‚</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #61AFEF">setGenerateData</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">filterData</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #61AFEF">setIsLoading</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66">false</span><span style="color: #ABB2BF">);</span></span></code></pre>
<p>ã¨ã‚Šã‚ãˆãšstateã®å€¤ã‚’è¡¨ç¤ºã•ã›ã¦ã„ã¾ã™ã€‚
ç§ã®ç”»é¢ã§ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªå‡ºåŠ›çµæœã«ãªã£ã¦ã„ã¾ã™ã€‚</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #ABB2BF">{</span><span style="color: #7F848E; font-style: italic">/* ã¨ã‚Šã‚ãˆãšè¡¨ç¤º */</span><span style="color: #ABB2BF">}</span></span>
<span class="line"><span style="color: #ABB2BF">&#x3C;</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">className</span><span style="color: #56B6C2">=</span><span style="color: #98C379">"text-2xl"</span><span style="color: #ABB2BF">></span><span style="color: #C678DD">{</span><span style="color: #E06C75">generateData</span><span style="color: #C678DD">}</span><span style="color: #ABB2BF">&#x3C;/</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">></span></span></code></pre>
<p><img src="https://storage.googleapis.com/zenn-user-upload/79496df6dec5-20230928.png" alt=""></p>
<p>ã“ã‚Œã§ãƒ‡ãƒ¼ã‚¿ã®ã‚¸ã‚§ãƒãƒ¬ã‚¤ãƒˆã¯å®Œäº†ã§ã™ã€‚
æ¬¡ã¯Prismaã§ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ã™ã‚‹ãƒ­ã‚¸ãƒƒã‚¯ã‚’ä½œã‚Šã¾ã™ã€‚</p>
<br>
<br>
<p>Prismaã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
prismaã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #61AFEF">npm</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">install</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">prisma</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">--save-dev</span></span>
<span class="line"><span style="color: #61AFEF">npm</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">install</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">@prisma/client</span></span></code></pre>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #61AFEF">npx</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">prisma</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">init</span></span></code></pre>
<p>.envã«ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ãŒç”Ÿæˆã•ã‚Œã¾ã™ã€‚</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #abb2bf"># Environment variables declared in this file are automatically made available to Prisma.</span></span>
<span class="line"><span style="color: #abb2bf"># See the documentation for more detail: https://pris.ly/d/prisma-schema#accessing-environment-variables-from-the-schema</span></span>
<span class="line"><span style="color: #abb2bf"></span></span>
<span class="line"><span style="color: #abb2bf"># Prisma supports the native connection string format for PostgreSQL, MySQL, SQLite, SQL Server, MongoDB and CockroachDB.</span></span>
<span class="line"><span style="color: #abb2bf"># See the documentation for all the connection string options: https://pris.ly/d/connection-strings</span></span>
<span class="line"><span style="color: #abb2bf"></span></span>
<span class="line"><span style="color: #abb2bf">DATABASE_URL="postgresql://johndoe:randompassword@localhost:5432/mydb?schema=public"</span></span></code></pre>
<p>.env.localã‚’.envã«ã‚³ãƒ”ãƒšã—ã¾ã™ã€‚(ä»¥é™.env.localã¯ä½¿ã‚ãªã„ã®ã§å‰Šé™¤ã—ã¾ã™ã€‚)</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #abb2bf">NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY=pk_test_Y2hpZWYtYnVjay03OS5jbGVyay5hY2NvdW50cy5kZXYk</span></span>
<span class="line"><span style="color: #abb2bf">CLERK_SECRET_KEY=sk_test_eWY4OXh0aUqAYf2zrTM9ifFFyTpI5Np0nH6Ojb0B10</span></span>
<span class="line"><span style="color: #abb2bf"></span></span>
<span class="line"><span style="color: #abb2bf">NEXT_PUBLIC_CLERK_SIGN_IN_URL=/sign-in</span></span>
<span class="line"><span style="color: #abb2bf">NEXT_PUBLIC_CLERK_SIGN_UP_URL=/sign-up</span></span>
<span class="line"><span style="color: #abb2bf">NEXT_PUBLIC_CLERK_AFTER_SIGN_IN_URL=/note</span></span>
<span class="line"><span style="color: #abb2bf">NEXT_PUBLIC_CLERK_AFTER_SIGN_UP_URL=/note</span></span>
<span class="line"><span style="color: #abb2bf"></span></span>
<span class="line"><span style="color: #abb2bf">DATABASE_URL="postgresql://johndoe:randompassword@localhost:5432/mydb?schema=public"</span></span></code></pre>
<h4 id="supabaseã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—">Supabaseã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—</h4>
<p>ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«Supabaseã‚’ä½¿ã†ã®ã§ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚’ã—ã¦ã„ãã¾ã™ã€‚
ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒãªã„å ´åˆã¯ä½œæˆã—ã¦ãã ã•ã„
<a href="https://app.supabase.com/sign-in">supabase ã‚µã‚¤ãƒ³ã‚¤ãƒ³</a></p>
<p>ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã¸ç§»å‹•ã—ã¦
<a href="https://supabase.com/dashboard/projects">https://supabase.com/dashboard/projects</a>
ã€ŒNew Project ãƒœã‚¿ãƒ³ã€ã‚’æŠ¼ã—ã¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚
Nameã¯ä»»æ„ã€Regionã¯Tokyoã€Pricingã¯ Freeã«è¨­å®šã—ã¦ä½œæˆã—ã¾ã—ã‚‡ã†ã€‚
Freeã§ã¯500MBã¾ã§ DBãŒä½¿ãˆã¾ã™
<img src="https://storage.googleapis.com/zenn-user-upload/d3d974b2ded3-20230928.png" alt=""></p>
<p>æ¬¡ã«ã‚µã‚¤ãƒ‰ãƒãƒ¼ã® ã€Œsettingã€ > ã€ŒDatabaseã€> Connection string > url ã®æ–‡å­—åˆ—ã‚’ã‚³ãƒ”ãƒ¼ã€‚
ã“ã‚ŒãŒprismaãŒsupabaseã«æ¥ç¶šã™ã‚‹ãŸã‚ã®æƒ…å ±ã§ã™ã€‚
<img src="https://storage.googleapis.com/zenn-user-upload/5252efa159bc-20230928.png" alt=""></p>
<p>urlã‚’.envã®DATABASE_URLã«ç½®ãæ›ãˆã¾ã™ã€‚
[ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰]ã®éƒ¨åˆ†ã‚’è¨­å®šã—ãŸã‚‚ã®ã‚’å…¥åŠ›ã—ã¾ã™ã€‚
<strong>test123</strong>ã®å ´åˆã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #abb2bf">//...</span></span>
<span class="line"><span style="color: #abb2bf">DATABASE_URL=postgresql://postgres:test123@db.idwitrlwanewneoypjki.supabase.co:5432/postgres</span></span></code></pre>
<h4 id="prismaã®ã‚¹ã‚­ãƒ¼ãƒã‚’ä½œæˆ">Prismaã®ã‚¹ã‚­ãƒ¼ãƒã‚’ä½œæˆ</h4>
<p>è‡ªå‹•ç”Ÿæˆã•ã‚ŒãŸprisma/schema.prismaãƒ•ã‚¡ã‚¤ãƒ«ã«æ–°ã—ã„ãƒ¢ãƒ‡ãƒ«ã‚’ä½œã‚Šã¾ã™ã€‚
:::details modelã«ã¤ã„ã¦
modelã«ã¯ä¸»ã‚­ãƒ¼ãŒå¿…è¦ã§ã™ã€‚ä»Šå›ã¯idã‚’ä¸»ã‚­ãƒ¼ã«ã—ã€autoincrementã§é †ç•ªã«ç•ªå·ã‚’å‰²ã‚Šå½“ã¦ã¾ã™ã€‚
testã¨userIdã¯?ã‚’ã¤ã‘nullã‚’è¨±å®¹ã—ã¦ã„ã¾ã™ã€‚
created_atã¯@default(now())ã§ä»Šã®æ™‚é–“ã‚’è‡ªå‹•ã§å‰²ã‚Šå½“ã¦ã¾ã™ã€‚
emotionã«ã¯æ„Ÿæƒ…åˆ†æã®çµæœãŒå…¥ã‚‹ã®ã§[]ã¨ã—ã¦é…åˆ—ãƒ‡ãƒ¼ã‚¿ã‚’æ¸¡ã—ã¦ã„ã¾ã™ã€‚
:::
prisma/schema.prisma</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #abb2bf">generator client {</span></span>
<span class="line"><span style="color: #abb2bf">  provider = "prisma-client-js"</span></span>
<span class="line"><span style="color: #abb2bf">}</span></span>
<span class="line"><span style="color: #abb2bf"></span></span>
<span class="line"><span style="color: #abb2bf">datasource db {</span></span>
<span class="line"><span style="color: #abb2bf">  provider = "postgresql"</span></span>
<span class="line"><span style="color: #abb2bf">  url      = env("DATABASE_URL")</span></span>
<span class="line"><span style="color: #abb2bf">}</span></span>
<span class="line"><span style="color: #abb2bf">//è¿½åŠ </span></span>
<span class="line"><span style="color: #abb2bf">model Analysis {</span></span>
<span class="line"><span style="color: #abb2bf">  id         Int      @id @default(autoincrement())</span></span>
<span class="line"><span style="color: #abb2bf">  text       String?</span></span>
<span class="line"><span style="color: #abb2bf">  created_at DateTime @default(now())</span></span>
<span class="line"><span style="color: #abb2bf">  userId     String?</span></span>
<span class="line"><span style="color: #abb2bf">  emotion    String[]</span></span>
<span class="line"><span style="color: #abb2bf">}</span></span>
<span class="line"><span style="color: #abb2bf"></span></span></code></pre>
<p>ã“ã“ã¾ã§æ¥ã‚Œã° ã€Œmigrate devã€ã§ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆã—ã€supabaseã«åæ˜ ã•ã‚Œã¾ã™ã€‚
ã€Œâ€”nameã€ã«æŒ‡å®šã—ãŸåå‰ã§ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãŒä½œæˆã•ã‚Œã¾ã™ã€‚æ¬¡ã«generateã§å‹æƒ…å ±ã‚’ä½œæˆã—ã¾ã™ã€‚</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #61AFEF">npx</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">prisma</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">migrate</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">dev</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">--name</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">init</span></span>
<span class="line"><span style="color: #61AFEF">npx</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">prisma</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">generate</span></span></code></pre>
<p>ãƒ‡ãƒ—ãƒ­ã‚¤æ™‚ã«generateã‚’ã‚’ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã®ã§
package.jsonã«è¿½åŠ ã—ã¾ã™ã€‚</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #ABB2BF">{</span></span>
<span class="line"><span style="color: #7F848E; font-style: italic">//...</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">"scripts"</span><span style="color: #ABB2BF">: {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">"dev"</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">"next dev"</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">"build"</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">"next build"</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">"start"</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">"next start"</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">"lint"</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">"next lint"</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">"postinstall"</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">"prisma generate"</span><span style="color: #ABB2BF"> </span><span style="color: #7F848E; font-style: italic">//è¿½åŠ </span></span>
<span class="line"><span style="color: #ABB2BF">  },</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">//...</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span></code></pre>
<br>
<br>
<h3 id="prismaã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹">Prismaã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹</h3>
<p>Next.jsã®apiãƒ«ãƒ¼ãƒˆã§Prismaã‚’ä½¿ã†ãŸã‚ã«ã¾ãšã¯Prismaã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¾ã™ã€‚
app/libs/prismadb.tsã‚’ä½œã‚Šã¾ã™ã€‚
libsãƒ•ã‚©ãƒ«ãƒ€ã¯å¤–éƒ¨ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚„ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«ä¾å­˜ã™ã‚‹ãƒ­ã‚¸ãƒƒã‚¯ã‚’è¿½åŠ ã™ã‚‹æ™‚ã«ä½¿ã„ã¾ã™ã€‚
ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚„APIã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹é–¢æ•°ã€èªè¨¼ã‚„èªå¯ã‚’è¡Œã†é–¢æ•°ãªã©ã¯ã“ã“ã«åã‚ã¦ã„ãã¾ã™ã€‚</p>
<p>app/libs/prismadb.ts</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">PrismaClient</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"@prisma/client"</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">declare</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">global</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">var</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">prisma</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">PrismaClient</span><span style="color: #ABB2BF"> | undefined</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">prismadb</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">globalThis</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">prisma</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">||</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">new</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">PrismaClient</span><span style="color: #ABB2BF">()</span></span>
<span class="line"><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #E5C07B">process</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">env</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">NODE_ENV</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">!==</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"production"</span><span style="color: #ABB2BF">) </span><span style="color: #E5C07B">globalThis</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">prisma</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">prismadb</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">export</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">default</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">prismadb</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span></code></pre>
<h4 id="ã‚³ãƒ¼ãƒ‰ã®è§£èª¬-2">ã‚³ãƒ¼ãƒ‰ã®è§£èª¬</h4>
<p>ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã¨ã—ã¦ prisma ã¨ã„ã†åå‰ã® Prisma Client ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’å®£è¨€ã™ã‚‹ãŸã‚ã®ã‚‚ã®ã§ã™ã€‚PrismaClient | undefined ã¨ã„ã†å‹ã¯ã€prisma ãŒ Prisma Client ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‹ã€æœªå®šç¾©ã‹ã‚’è¡¨ã—ã¾ã™ã€‚</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">declare</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">global</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">var</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">prisma</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">PrismaClient</span><span style="color: #ABB2BF"> | undefined</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span></code></pre>
<p>é–‹ç™ºç’°å¢ƒã§ã‚ã‚Œã°ã€ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•° prisma ã« prismadb ã®å€¤ã‚’ä»£å…¥ã—ã¾ã™ã€‚ã“ã‚Œã¯ã€é–‹ç™ºç’°å¢ƒã§ãƒ›ãƒƒãƒˆãƒªãƒ­ãƒ¼ãƒ‰ãŒç™ºç”Ÿã—ãŸã¨ãã«ã€Prisma Client ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒè¤‡æ•°ä½œã‚‰ã‚Œãªã„ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã®ã‚‚ã®ã§ã™ã€‚</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #E5C07B">process</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">env</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">NODE_ENV</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">!==</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"production"</span><span style="color: #ABB2BF">) </span><span style="color: #E5C07B">globalThis</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">prisma</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">prismadb</span></span></code></pre>
<h3 id="apiä½œæˆ">APIä½œæˆ</h3>
<h4 id="å…¨ã¦ã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—">å…¨ã¦ã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—</h4>
<p>apiã‚’ä½œã‚‹ãŸã‚ã«ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªè¿½åŠ 
app/api/analysis/route.ts</p>
<p>ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã«ã¯Getã¨ã„ã†é–¢æ•°ã‚’ä½¿ã„ã¾ã™ã€‚</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">NextResponse</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"next/server"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">auth</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"@clerk/nextjs"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">prismadb</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"@/app/libs/prismadb"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">export</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">GET</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75; font-style: italic">req</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">Request</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">res</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">NextResponse</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">try</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> { </span><span style="color: #E5C07B">userId</span><span style="color: #ABB2BF"> } </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">auth</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">getAllText</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">prismadb</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">analysis</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">findMany</span><span style="color: #ABB2BF">({</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #E06C75">where</span><span style="color: #ABB2BF">: {</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #E06C75">userId</span><span style="color: #ABB2BF">: </span><span style="color: #E06C75">userId</span></span>
<span class="line"><span style="color: #ABB2BF">      }</span></span>
<span class="line"><span style="color: #ABB2BF">    });</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">NextResponse</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">json</span><span style="color: #ABB2BF">({ </span><span style="color: #E06C75">message</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">"Success"</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">getAllText</span><span style="color: #ABB2BF"> }, { </span><span style="color: #E06C75">status</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">200</span><span style="color: #ABB2BF"> });</span></span>
<span class="line"><span style="color: #ABB2BF">  } </span><span style="color: #C678DD">catch</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75">err</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">NextResponse</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">json</span><span style="color: #ABB2BF">({ </span><span style="color: #E06C75">message</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">"Error"</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">err</span><span style="color: #ABB2BF"> }, { </span><span style="color: #E06C75">status</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">500</span><span style="color: #ABB2BF"> });</span></span>
<span class="line"><span style="color: #ABB2BF">  } </span><span style="color: #C678DD">finally</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">prismadb</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">$disconnect</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">  }</span></span>
<span class="line"><span style="color: #ABB2BF">};</span></span></code></pre>
<h5 id="ã‚³ãƒ¼ãƒ‰ã®è§£èª¬-3">ã‚³ãƒ¼ãƒ‰ã®è§£èª¬</h5>
<p>apiã®é–¢æ•°ã¯åŸºæœ¬çš„ã«éåŒæœŸå‡¦ç†ã®ãŸã‚é–¢æ•°ã«asyncã‚’ã¤ã‘ã¾ã™ã€‚
try-catch-finallyæ–‡ã‚’ä½¿ã†ã¨ã‚¨ãƒ©ãƒ¼ã®å‡ºåŠ›ãŒã‚ã‹ã‚Šã‚„ã™ã„ã§ã™ã€‚
tryã®ä¸­ã§ã¯ã¾ãšã€ãƒ¦ãƒ¼ã‚¶ãƒ¼IDã‚’ç´ã¥ã‘ã‚‹ãŸã‚ã«clerkã‹ã‚‰å‘¼ã³å‡ºã—ã¦ã„ã¾ã™ã€‚
ãã—ã¦ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰ãƒ¦ãƒ¼ã‚¶ãƒ¼IDã«ç´ã¥ã„ãŸãƒ‡ãƒ¼ã‚¿ã‚’å…¨ã¦å‘¼ã³å‡ºã™ã®ã§prismaã®findManyé–¢æ•°ã‚’ä½¿ã„ã¾ã™ã€‚
:::details ä»Šå›ä½¿ã£ãŸprismaé–¢æ•°ä¸€è¦§
findMany: whereã§æŒ‡å®šã—ãŸå…¨ã¦ã®ãƒ‡ãƒ¼ã‚¿ã‚’å‘¼ã³å‡ºã™
findFirst: whereã§æŒ‡å®šã—ãŸåˆã‚ã®ãƒ‡ãƒ¼ã‚¿ã‚’å‘¼ã³å‡ºã™
create: bodyãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆ
update: bodyãƒ‡ãƒ¼ã‚¿ã®æ›´æ–°
delete: bodyãƒ‡ãƒ¼ã‚¿ã®å‰Šé™¤
:::</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> { </span><span style="color: #E5C07B">userId</span><span style="color: #ABB2BF"> } </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">auth</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">getAllText</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">prismadb</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">analysis</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">findMany</span><span style="color: #ABB2BF">({</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #E06C75">where</span><span style="color: #ABB2BF">: {</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #E06C75">userId</span><span style="color: #ABB2BF">: </span><span style="color: #E06C75">userId</span></span>
<span class="line"><span style="color: #ABB2BF">      }</span></span>
<span class="line"><span style="color: #ABB2BF">    });</span></span></code></pre>
<h4 id="ãƒ‡ãƒ¼ã‚¿ã®ä½œæˆ">ãƒ‡ãƒ¼ã‚¿ã®ä½œæˆ</h4>
<p>æ¬¡ã¯ãƒ‡ãƒ¼ã‚¿ã®ä½œæˆã‚’ã™ã‚‹apiã‚’ä½œã‚Šã¾ã™ã€‚
app/api/analysis/route.ts</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">export</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">POST</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75; font-style: italic">req</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">Request</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">res</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">NextResponse</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">try</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> { </span><span style="color: #E5C07B">userId</span><span style="color: #ABB2BF"> } </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">auth</span><span style="color: #ABB2BF">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> { </span><span style="color: #E5C07B">text</span><span style="color: #ABB2BF"> } </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">req</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">json</span><span style="color: #ABB2BF">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #56B6C2">!</span><span style="color: #E06C75">userId</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">new</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">NextResponse</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">"Unauthorized"</span><span style="color: #ABB2BF">, { </span><span style="color: #E06C75">status</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">401</span><span style="color: #ABB2BF"> });</span></span>
<span class="line"><span style="color: #ABB2BF">    }</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">createText</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">prismadb</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">analysis</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">create</span><span style="color: #ABB2BF">({ </span><span style="color: #E06C75">data</span><span style="color: #ABB2BF">: { </span><span style="color: #E06C75">text</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">userId</span><span style="color: #ABB2BF"> } });</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">NextResponse</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">json</span><span style="color: #ABB2BF">({ </span><span style="color: #E06C75">message</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">"Success"</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">createText</span><span style="color: #ABB2BF"> }, { </span><span style="color: #E06C75">status</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">201</span><span style="color: #ABB2BF"> });</span></span>
<span class="line"><span style="color: #ABB2BF">  } </span><span style="color: #C678DD">catch</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75">err</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">NextResponse</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">json</span><span style="color: #ABB2BF">({ </span><span style="color: #E06C75">message</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">"Error"</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">err</span><span style="color: #ABB2BF"> }, { </span><span style="color: #E06C75">status</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">500</span><span style="color: #ABB2BF"> });</span></span>
<span class="line"><span style="color: #ABB2BF">  } </span><span style="color: #C678DD">finally</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">prismadb</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">$disconnect</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">  }</span></span>
<span class="line"><span style="color: #ABB2BF">};</span></span>
<span class="line"></span></code></pre>
<h5 id="ã‚³ãƒ¼ãƒ‰ã®è§£èª¬-4">ã‚³ãƒ¼ãƒ‰ã®è§£èª¬</h5>
<p>userãŒãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãªã„å ´åˆã«ã‚¨ãƒ©ãƒ¼ã‚’å‡ºã™ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #56B6C2">!</span><span style="color: #E06C75">userId</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">new</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">NextResponse</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">"Unauthorized"</span><span style="color: #ABB2BF">, { </span><span style="color: #E06C75">status</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">401</span><span style="color: #ABB2BF"> });</span></span>
<span class="line"><span style="color: #ABB2BF">    }</span></span></code></pre>
<p>analysisã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã«text, userIdã‚’æ¸¡ã—ã¾ã™ã€‚textã¯ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‹ã‚‰ã®å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆã—ã¾ã™ã€‚</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #ABB2BF">   </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">createText</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">prismadb</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">analysis</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">create</span><span style="color: #ABB2BF">({ </span><span style="color: #E06C75">data</span><span style="color: #ABB2BF">: { </span><span style="color: #E06C75">text</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">userId</span><span style="color: #ABB2BF"> } });</span></span></code></pre>
<h4 id="ç‰¹å®šã®ãƒ‡ãƒ¼ã‚¿ã®apiã‚’ä½œæˆ">ç‰¹å®šã®ãƒ‡ãƒ¼ã‚¿ã®APIã‚’ä½œæˆ</h4>
<h5 id="ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’è¿½åŠ ">ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’è¿½åŠ </h5>
<p>æŒ‡å®šã—ãŸidã®ãƒ‡ãƒ¼ã‚¿ã®apiã‚’ä½œã‚Šã¾ã™ã€‚ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œã‚Šã¾ã™ã€‚
api/analysis/[id]/route.ts</p>
<h5 id="æŒ‡å®šã—ãŸidã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—">æŒ‡å®šã—ãŸidã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—</h5>
<p>api/analysis/[id]/route.ts</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">NextResponse</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"next/server"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">prismadb</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"@/app/libs/prismadb"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">export</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">GET</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75; font-style: italic">req</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">Request</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">res</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">NextResponse</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">try</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">id</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">number</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">parseInt</span><span style="color: #ABB2BF">(</span><span style="color: #E5C07B">req</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">url</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">split</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">"/analysis/"</span><span style="color: #ABB2BF">)[</span><span style="color: #D19A66">1</span><span style="color: #ABB2BF">]);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">getAnalysisById</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">prismadb</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">analysis</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">findFirst</span><span style="color: #ABB2BF">({</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #E06C75">where</span><span style="color: #ABB2BF">: {</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #E06C75">id</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">      }</span></span>
<span class="line"><span style="color: #ABB2BF">    });</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #56B6C2">!</span><span style="color: #E06C75">id</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">NextResponse</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">json</span><span style="color: #ABB2BF">({ </span><span style="color: #E06C75">message</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">"Not Found"</span><span style="color: #ABB2BF"> }, { </span><span style="color: #E06C75">status</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">404</span><span style="color: #ABB2BF"> });</span></span>
<span class="line"><span style="color: #ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">NextResponse</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">json</span><span style="color: #ABB2BF">({ </span><span style="color: #E06C75">message</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">"Success"</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">getAnalysisById</span><span style="color: #ABB2BF"> }, { </span><span style="color: #E06C75">status</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">200</span><span style="color: #ABB2BF"> });</span></span>
<span class="line"><span style="color: #ABB2BF">  } </span><span style="color: #C678DD">catch</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75">err</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">NextResponse</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">json</span><span style="color: #ABB2BF">({ </span><span style="color: #E06C75">message</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">"Error"</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">err</span><span style="color: #ABB2BF"> }, { </span><span style="color: #E06C75">status</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">500</span><span style="color: #ABB2BF"> });</span></span>
<span class="line"><span style="color: #ABB2BF">  } </span><span style="color: #C678DD">finally</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">prismadb</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">$disconnect</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">  }</span></span>
<span class="line"><span style="color: #ABB2BF">};</span></span></code></pre>
<h4 id="ã‚³ãƒ¼ãƒ‰ã®è§£èª¬-5">ã‚³ãƒ¼ãƒ‰ã®è§£èª¬</h4>
<p>apiã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ã‚‹éš›ã€ãƒ‡ãƒ¼ã‚¿ã®idãŒ1ã®ã‚‚ã®ã‚’å–å¾—ã™ã‚‹å ´åˆ
<strong><a href="http://localhost:3000/api/analysis/1">http://localhost:3000/api/analysis/1</a></strong>
ã“ã®ã‚ˆã†ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ã‚Šã¾ã™ã€‚
ãã®éƒ¨åˆ†ã®idã®ç•ªå·ã ã‘ãŒã»ã—ã„ã®ã§urlãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’splitã—ã¦idã‚’æŠœãå‡ºã—ã¾ã™ã€‚</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">id</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">number</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">parseInt</span><span style="color: #ABB2BF">(</span><span style="color: #E5C07B">req</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">url</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">split</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">"/analysis/"</span><span style="color: #ABB2BF">)[</span><span style="color: #D19A66">1</span><span style="color: #ABB2BF">]);</span></span></code></pre>
<p>findFirstã¯ä¸€ç•ªåˆã‚ã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¾ã™ã€‚(findUniqueã§ã‚‚å¯)</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">getAnalysisById</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">prismadb</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">analysis</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">findFirst</span><span style="color: #ABB2BF">({</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #E06C75">where</span><span style="color: #ABB2BF">: {</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #E06C75">id</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">      }</span></span>
<span class="line"><span style="color: #ABB2BF">    });</span></span></code></pre>
<p>idãŒãªã„æ™‚ã¯ã‚¨ãƒ©ãƒ¼ã‚’è¿”ã—ã¾ã™ã€‚</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #56B6C2">!</span><span style="color: #E06C75">id</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">NextResponse</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">json</span><span style="color: #ABB2BF">({ </span><span style="color: #E06C75">message</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">"Not Found"</span><span style="color: #ABB2BF"> }, { </span><span style="color: #E06C75">status</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">404</span><span style="color: #ABB2BF"> });</span></span>
<span class="line"><span style="color: #ABB2BF">    }</span></span></code></pre>
<h5 id="æŒ‡å®šã—ãŸidã®ãƒ‡ãƒ¼ã‚¿ã‚’æ›´æ–°">æŒ‡å®šã—ãŸidã®ãƒ‡ãƒ¼ã‚¿ã‚’æ›´æ–°</h5>
<p>æŒ‡å®šã—ãŸidã®ãƒ‡ãƒ¼ã‚¿ã®æ›´æ–°ã‚’ã—ã¾ã™ã€‚</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">export</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">PUT</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75; font-style: italic">req</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">Request</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">res</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">NextResponse</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">try</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">id</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">number</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">parseInt</span><span style="color: #ABB2BF">(</span><span style="color: #E5C07B">req</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">url</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">split</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">"/analysis/"</span><span style="color: #ABB2BF">)[</span><span style="color: #D19A66">1</span><span style="color: #ABB2BF">]);</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> { </span><span style="color: #E5C07B">text</span><span style="color: #ABB2BF"> } </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">req</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">json</span><span style="color: #ABB2BF">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">putAnalysis</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">prismadb</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">analysis</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">update</span><span style="color: #ABB2BF">({</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #E06C75">data</span><span style="color: #ABB2BF">: { </span><span style="color: #E06C75">text</span><span style="color: #ABB2BF"> },</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #E06C75">where</span><span style="color: #ABB2BF">: {</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #E06C75">id</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">      },</span></span>
<span class="line"><span style="color: #ABB2BF">    });</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">NextResponse</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">json</span><span style="color: #ABB2BF">({ </span><span style="color: #E06C75">message</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">"Success"</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">putAnalysis</span><span style="color: #ABB2BF"> }, { </span><span style="color: #E06C75">status</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">200</span><span style="color: #ABB2BF"> });</span></span>
<span class="line"><span style="color: #ABB2BF">  } </span><span style="color: #C678DD">catch</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75">err</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">NextResponse</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">json</span><span style="color: #ABB2BF">({ </span><span style="color: #E06C75">message</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">"Error"</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">err</span><span style="color: #ABB2BF"> }, { </span><span style="color: #E06C75">status</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">500</span><span style="color: #ABB2BF"> });</span></span>
<span class="line"><span style="color: #ABB2BF">  } </span><span style="color: #C678DD">finally</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">prismadb</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">$disconnect</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">  }</span></span>
<span class="line"><span style="color: #ABB2BF">};</span></span></code></pre>
<h4 id="ã‚³ãƒ¼ãƒ‰ã®è§£èª¬-6">ã‚³ãƒ¼ãƒ‰ã®è§£èª¬</h4>
<p>Postã¨ã»ã¨ã‚“ã©åŒã˜ã§ã™ãŒ
data: { text } ã“ã®ã‚ˆã†ã«dataã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’æ¸¡ã—ã¾ã™ã€‚</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">putAnalysis</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">prismadb</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">analysis</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">update</span><span style="color: #ABB2BF">({</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #E06C75">data</span><span style="color: #ABB2BF">: { </span><span style="color: #E06C75">text</span><span style="color: #ABB2BF"> },</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #E06C75">where</span><span style="color: #ABB2BF">: {</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #E06C75">id</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">      },</span></span>
<span class="line"><span style="color: #ABB2BF">    });</span></span></code></pre>
<h4 id="æŒ‡å®šã—ãŸidã®å‰Šé™¤">æŒ‡å®šã—ãŸIdã®å‰Šé™¤</h4>
<p>prismadb.analysis.deleteã¨ã™ã‚‹ã“ã¨ã§ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã§ãã¾ã™ã€‚</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">export</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">DELETE</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75; font-style: italic">req</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">Request</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">res</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">NextResponse</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">try</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">id</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">number</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">parseInt</span><span style="color: #ABB2BF">(</span><span style="color: #E5C07B">req</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">url</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">split</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">"/analysis/"</span><span style="color: #ABB2BF">)[</span><span style="color: #D19A66">1</span><span style="color: #ABB2BF">]);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">deleteAnalysis</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">prismadb</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">analysis</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">delete</span><span style="color: #ABB2BF">({</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #E06C75">where</span><span style="color: #ABB2BF">: { </span><span style="color: #E06C75">id</span><span style="color: #ABB2BF"> },</span></span>
<span class="line"><span style="color: #ABB2BF">    });</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">NextResponse</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">json</span><span style="color: #ABB2BF">({ </span><span style="color: #E06C75">message</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">"Success"</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">deleteAnalysis</span><span style="color: #ABB2BF"> }, { </span><span style="color: #E06C75">status</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">200</span><span style="color: #ABB2BF"> });</span></span>
<span class="line"><span style="color: #ABB2BF">  } </span><span style="color: #C678DD">catch</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75">err</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">NextResponse</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">json</span><span style="color: #ABB2BF">({ </span><span style="color: #E06C75">message</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">"Error"</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">err</span><span style="color: #ABB2BF"> }, { </span><span style="color: #E06C75">status</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">500</span><span style="color: #ABB2BF"> });</span></span>
<span class="line"><span style="color: #ABB2BF">  } </span><span style="color: #C678DD">finally</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">prismadb</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">$disconnect</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">  }</span></span>
<span class="line"><span style="color: #ABB2BF">};</span></span>
<span class="line"></span></code></pre>
<h4 id="æŒ‡å®šã—ãŸidã®æ„Ÿæƒ…åˆ†æçµæœã®æ›´æ–°">æŒ‡å®šã—ãŸIdã®æ„Ÿæƒ…åˆ†æçµæœã®æ›´æ–°</h4>
<p>æ„Ÿæƒ…åˆ†æã®çµæœã‚‚ãƒ†ã‚­ã‚¹ãƒˆã®æ›´æ–°ãŒã‚ã£ãŸéš›ã«ã€æ›´æ–°ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚</p>
<h5 id="ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®è¿½åŠ ">ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®è¿½åŠ </h5>
<p>openai/[id]/route.ts</p>
<p>å…ˆã»ã©ã¨é•ã†ã®ã¯ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã«emotionã‚’æŒ‡å®šã—ã¦ã„ã‚‹ã ã‘ã§ã™ã€‚
ã“ã†ã™ã‚‹ã“ã¨ã§emotionã®ãƒ‡ãƒ¼ã‚¿ã‚’æ›´æ–°ã§ãã¾ã™ã€‚</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">NextResponse</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"next/server"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">prismadb</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"@/app/libs/prismadb"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">auth</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"@clerk/nextjs"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">export</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">PUT</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75; font-style: italic">req</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">Request</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">res</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">NextResponse</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">try</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> { </span><span style="color: #E5C07B">userId</span><span style="color: #ABB2BF"> } </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">auth</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">id</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">number</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">parseInt</span><span style="color: #ABB2BF">(</span><span style="color: #E5C07B">req</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">url</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">split</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">"/openai/"</span><span style="color: #ABB2BF">)[</span><span style="color: #D19A66">1</span><span style="color: #ABB2BF">]);</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> { </span><span style="color: #E5C07B">emotion</span><span style="color: #ABB2BF"> } </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">req</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">json</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #56B6C2">!</span><span style="color: #E06C75">userId</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">new</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">NextResponse</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">"Unauthorized"</span><span style="color: #ABB2BF">, { </span><span style="color: #E06C75">status</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">401</span><span style="color: #ABB2BF"> });</span></span>
<span class="line"><span style="color: #ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">putEmotion</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">prismadb</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">analysis</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">update</span><span style="color: #ABB2BF">({</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #E06C75">data</span><span style="color: #ABB2BF">: { </span><span style="color: #E06C75">emotion</span><span style="color: #ABB2BF"> },</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #E06C75">where</span><span style="color: #ABB2BF">: {</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #E06C75">id</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">      },</span></span>
<span class="line"><span style="color: #ABB2BF">    });</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">NextResponse</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">json</span><span style="color: #ABB2BF">({ </span><span style="color: #E06C75">message</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">"Success"</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">putEmotion</span><span style="color: #ABB2BF"> }, { </span><span style="color: #E06C75">status</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">200</span><span style="color: #ABB2BF"> });</span></span>
<span class="line"><span style="color: #ABB2BF">  } </span><span style="color: #C678DD">catch</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75">err</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">NextResponse</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">json</span><span style="color: #ABB2BF">({ </span><span style="color: #E06C75">message</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">"Error"</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">err</span><span style="color: #ABB2BF"> }, { </span><span style="color: #E06C75">status</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">500</span><span style="color: #ABB2BF"> });</span></span>
<span class="line"><span style="color: #ABB2BF">  } </span><span style="color: #C678DD">finally</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">prismadb</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">$disconnect</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">  }</span></span>
<span class="line"><span style="color: #ABB2BF">};</span></span></code></pre>
<p>ã“ã‚Œã§apiã®ä½œæˆã¯å®Œäº†ã—ã¾ã—ãŸã€‚</p>
<br>
<br>
<h2 id="æŠ•ç¨¿ãƒœã‚¿ãƒ³ä½œæˆ">æŠ•ç¨¿ãƒœã‚¿ãƒ³ä½œæˆ</h2>
<h5 id="apiãƒ‡ãƒ¼ã‚¿ã‚’ãƒ•ã‚§ãƒƒãƒã™ã‚‹ãŸã‚ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«">apiãƒ‡ãƒ¼ã‚¿ã‚’ãƒ•ã‚§ãƒƒãƒã™ã‚‹ãŸã‚ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</h5>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #61AFEF">nom</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">i</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">axios</span></span></code></pre>
<h5 id="çŠ¶æ…‹ç®¡ç†ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«">çŠ¶æ…‹ç®¡ç†ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</h5>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #61AFEF">npm</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">i</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">zustand</span></span></code></pre>
<h5 id="ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆä½œæˆ">ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆä½œæˆ</h5>
<p>ãƒœã‚¿ãƒ³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
app/components/PostButton/index.tsx
apiãƒ•ã‚§ãƒƒãƒã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
app/hooks/useGetAllText.ts</p>
<h5 id="å…¨ã¦ã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—-1">å…¨ã¦ã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—</h5>
<p>zustandã¨ã„ã†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§çŠ¶æ…‹ç®¡ç†ã‚’ã—ã¦ã„ã¾ã™ã€‚
çŠ¶æ…‹ç®¡ç†ã«ã¯ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒ†ãƒ¼ãƒˆã¨ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¹ãƒ†ãƒ¼ãƒˆãŒã‚ã‚Šã¾ã™ã€‚
:::details ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒ†ãƒ¼ãƒˆ
ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ä¸­ã ã‘ä½¿ã†ã‚¹ãƒ†ãƒ¼ãƒˆã‚’ç®¡ç†
React Hooksã®useStateã‚„useReducerãªã©
:::
:::details ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¹ãƒ†ãƒ¼ãƒˆ
è¤‡æ•°ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§å…±æœ‰ã•ã‚Œã‚‹ãƒ‡ãƒ¼ã‚¿ã®ã‚¹ãƒ†ãƒ¼ãƒˆã‚’ç®¡ç†
React Hooksï¼šuseContext
å¤–éƒ¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼šReduxã€Recoilãªã©
:::
Getã™ã‚‹ãƒ†ã‚­ã‚¹ãƒˆã¯è‰²ã€…ä½¿ã„å›ã™ã®ã§ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¹ãƒ†ãƒ¼ãƒˆã§ç®¡ç†ã—ã¾ã™ã€‚</p>
<p>app/hooks/useGetAllText.ts</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">create</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"zustand"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">axios</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"axios"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">useGetAllText</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">create</span><span style="color: #ABB2BF">((</span><span style="color: #E06C75; font-style: italic">set</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> ({</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">data</span><span style="color: #ABB2BF">: [],</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">loading</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">false</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">hasErrors</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">false</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #61AFEF">fetch</span><span style="color: #ABB2BF">: </span><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> () </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #61AFEF">set</span><span style="color: #ABB2BF">(() </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> ({ </span><span style="color: #E06C75">loading</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">true</span><span style="color: #ABB2BF"> }));</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">try</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">response</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">axios</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">get</span><span style="color: #ABB2BF">(</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #98C379">"/api/analysis"</span></span>
<span class="line"><span style="color: #ABB2BF">      );</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #61AFEF">set</span><span style="color: #ABB2BF">((</span><span style="color: #E06C75; font-style: italic">state</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">any</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> ({</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #E06C75">data</span><span style="color: #ABB2BF">: (</span><span style="color: #E5C07B">state</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">data</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">response</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">data</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">getAllText</span><span style="color: #ABB2BF">),</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #E06C75">loading</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">false</span></span>
<span class="line"><span style="color: #ABB2BF">      }));</span></span>
<span class="line"><span style="color: #ABB2BF">    } </span><span style="color: #C678DD">catch</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75">err</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #61AFEF">set</span><span style="color: #ABB2BF">(() </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> ({ </span><span style="color: #E06C75">hasErrors</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">true</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">loading</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">false</span><span style="color: #ABB2BF"> }));</span></span>
<span class="line"><span style="color: #ABB2BF">    }</span></span>
<span class="line"><span style="color: #ABB2BF">  },</span></span>
<span class="line"><span style="color: #ABB2BF">}));</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">export</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">default</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">useGetAllText</span><span style="color: #ABB2BF">;</span></span></code></pre>
<p>ã€€##### ã‚³ãƒ¼ãƒ‰ã®è§£èª¬</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #E06C75">data</span><span style="color: #ABB2BF">: [], </span><span style="color: #7F848E; font-style: italic">//ãƒ†ã‚­ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’æ ¼ç´ã™ã‚‹ãŸã‚ã®é…åˆ—ã‚’åˆæœŸåŒ–</span></span>
<span class="line"><span style="color: #E06C75">loading</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">false</span><span style="color: #ABB2BF">, </span><span style="color: #7F848E; font-style: italic">//ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ä¸­ã‹ã©ã†ã‹ã‚’è¡¨ã™ãŸã‚ã®çœŸå½å€¤ã‚’åˆæœŸåŒ–</span></span>
<span class="line"><span style="color: #E06C75">hasErrors</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">false</span><span style="color: #ABB2BF">, </span><span style="color: #7F848E; font-style: italic">//ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸã‹ã©ã†ã‹ã‚’è¡¨ã™ãŸã‚ã®çœŸå½å€¤ã‚’åˆæœŸåŒ–</span></span>
<span class="line"><span style="color: #E06C75">fetch</span><span style="color: #ABB2BF">: </span><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> () </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {...}, </span><span style="color: #7F848E; font-style: italic">//ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã‚’è¡Œã†ãŸã‚ã®éåŒæœŸé–¢æ•°ã‚’å®šç¾©</span></span>
<span class="line"><span style="color: #61AFEF">set</span><span style="color: #ABB2BF">(() </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> ({ </span><span style="color: #E06C75">loading</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">true</span><span style="color: #ABB2BF"> })); </span><span style="color: #7F848E; font-style: italic">//loadingã®å€¤ã‚’trueã«å¤‰æ›´ã™ã‚‹ã“ã¨ã§ã€ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã‚’é–‹å§‹</span></span>
<span class="line"></span>
<span class="line"><span style="color: #61AFEF">set</span><span style="color: #ABB2BF">((</span><span style="color: #E06C75; font-style: italic">state</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">any</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> ({ </span><span style="color: #E06C75">data</span><span style="color: #ABB2BF">: (</span><span style="color: #E5C07B">state</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">data</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">response</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">data</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">getAllText</span><span style="color: #ABB2BF">), </span><span style="color: #E06C75">loading</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">false</span><span style="color: #ABB2BF"> })); </span><span style="color: #7F848E; font-style: italic">//ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‹ã‚‰ãƒ†ã‚­ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’å–ã‚Šå‡ºã—ã¦dataã«ä»£å…¥ã—ã€loadingã®å€¤ã‚’falseã«å¤‰æ›´ã™ã‚‹ã“ã¨ã§ã€ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ãŒå®Œäº†ã—ãŸã“ã¨ã‚’è¡¨ã€‚stateã¯ç¾åœ¨ã®çŠ¶æ…‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¡¨ã™</span></span>
<span class="line"><span style="color: #61AFEF">set</span><span style="color: #ABB2BF">(() </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> ({ </span><span style="color: #E06C75">hasErrors</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">true</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">loading</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">false</span><span style="color: #ABB2BF"> })); </span><span style="color: #7F848E; font-style: italic">//hasErrorsã®å€¤ã‚’trueã«å¤‰æ›´ã—ã€loadingã®å€¤ã‚’falseã«å¤‰æ›´ã™ã‚‹ã“ã¨ã§ã€ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸã“ã¨ã‚’è¡¨ã™</span></span></code></pre>
<h4 id="postãƒœã‚¿ãƒ³ã‚’ä½œæˆ">Postãƒœã‚¿ãƒ³ã‚’ä½œæˆ</h4>
<p>app/components/PostButton/index.tsx</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">MdPlaylistAdd</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"react-icons/md"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">axios</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"axios"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">toast</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"react-hot-toast"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">useGetAllText</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"@/app/hooks/useGetAllText"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">export</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">CreateNaisei</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> () </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> { </span><span style="color: #E5C07B">fetch</span><span style="color: #ABB2BF"> }: </span><span style="color: #E5C07B">any</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">useGetAllText</span><span style="color: #ABB2BF">()</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">defaultValue</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'{"root":{"children":[{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"example.","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1}],"direction":"ltr","format":"","indent":0,"type":"root","version":1}}'</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">onCreate</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75; font-style: italic">e</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">React</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">FormEvent</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E5C07B">e</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">preventDefault</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">apiUrl</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"/api/naisei"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">createData</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #7F848E; font-style: italic">// ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£ã«é€ä¿¡ã™ã‚‹ãƒ‡ãƒ¼ã‚¿</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #E06C75">text</span><span style="color: #ABB2BF">: </span><span style="color: #E06C75">defaultValue</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">    };</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">axios</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">post</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">apiUrl</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">createData</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">      .</span><span style="color: #61AFEF">then</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">response</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #E5C07B">toast</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">success</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'Created Naisei!!'</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #61AFEF">fetch</span><span style="color: #ABB2BF">()</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">"/editorã§ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ•ã‚§ãƒƒãƒ"</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">response</span></span>
<span class="line"><span style="color: #ABB2BF">      })</span></span>
<span class="line"><span style="color: #ABB2BF">      .</span><span style="color: #61AFEF">catch</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">error</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">error</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'Error fetching data:'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">error</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">      });</span></span>
<span class="line"><span style="color: #ABB2BF">  }</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> (</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    &#x3C;></span></span>
<span class="line"><span style="color: #ABB2BF">      &#x3C;</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">className</span><span style="color: #56B6C2">=</span><span style="color: #98C379">"max-w-2xl mx-auto text-end focus:outline-none"</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">        &#x3C;</span><span style="color: #E06C75">button</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">onClick</span><span style="color: #56B6C2">=</span><span style="color: #C678DD">{</span><span style="color: #E06C75">onCreate</span><span style="color: #C678DD">}</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">className</span><span style="color: #56B6C2">=</span><span style="color: #98C379">"border-none mr-8 cursor-pointer rounded-full hover:text-blue-600 bg-white"</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">          &#x3C;</span><span style="color: #E5C07B">MdPlaylistAdd</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">size</span><span style="color: #56B6C2">=</span><span style="color: #C678DD">{</span><span style="color: #D19A66">48</span><span style="color: #C678DD">}</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">color</span><span style="color: #56B6C2">=</span><span style="color: #98C379">""</span><span style="color: #ABB2BF"> /></span></span>
<span class="line"><span style="color: #ABB2BF">        &#x3C;/</span><span style="color: #E06C75">button</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">      &#x3C;/</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">    &#x3C;/></span></span>
<span class="line"><span style="color: #ABB2BF">  )</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span>
<span class="line"></span></code></pre>
<h4 id="ã‚³ãƒ¼ãƒ‰ã‚’è§£èª¬-1">ã‚³ãƒ¼ãƒ‰ã‚’è§£èª¬</h4>
<p>onCreateã§ä½œæˆãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã™ã¨æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ãŒä½œæˆã•ã‚Œã¾ã™ã€‚(Prismaã‚’é€šã—ã¦SUpabaseã«ä¿å­˜ã•ã‚Œã¾ã™ï¼‰
è¡¨ç¤ºç”»é¢ã«ã¯æ–°ã—ã„Postã®ãƒ‡ãƒ¼ã‚¿ãŒåæ˜ ã•ã‚Œã¦ãªã„ã®ã§ãƒ‡ãƒ¼ã‚¿ã‚’å†åº¦ãƒ•ã‚§ãƒƒãƒã—ã¾ã™ã€‚</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> { </span><span style="color: #E5C07B">fetch</span><span style="color: #ABB2BF"> }: </span><span style="color: #E5C07B">any</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">useGetAllText</span><span style="color: #ABB2BF">() </span><span style="color: #7F848E; font-style: italic">//å…¨ã¦ã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—</span></span>
<span class="line"><span style="color: #ABB2BF"> </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">defaultValue</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'{...}'</span><span style="color: #ABB2BF"> </span><span style="color: #7F848E; font-style: italic">// ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ãƒ‡ãƒ¼ã‚¿</span></span>
<span class="line"><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">axios</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">post</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">apiUrl</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">createData</span><span style="color: #ABB2BF">) </span><span style="color: #7F848E; font-style: italic">//ã“ã®ã‚ˆã†ã«ã—ã¦apiã—ã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ã‚‹ã“ã¨ãŒã§ãã¾ã™</span></span></code></pre>
<h3 id="ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚§ãƒƒãƒ">ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚§ãƒƒãƒ</h3>
<p>ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚µã‚¤ãƒˆãƒšãƒ¼ã‚¸ã«è¨ªã‚ŒãŸæ™‚ã«ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ•ã‚§ãƒƒãƒã—ã¾ã™ã€‚
ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚§ãƒƒãƒã¯å…±é€šã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãªã®ã§layout.tsxã§è¡Œã„ã¾ã™ã€‚</p>
<p>ã¾ãšã¯ã€ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚§ãƒƒãƒã‚’ã™ã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½œã‚Šã¾ã™ã€‚
app/components/DataFetch/index.tsx</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color: #98C379">"use client"</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">useGetAllText</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"@/app/hooks/useGetAllText"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">useEffect</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"react"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">export</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">DataFetch</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> () </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> { </span><span style="color: #E5C07B">fetch</span><span style="color: #ABB2BF"> }: </span><span style="color: #E5C07B">any</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">useGetAllText</span><span style="color: #ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #61AFEF">useEffect</span><span style="color: #ABB2BF">(() </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #61AFEF">fetch</span><span style="color: #ABB2BF">()</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">"/editorã§ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ•ã‚§ãƒƒãƒ"</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  }, [</span><span style="color: #E06C75">fetch</span><span style="color: #ABB2BF">])</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> (</span></span>
<span class="line"><span style="color: #ABB2BF">    &#x3C;></span></span>
<span class="line"><span style="color: #ABB2BF">    &#x3C;/></span></span>
<span class="line"><span style="color: #ABB2BF">  )</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span></code></pre>
<h4 id="ã‚µã‚¤ãƒˆã«è¿½åŠ ã—ã¾ã™">ã‚µã‚¤ãƒˆã«è¿½åŠ ã—ã¾ã™ã€‚</h4>
<p>app/(site)/layout.tsx</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"./styles.css"</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">NavBar</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"../components/Navbar/site-navbar"</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">DataFetch</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"../components/DataFetch"</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">SiteLayout</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> ({</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">children</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">}: {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">children</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">React</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">ReactNode</span></span>
<span class="line"><span style="color: #ABB2BF">}) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> (</span></span>
<span class="line"><span style="color: #ABB2BF">    &#x3C;</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">      &#x3C;</span><span style="color: #E5C07B">NavBar</span><span style="color: #ABB2BF"> /></span></span>
<span class="line"><span style="color: #ABB2BF">      &#x3C;</span><span style="color: #E5C07B">DataFetch</span><span style="color: #ABB2BF"> /></span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #C678DD">{</span><span style="color: #E06C75">children</span><span style="color: #C678DD">}</span></span>
<span class="line"><span style="color: #ABB2BF">    &#x3C;/</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">  )</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">export</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">default</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">SiteLayout</span></span></code></pre>
<p>ãƒ­ã‚°ã‚¤ãƒ³ã—ãŸéš›ã«ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚</p>
<br>
<br>
<h3 id="ãƒ†ã‚­ã‚¹ãƒˆidã‚’ç®¡ç†ã™ã‚‹ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯">ãƒ†ã‚­ã‚¹ãƒˆidã‚’ç®¡ç†ã™ã‚‹ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯</h3>
<p>ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒ‡ã‚£ã‚¿ã«ã¯1ã¤ã®Postã‚’è¡¨ç¤ºã•ã›ãŸã„ã®ã§idã‚’ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¹ãƒ†ãƒ¼ãƒˆã§ç®¡ç†ã—ã¾ã™ã€‚
app/hooks/useGetTextById.ts</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">create</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"zustand"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">interface</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">TextStore</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">analysisId</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">[];</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">selectedId</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF"> | null;</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #61AFEF">setAnalysisId</span><span style="color: #ABB2BF">: (</span><span style="color: #E06C75; font-style: italic">naiseiId</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">any</span><span style="color: #ABB2BF">[]) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">void</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #61AFEF">setSelectedId</span><span style="color: #ABB2BF">: (</span><span style="color: #E06C75; font-style: italic">naiseiId</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">any</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">void</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">export</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">useGetTextById</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">create</span><span style="color: #ABB2BF">&#x3C;</span><span style="color: #E5C07B">TextStore</span><span style="color: #ABB2BF">>((</span><span style="color: #E06C75; font-style: italic">set</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> ({</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">analysisId</span><span style="color: #ABB2BF">: [</span><span style="color: #98C379">""</span><span style="color: #ABB2BF">],</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">selectedId</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">null</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #61AFEF">setAnalysisId</span><span style="color: #ABB2BF">: (</span><span style="color: #E06C75; font-style: italic">analysisId</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">set</span><span style="color: #ABB2BF">({ </span><span style="color: #E06C75">analysisId</span><span style="color: #ABB2BF"> }),</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #61AFEF">setSelectedId</span><span style="color: #ABB2BF">: (</span><span style="color: #E06C75; font-style: italic">analysisId</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">set</span><span style="color: #ABB2BF">({ </span><span style="color: #E06C75">selectedId</span><span style="color: #ABB2BF">: </span><span style="color: #E06C75">analysisId</span><span style="color: #ABB2BF"> }),</span></span>
<span class="line"><span style="color: #ABB2BF">}));</span></span></code></pre>
<h3 id="è¡¨ç¤ºã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯">è¡¨ç¤ºã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯</h3>
<p>ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒ‡ã‚£ã‚¿ã«å…¥åŠ›ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹ãŸã‚ã®ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¹ãƒ†ãƒ¼ãƒˆã§ã™ã€‚
app/hooks/useRefresh.ts</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">create</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'zustand'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">type</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">RefreshStore</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">refresh</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">boolean</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #61AFEF">toggleRefresh</span><span style="color: #ABB2BF">: () </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">void</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">useRefresh</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">create</span><span style="color: #ABB2BF">&#x3C;</span><span style="color: #E5C07B">RefreshStore</span><span style="color: #ABB2BF">>((</span><span style="color: #E06C75; font-style: italic">set</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> ({</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">refresh</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">false</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #61AFEF">toggleRefresh</span><span style="color: #ABB2BF">: () </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">set</span><span style="color: #ABB2BF">((</span><span style="color: #E06C75; font-style: italic">state</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> ({ </span><span style="color: #E06C75">refresh</span><span style="color: #ABB2BF">: </span><span style="color: #56B6C2">!</span><span style="color: #E5C07B">state</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">refresh</span><span style="color: #ABB2BF"> })),</span></span>
<span class="line"><span style="color: #ABB2BF">}));</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">export</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">default</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">useRefresh</span><span style="color: #ABB2BF">;</span></span></code></pre>
<h3 id="ãƒãƒ¼ãƒˆãƒšãƒ¼ã‚¸ã®è¡¨ç¤ºãƒ­ã‚¸ãƒƒã‚¯">ãƒãƒ¼ãƒˆãƒšãƒ¼ã‚¸ã®è¡¨ç¤ºãƒ­ã‚¸ãƒƒã‚¯</h3>
<p>app/components/Note/index.tsx</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #98C379">"use client"</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">useEffect</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">useState</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"react"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">useRefresh</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"@/app/hooks/useRefresh"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">useGetAllText</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"@/app/hooks/useGetAllText"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">useGetTextById</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"@/app/hooks/useGetTextById"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">export</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">Note</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> () </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> [</span><span style="color: #E5C07B">text</span><span style="color: #ABB2BF">, </span><span style="color: #E5C07B">setText</span><span style="color: #ABB2BF">] </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">useState</span><span style="color: #ABB2BF">([])</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> { </span><span style="color: #E5C07B">toggleRefresh</span><span style="color: #ABB2BF"> } </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">useRefresh</span><span style="color: #ABB2BF">()</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> { </span><span style="color: #E5C07B">data</span><span style="color: #ABB2BF">, </span><span style="color: #E5C07B">loading</span><span style="color: #ABB2BF"> }: </span><span style="color: #E5C07B">any</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">useGetAllText</span><span style="color: #ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #61AFEF">useEffect</span><span style="color: #ABB2BF">(() </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">resText</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">data</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">map</span><span style="color: #ABB2BF">((</span><span style="color: #E06C75; font-style: italic">item</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">any</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">item</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">text</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">newArray</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">resText</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">map</span><span style="color: #ABB2BF">((</span><span style="color: #E06C75; font-style: italic">item</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">any</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">parsedItem</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">JSON</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">parse</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">item</span><span style="color: #ABB2BF">); </span><span style="color: #7F848E; font-style: italic">// JSONæ–‡å­—åˆ—ã‚’JavaScriptã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¤‰æ›</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">parsedItem</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">root</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">children</span><span style="color: #ABB2BF">[</span><span style="color: #D19A66">0</span><span style="color: #ABB2BF">].</span><span style="color: #E06C75">children</span><span style="color: #ABB2BF">[</span><span style="color: #D19A66">0</span><span style="color: #ABB2BF">].</span><span style="color: #E06C75">text</span><span style="color: #ABB2BF">; </span><span style="color: #7F848E; font-style: italic">// textã®å€¤ã‚’æŠ½å‡º</span></span>
<span class="line"><span style="color: #ABB2BF">    });</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">processData</span><span style="color: #ABB2BF">() {</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">replacedData</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">any</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> [];</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #C678DD">for</span><span style="color: #ABB2BF"> (</span><span style="color: #C678DD">let</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">i</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">0</span><span style="color: #ABB2BF">; </span><span style="color: #E06C75">i</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">&#x3C;</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">data</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">length</span><span style="color: #ABB2BF">; </span><span style="color: #E06C75">i</span><span style="color: #56B6C2">++</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">item</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> { ...</span><span style="color: #E06C75">data</span><span style="color: #ABB2BF">[</span><span style="color: #E06C75">i</span><span style="color: #ABB2BF">] };</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #C678DD">try</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">          </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">textObj</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">JSON</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">parse</span><span style="color: #ABB2BF">(</span><span style="color: #E5C07B">item</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">text</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">          </span><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #E5C07B">textObj</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">root</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">&#x26;&#x26;</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">textObj</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">root</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">children</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">&#x26;&#x26;</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">textObj</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">root</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">children</span><span style="color: #ABB2BF">[</span><span style="color: #D19A66">0</span><span style="color: #ABB2BF">] </span><span style="color: #56B6C2">&#x26;&#x26;</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">textObj</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">root</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">children</span><span style="color: #ABB2BF">[</span><span style="color: #D19A66">0</span><span style="color: #ABB2BF">].</span><span style="color: #E06C75">children</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">            </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">textValue</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">textObj</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">root</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">children</span><span style="color: #ABB2BF">[</span><span style="color: #D19A66">0</span><span style="color: #ABB2BF">].</span><span style="color: #E06C75">children</span><span style="color: #ABB2BF">[</span><span style="color: #D19A66">0</span><span style="color: #ABB2BF">].</span><span style="color: #E06C75">text</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">            </span><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75">textValue</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">===</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">newArray</span><span style="color: #ABB2BF">[</span><span style="color: #E06C75">i</span><span style="color: #ABB2BF">]) {</span></span>
<span class="line"><span style="color: #ABB2BF">              </span><span style="color: #E5C07B">item</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">text</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">newArray</span><span style="color: #ABB2BF">[</span><span style="color: #E06C75">i</span><span style="color: #ABB2BF">];</span></span>
<span class="line"><span style="color: #ABB2BF">            }</span></span>
<span class="line"><span style="color: #ABB2BF">          }</span></span>
<span class="line"><span style="color: #ABB2BF">        } </span><span style="color: #C678DD">catch</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75">error</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">          </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">error</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">"Error parsing JSON:"</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">error</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">        }</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #E5C07B">replacedData</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">push</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">item</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">      }</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">newCreatedAt</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">replacedData</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">map</span><span style="color: #ABB2BF">((</span><span style="color: #E06C75; font-style: italic">item</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">any</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">          </span><span style="color: #E06C75">id</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">item</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">id</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">          </span><span style="color: #E06C75">text</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">item</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">text</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">          </span><span style="color: #E06C75">created_at</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">item</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">created_at</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">split</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'T'</span><span style="color: #ABB2BF">)[</span><span style="color: #D19A66">0</span><span style="color: #ABB2BF">] </span><span style="color: #7F848E; font-style: italic">// æ—¥ä»˜éƒ¨åˆ†ã ã‘ã‚’å–å¾—</span></span>
<span class="line"><span style="color: #ABB2BF">        };</span></span>
<span class="line"><span style="color: #ABB2BF">      });</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #E5C07B">newCreatedAt</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">sort</span><span style="color: #ABB2BF">((</span><span style="color: #E06C75; font-style: italic">a</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">any</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">b</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">any</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">b</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">id</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">-</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">a</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">id</span><span style="color: #ABB2BF">); </span><span style="color: #7F848E; font-style: italic">//æ—¥ä»˜ã‚’é™é †ã«ãªã‚‰ã¹æ›¿ãˆ</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #61AFEF">setText</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">newCreatedAt</span><span style="color: #ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    }</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #61AFEF">processData</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">  }, [</span><span style="color: #E06C75">data</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">setText</span><span style="color: #ABB2BF">])</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">handleItemClick</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75; font-style: italic">textId</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">number</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E5C07B">useGetTextById</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">getState</span><span style="color: #ABB2BF">().</span><span style="color: #61AFEF">setSelectedId</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">textId</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #61AFEF">toggleRefresh</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">let</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">timeoutId</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">setTimeout</span><span style="color: #ABB2BF">(() </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #7F848E; font-style: italic">// Editorã®stateã‚’æ›´æ–°</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #61AFEF">toggleRefresh</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">    }, </span><span style="color: #D19A66">100</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> () </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #61AFEF">clearTimeout</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">timeoutId</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">    }</span></span>
<span class="line"><span style="color: #ABB2BF">  };</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> (</span></span>
<span class="line"><span style="color: #ABB2BF">    &#x3C;</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">className</span><span style="color: #56B6C2">=</span><span style="color: #98C379">"flex justify-center mx-4"</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">      &#x3C;</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">className</span><span style="color: #56B6C2">=</span><span style="color: #98C379">"max-w-2xl"</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #C678DD">{</span><span style="color: #56B6C2">!</span><span style="color: #E06C75">loading</span></span>
<span class="line"><span style="color: #ABB2BF">          </span><span style="color: #C678DD">?</span></span>
<span class="line"><span style="color: #ABB2BF">          &#x3C;></span></span>
<span class="line"><span style="color: #ABB2BF">            </span><span style="color: #C678DD">{</span><span style="color: #E5C07B">text</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">map</span><span style="color: #ABB2BF">((</span><span style="color: #E06C75; font-style: italic">item</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">any</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> (</span></span>
<span class="line"><span style="color: #ABB2BF">              &#x3C;</span><span style="color: #E06C75">div</span></span>
<span class="line"><span style="color: #ABB2BF">                </span><span style="color: #D19A66; font-style: italic">key</span><span style="color: #56B6C2">=</span><span style="color: #C678DD">{</span><span style="color: #E5C07B">item</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">id</span><span style="color: #C678DD">}</span></span>
<span class="line"><span style="color: #ABB2BF">                </span><span style="color: #D19A66; font-style: italic">onClick</span><span style="color: #56B6C2">=</span><span style="color: #C678DD">{</span><span style="color: #ABB2BF">() </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">handleItemClick</span><span style="color: #ABB2BF">(</span><span style="color: #E5C07B">item</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">id</span><span style="color: #ABB2BF">)</span><span style="color: #C678DD">}</span></span>
<span class="line"><span style="color: #ABB2BF">                </span><span style="color: #D19A66; font-style: italic">className</span><span style="color: #56B6C2">=</span><span style="color: #98C379">"my-2 rounded-md cursor-pointer px-2"</span></span>
<span class="line"><span style="color: #ABB2BF">              ></span></span>
<span class="line"><span style="color: #ABB2BF">                &#x3C;</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">className</span><span style="color: #56B6C2">=</span><span style="color: #98C379">"text-start text-3xl break-words whitespace-pre-wrap"</span><span style="color: #ABB2BF">></span><span style="color: #C678DD">{</span><span style="color: #E5C07B">item</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">text</span><span style="color: #C678DD">}</span><span style="color: #ABB2BF">&#x3C;/</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">                &#x3C;</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">className</span><span style="color: #56B6C2">=</span><span style="color: #98C379">"text-slate-400 text-end"</span><span style="color: #ABB2BF">></span><span style="color: #C678DD">{</span><span style="color: #E5C07B">item</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">created_at</span><span style="color: #C678DD">}</span><span style="color: #ABB2BF">&#x3C;/</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">              &#x3C;/</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">            )</span></span>
<span class="line"><span style="color: #ABB2BF">            )</span><span style="color: #C678DD">}</span></span>
<span class="line"><span style="color: #ABB2BF">            </span><span style="color: #C678DD">{</span><span style="color: #E5C07B">text</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">length</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">&#x3C;=</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">0</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">&#x26;&#x26;</span><span style="color: #ABB2BF"> &#x3C;</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">className</span><span style="color: #56B6C2">=</span><span style="color: #98C379">"text-lg"</span><span style="color: #ABB2BF">>Make a post now!&#x3C;/</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">></span><span style="color: #C678DD">}</span></span>
<span class="line"><span style="color: #ABB2BF">          &#x3C;/></span></span>
<span class="line"><span style="color: #ABB2BF">          </span><span style="color: #C678DD">:</span></span>
<span class="line"><span style="color: #ABB2BF">          &#x3C;</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">>loading.....&#x3C;/</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #C678DD">}</span></span>
<span class="line"><span style="color: #ABB2BF">      &#x3C;/</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">    &#x3C;/</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">  )</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span></code></pre>
<h4 id="ã‚³ãƒ¼ãƒ‰ã‚’è§£èª¬-2">ã‚³ãƒ¼ãƒ‰ã‚’è§£èª¬</h4>
<p>useEffectã®ä¸­ã§ã¯ãƒ‡ãƒ¼ã‚¿ã®æ•´å½¢ã‚’ã—ã¦ã„ã¾ã™ã€‚
:::details å…·ä½“çš„ã«ã©ã‚“ãªæ•´å½¢ã‚’ã—ã¦ã‚‹ã‹
ãƒ†ã‚­ã‚¹ãƒˆ
æ•´å½¢å‰:â€™{â€œrootâ€:{â€œchildrenâ€:[{â€œchildrenâ€:[{â€œdetailâ€:0,â€œformatâ€:0,â€œmodeâ€:â€œnormalâ€,â€œstyleâ€:"",â€œtextâ€:â€œexample.â€,â€œtypeâ€:â€œtextâ€,â€œversionâ€:1}],â€œdirectionâ€:â€œltrâ€,â€œformatâ€:"",â€œindentâ€:0,â€œtypeâ€:â€œparagraphâ€,â€œversionâ€:1}],â€œdirectionâ€:â€œltrâ€,â€œformatâ€:"",â€œindentâ€:0,â€œtypeâ€:â€œrootâ€,â€œversionâ€:1}}â€™
æ•´å½¢å¾Œ: â€™<strong>example.</strong>â€™</p>
<p>ä½œæˆæ—¥
æ•´å½¢å‰: 2023-09-30T01:23:45
æ•´å½¢å¾Œ: <strong>2023-09-30</strong>
:::</p>
<h4 id="textã®ä¸€ç•ªåˆã‚ã®è¡Œã®ãƒ†ã‚­ã‚¹ãƒˆã ã‘ã‚’å–å¾—">textã®ä¸€ç•ªåˆã‚ã®è¡Œã®ãƒ†ã‚­ã‚¹ãƒˆã ã‘ã‚’å–å¾—</h4>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">resText</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">data</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">map</span><span style="color: #ABB2BF">((</span><span style="color: #E06C75; font-style: italic">item</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">any</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">item</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">text</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">newArray</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">resText</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">map</span><span style="color: #ABB2BF">((</span><span style="color: #E06C75; font-style: italic">item</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">any</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">parsedItem</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">JSON</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">parse</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">item</span><span style="color: #ABB2BF">); </span><span style="color: #7F848E; font-style: italic">// JSONæ–‡å­—åˆ—ã‚’JavaScriptã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¤‰æ›</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">parsedItem</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">root</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">children</span><span style="color: #ABB2BF">[</span><span style="color: #D19A66">0</span><span style="color: #ABB2BF">].</span><span style="color: #E06C75">children</span><span style="color: #ABB2BF">[</span><span style="color: #D19A66">0</span><span style="color: #ABB2BF">].</span><span style="color: #E06C75">text</span><span style="color: #ABB2BF">; </span><span style="color: #7F848E; font-style: italic">// textã®å€¤ã‚’æŠ½å‡º</span></span>
<span class="line"><span style="color: #ABB2BF">    });</span></span></code></pre>
<h4 id="processdataã¯å–å¾—ã—ãŸãƒ†ã‚­ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®textã®ä¸€ç•ªåˆã‚ã®è¡Œã®ãƒ†ã‚­ã‚¹ãƒˆã¨jsonå½¢å¼ã®ãƒ†ã‚­ã‚¹ãƒˆãŒä¸€è‡´ã™ã‚‹ã‹æ¤œè¨¼ã™ã‚‹">processData()ã¯å–å¾—ã—ãŸãƒ†ã‚­ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®textã®ä¸€ç•ªåˆã‚ã®è¡Œã®ãƒ†ã‚­ã‚¹ãƒˆã¨JSONå½¢å¼ã®ãƒ†ã‚­ã‚¹ãƒˆãŒä¸€è‡´ã™ã‚‹ã‹æ¤œè¨¼ã™ã‚‹</h4>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">processData</span><span style="color: #ABB2BF">() {</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">replacedData</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">any</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> [];</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #C678DD">for</span><span style="color: #ABB2BF"> (</span><span style="color: #C678DD">let</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">i</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">0</span><span style="color: #ABB2BF">; </span><span style="color: #E06C75">i</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">&#x3C;</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">data</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">length</span><span style="color: #ABB2BF">; </span><span style="color: #E06C75">i</span><span style="color: #56B6C2">++</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">item</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> { ...</span><span style="color: #E06C75">data</span><span style="color: #ABB2BF">[</span><span style="color: #E06C75">i</span><span style="color: #ABB2BF">] };</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #C678DD">try</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">          </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">textObj</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">JSON</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">parse</span><span style="color: #ABB2BF">(</span><span style="color: #E5C07B">item</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">text</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">          </span><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #E5C07B">textObj</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">root</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">&#x26;&#x26;</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">textObj</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">root</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">children</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">&#x26;&#x26;</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">textObj</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">root</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">children</span><span style="color: #ABB2BF">[</span><span style="color: #D19A66">0</span><span style="color: #ABB2BF">] </span><span style="color: #56B6C2">&#x26;&#x26;</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">textObj</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">root</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">children</span><span style="color: #ABB2BF">[</span><span style="color: #D19A66">0</span><span style="color: #ABB2BF">].</span><span style="color: #E06C75">children</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">            </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">textValue</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">textObj</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">root</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">children</span><span style="color: #ABB2BF">[</span><span style="color: #D19A66">0</span><span style="color: #ABB2BF">].</span><span style="color: #E06C75">children</span><span style="color: #ABB2BF">[</span><span style="color: #D19A66">0</span><span style="color: #ABB2BF">].</span><span style="color: #E06C75">text</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">            </span><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75">textValue</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">===</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">newArray</span><span style="color: #ABB2BF">[</span><span style="color: #E06C75">i</span><span style="color: #ABB2BF">]) {</span></span>
<span class="line"><span style="color: #ABB2BF">              </span><span style="color: #E5C07B">item</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">text</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">newArray</span><span style="color: #ABB2BF">[</span><span style="color: #E06C75">i</span><span style="color: #ABB2BF">];</span></span>
<span class="line"><span style="color: #ABB2BF">            }</span></span>
<span class="line"><span style="color: #ABB2BF">          }</span></span>
<span class="line"><span style="color: #ABB2BF">        } </span><span style="color: #C678DD">catch</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75">error</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">          </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">error</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">"Error parsing JSON:"</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">error</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">        }</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #E5C07B">replacedData</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">push</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">item</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">      }</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">newCreatedAt</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">replacedData</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">map</span><span style="color: #ABB2BF">((</span><span style="color: #E06C75; font-style: italic">item</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">any</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">          </span><span style="color: #E06C75">id</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">item</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">id</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">          </span><span style="color: #E06C75">text</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">item</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">text</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">          </span><span style="color: #E06C75">created_at</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">item</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">created_at</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">split</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'T'</span><span style="color: #ABB2BF">)[</span><span style="color: #D19A66">0</span><span style="color: #ABB2BF">] </span><span style="color: #7F848E; font-style: italic">// æ—¥ä»˜éƒ¨åˆ†ã ã‘ã‚’å–å¾—</span></span>
<span class="line"><span style="color: #ABB2BF">        };</span></span>
<span class="line"><span style="color: #ABB2BF">      });</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #E5C07B">newCreatedAt</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">sort</span><span style="color: #ABB2BF">((</span><span style="color: #E06C75; font-style: italic">a</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">any</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">b</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">any</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">b</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">id</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">-</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">a</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">id</span><span style="color: #ABB2BF">); </span><span style="color: #7F848E; font-style: italic">//æ—¥ä»˜ã‚’é™é †ã«ãªã‚‰ã¹æ›¿ãˆ</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #61AFEF">setText</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">newCreatedAt</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">    }</span></span></code></pre>
<h4 id="å®Ÿéš›ã«ç”»é¢ã®è¡¨ç¤º">å®Ÿéš›ã«ç”»é¢ã®è¡¨ç¤º</h4>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #7F848E; font-style: italic">//ãƒ†ã‚­ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ãŒnullã®å ´åˆã«è¡¨ç¤º</span></span>
<span class="line"><span style="color: #ABB2BF"> {</span><span style="color: #E5C07B">text</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">length</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">&#x3C;=</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">0</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">&#x26;&#x26;</span><span style="color: #ABB2BF"> &#x3C;</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">className</span><span style="color: #56B6C2">=</span><span style="color: #98C379">"text-lg"</span><span style="color: #ABB2BF">>Make a post now!&#x3C;/</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">>}</span></span>
<span class="line"><span style="color: #ABB2BF"> </span></span>
<span class="line"><span style="color: #ABB2BF"> </span><span style="color: #7F848E; font-style: italic">// apiã®å‡¦ç†ä¸­ã¯loadingã‚’è¡¨ç¤º</span></span>
<span class="line"><span style="color: #ABB2BF">  {</span><span style="color: #56B6C2">!</span><span style="color: #E06C75">loading</span></span>
<span class="line"><span style="color: #ABB2BF">          </span><span style="color: #C678DD">?</span></span>
<span class="line"><span style="color: #ABB2BF">	  </span><span style="color: #7F848E; font-style: italic">//...</span></span>
<span class="line"><span style="color: #ABB2BF">	  </span><span style="color: #C678DD">:</span></span>
<span class="line"><span style="color: #ABB2BF">	  &#x3C;</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">>loading.....&#x3C;/</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">        }</span></span></code></pre>
<h3 id="ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒ‡ã‚£ã‚¿ãŒç”»é¢ã«è¡¨ç¤ºã—ã¦ã„ã‚‹ã‚¹ãƒ†ãƒ¼ãƒˆã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹">ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒ‡ã‚£ã‚¿ãŒç”»é¢ã«è¡¨ç¤ºã—ã¦ã„ã‚‹ã‚¹ãƒ†ãƒ¼ãƒˆã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹</h3>
<p>ãƒˆã‚°ãƒ«ãƒœã‚¿ãƒ³ã‚’è¨­ç½®ã—ã¦ã‚¨ãƒ‡ã‚£ã‚¿ã®è¡¨ç¤ºãƒ»éè¡¨ç¤ºã‚’ä½œã‚‹
:::message
ã‚¨ãƒ‡ã‚£ã‚¿ã‚’ãƒˆã‚°ãƒ«ã•ã›ã‚‹ã ã‘ã§ã¯ã‚¹ãƒ†ãƒ¼ãƒˆã¯æ›´æ–°ã•ã‚Œã¾ã›ã‚“ã€‚
useRefreshã‚’ã†ã¾ãä½¿ã„ã‚¹ãƒ†ãƒ¼ãƒˆã‚’æ›´æ–°ã•ã›ã¾ã™</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #ABB2BF">{</span><span style="color: #56B6C2">!</span><span style="color: #E06C75">refresh</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">?</span></span>
<span class="line"><span style="color: #ABB2BF">              &#x3C;></span></span>
<span class="line"><span style="color: #ABB2BF">                &#x3C;</span><span style="color: #E5C07B">Editor</span><span style="color: #ABB2BF"> /></span></span>
<span class="line"><span style="color: #ABB2BF">              &#x3C;/></span></span>
<span class="line"><span style="color: #ABB2BF">              </span><span style="color: #C678DD">:</span></span>
<span class="line"><span style="color: #ABB2BF">              &#x3C;</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">>&#x3C;/</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">            }</span></span></code></pre>
<p>:::</p>
<p>app/components/NoteItem/index.tsx</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #98C379">"use client"</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">useRefresh</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"@/app/hooks/useRefresh"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">useToggleEditor</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"@/app/hooks/useToggleEditor"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">MdKeyboardBackspace</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"react-icons/md"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">Editor</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"../Editor/text-editor"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">PostButton</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"../PostButton"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">Note</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"../Note"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">export</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">NoteItem</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> () </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> { </span><span style="color: #E5C07B">refresh</span><span style="color: #ABB2BF"> } </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">useRefresh</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> { </span><span style="color: #E5C07B">isOpen</span><span style="color: #ABB2BF">, </span><span style="color: #E5C07B">onClose</span><span style="color: #ABB2BF">, </span><span style="color: #E5C07B">onOpen</span><span style="color: #ABB2BF"> } </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">useToggleEditor</span><span style="color: #ABB2BF">()</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> (</span></span>
<span class="line"><span style="color: #ABB2BF">    &#x3C;></span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #C678DD">{</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #E06C75">isOpen</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">?</span></span>
<span class="line"><span style="color: #ABB2BF">          &#x3C;</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">className</span><span style="color: #56B6C2">=</span><span style="color: #98C379">"max-w-3xl mx-auto"</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">            &#x3C; </span><span style="color: #E06C75">div</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">className</span><span style="color: #56B6C2">=</span><span style="color: #98C379">"flex justify-start ml-4"</span><span style="color: #ABB2BF"> ></span></span>
<span class="line"><span style="color: #ABB2BF">              &#x3C;</span><span style="color: #E06C75">button</span></span>
<span class="line"><span style="color: #ABB2BF">                </span><span style="color: #D19A66; font-style: italic">className</span><span style="color: #56B6C2">=</span><span style="color: #98C379">"border-none cursor-pointer bg-white hover:text-blue-400"</span></span>
<span class="line"><span style="color: #ABB2BF">                </span><span style="color: #D19A66; font-style: italic">onClick</span><span style="color: #56B6C2">=</span><span style="color: #C678DD">{</span><span style="color: #ABB2BF">() </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">onClose</span><span style="color: #ABB2BF">()</span><span style="color: #C678DD">}</span></span>
<span class="line"><span style="color: #ABB2BF">              ></span></span>
<span class="line"><span style="color: #ABB2BF">                &#x3C;</span><span style="color: #E5C07B">MdKeyboardBackspace</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">size</span><span style="color: #56B6C2">=</span><span style="color: #C678DD">{</span><span style="color: #D19A66">24</span><span style="color: #C678DD">}</span><span style="color: #ABB2BF"> /></span></span>
<span class="line"><span style="color: #ABB2BF">              &#x3C;/</span><span style="color: #E06C75">button</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">            &#x3C;/</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF"> ></span></span>
<span class="line"><span style="color: #ABB2BF">            </span><span style="color: #C678DD">{</span><span style="color: #56B6C2">!</span><span style="color: #E06C75">refresh</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">?</span></span>
<span class="line"><span style="color: #ABB2BF">              &#x3C;></span></span>
<span class="line"><span style="color: #ABB2BF">                &#x3C;</span><span style="color: #E5C07B">Editor</span><span style="color: #ABB2BF"> /></span></span>
<span class="line"><span style="color: #ABB2BF">              &#x3C;/></span></span>
<span class="line"><span style="color: #ABB2BF">              </span><span style="color: #C678DD">:</span></span>
<span class="line"><span style="color: #ABB2BF">              &#x3C;</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">>&#x3C;/</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">            </span><span style="color: #C678DD">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">          &#x3C;/</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF"> ></span></span>
<span class="line"><span style="color: #ABB2BF">          </span><span style="color: #C678DD">:</span></span>
<span class="line"><span style="color: #ABB2BF">          &#x3C;></span></span>
<span class="line"><span style="color: #ABB2BF">            &#x3C;</span><span style="color: #E5C07B">PostButton</span><span style="color: #ABB2BF"> /></span></span>
<span class="line"><span style="color: #ABB2BF">            &#x3C;</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">onClick</span><span style="color: #56B6C2">=</span><span style="color: #C678DD">{</span><span style="color: #ABB2BF">() </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">onOpen</span><span style="color: #ABB2BF">()</span><span style="color: #C678DD">}</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">              &#x3C;</span><span style="color: #E5C07B">Note</span><span style="color: #ABB2BF"> /></span></span>
<span class="line"><span style="color: #ABB2BF">            &#x3C;/</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">          &#x3C;/></span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #C678DD">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    &#x3C;/></span></span>
<span class="line"><span style="color: #ABB2BF">  )</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span></code></pre>
<h3 id="ãƒšãƒ¼ã‚¸ã«è¿½åŠ ">ãƒšãƒ¼ã‚¸ã«è¿½åŠ </h3>
<p>NoteItemã‚’ãƒãƒ¼ãƒˆãƒšãƒ¼ã‚¸ã«è¿½åŠ ã—ã¾ã™ã€‚</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">NoteItem</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"@/app/components/NoteItem/intex"</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">NotePage</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> () </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> (</span></span>
<span class="line"><span style="color: #ABB2BF">    &#x3C;</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">      &#x3C;</span><span style="color: #E5C07B">NoteItem</span><span style="color: #ABB2BF"> /></span></span>
<span class="line"><span style="color: #ABB2BF">    &#x3C;/</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">  )</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">export</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">default</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">NotePage</span></span></code></pre>
<h3 id="å‹•ä½œç¢ºèª">å‹•ä½œç¢ºèª</h3>
<p>å³ä¸Šã®+ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨ã€ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãŒèµ°ã‚Šæ–°ã—ã„Postã‚’ãƒ•ã‚§ãƒƒãƒã—ã¾ã™ã€‚
ãƒˆã‚°ãƒ«ãƒœã‚¿ãƒ³ã§ã‚¨ãƒ‡ã‚£ã‚¿ã®è¡¨ç¤ºã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹ã“ã¨ãŒã§ãã¦ã„ã‚‹ã¨æ€ã„ã¾ã™ã€‚
<img src="https://storage.googleapis.com/zenn-user-upload/273086b2bcf0-20230929.png" alt=""></p>
<br>
<br>
<p>##ã€€ã‚¨ãƒ‡ã‚£ã‚¿ã«ãƒ†ã‚­ã‚¹ãƒˆã‚’è¡¨ç¤ºã•ã›ã¦ã„ãã¾ã™ã€‚
app/components/editor/text-editor.tsx ã«ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ã—ã¦ã„ãã¾ã™</p>
<p>app/components/Editor/text-editor.tsx</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #98C379">'use client'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">useEffect</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">useState</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"react"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">useGetTextById</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"@/app/hooks/useGetTextById"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">useGetAllText</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"@/app/hooks/useGetAllText"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">export</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">Editor</span><span style="color: #ABB2BF">() {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #7F848E; font-style: italic">//è¿½åŠ </span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> [</span><span style="color: #E5C07B">text</span><span style="color: #ABB2BF">, </span><span style="color: #E5C07B">setText</span><span style="color: #ABB2BF">] </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">useState</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">''</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> [</span><span style="color: #E5C07B">emotion</span><span style="color: #ABB2BF">, </span><span style="color: #E5C07B">setEmotion</span><span style="color: #ABB2BF">] </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">useState</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">''</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">selectedId</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">useGetTextById</span><span style="color: #ABB2BF">((</span><span style="color: #E06C75; font-style: italic">state</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">state</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">selectedId</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> { </span><span style="color: #E5C07B">data</span><span style="color: #ABB2BF">, </span><span style="color: #E5C07B">fetch</span><span style="color: #ABB2BF"> }: </span><span style="color: #E5C07B">any</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">useGetAllText</span><span style="color: #ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">   </span><span style="color: #7F848E; font-style: italic">//è¿½åŠ </span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #61AFEF">useEffect</span><span style="color: #ABB2BF">(() </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #61AFEF">setText</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">""</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #61AFEF">setEmotion</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">''</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75">selectedId</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">!==</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">null</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">            </span><span style="color: #7F848E; font-style: italic">// dataé…åˆ—ã‹ã‚‰é¸æŠã•ã‚ŒãŸIDã«ä¸€è‡´ã™ã‚‹è¦ç´ ã‚’æ¢ã™</span></span>
<span class="line"><span style="color: #ABB2BF">            </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">selectedData</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">data</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">find</span><span style="color: #ABB2BF">((</span><span style="color: #E06C75; font-style: italic">item</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">any</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">item</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">id</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">===</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">selectedId</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">            </span><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75">selectedData</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">                </span><span style="color: #61AFEF">setText</span><span style="color: #ABB2BF">(</span><span style="color: #E5C07B">selectedData</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">text</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">                </span><span style="color: #61AFEF">setEmotion</span><span style="color: #ABB2BF">(</span><span style="color: #E5C07B">selectedData</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">emotion</span><span style="color: #ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">            } </span><span style="color: #C678DD">else</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">                </span><span style="color: #61AFEF">setText</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">""</span><span style="color: #ABB2BF">); </span><span style="color: #7F848E; font-style: italic">// ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã¯ç©ºã«è¨­å®š</span></span>
<span class="line"><span style="color: #ABB2BF">            }</span></span>
<span class="line"><span style="color: #ABB2BF">        } </span><span style="color: #C678DD">else</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">            </span><span style="color: #61AFEF">setText</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">""</span><span style="color: #ABB2BF">); </span><span style="color: #7F848E; font-style: italic">// selectedNaiseiIdãŒnullã®å ´åˆã‚‚ç©ºã«è¨­å®š</span></span>
<span class="line"><span style="color: #ABB2BF">        }</span></span>
<span class="line"><span style="color: #ABB2BF">    }, [</span><span style="color: #E06C75">selectedId</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">data</span><span style="color: #ABB2BF">])</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">editorConfig</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">	</span><span style="color: #E06C75">editorState</span><span style="color: #ABB2BF">: </span><span style="color: #E06C75">text</span><span style="color: #ABB2BF"> </span><span style="color: #7F848E; font-style: italic">//è¿½åŠ </span></span>
<span class="line"><span style="color: #ABB2BF">    };</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #56B6C2">!</span><span style="color: #E06C75">text</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> &#x3C;>&#x3C;/> </span><span style="color: #7F848E; font-style: italic">//è¿½åŠ </span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> (</span></span>
<span class="line"><span style="color: #ABB2BF">    {...}</span></span>
<span class="line"><span style="color: #ABB2BF">        );</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span>
<span class="line"></span></code></pre>
<h4 id="ã‚³ãƒ¼ãƒ‰ã®è§£èª¬-7">ã‚³ãƒ¼ãƒ‰ã®è§£èª¬</h4>
<p>useEffectå†…ã§ãƒ‡ãƒ¼ã‚¿ã‚’mapã—ã€useStateã§ã‚¹ãƒ†ãƒ¼ãƒˆã‚’ç®¡ç†ã—ã¾ã™ã€‚</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #7F848E; font-style: italic">// stateã‚’åˆæœŸåŒ–ã—ã¾ã™ã€‚åˆæœŸåŒ–ã—ãªã„ã¨å‰å›ã®ã‚¹ãƒ†ãƒ¼ãƒˆãŒæ®‹ã‚Šç”»é¢è¡¨ç¤ºãŒå¤‰ã‚ã‚Šã¾ã›ã‚“ã€‚</span></span>
<span class="line"><span style="color: #61AFEF">useEffect</span><span style="color: #ABB2BF">(() </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #61AFEF">setText</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">""</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #61AFEF">setEmotion</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">''</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">    }, [</span><span style="color: #E06C75">selectedId</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">data</span><span style="color: #ABB2BF">])</span></span></code></pre>
<p>ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚‹æ™‚ã«å‡¦ç†ã‚’å®Ÿè¡Œã€‚ãƒ‡ãƒ¼ã‚¿ãŒãªã„å ´åˆã¯ç©ºã‚’è¿”ã™ã‚ˆã†ã«ã—ã¾ã™ã€‚</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75">selectedId</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">!==</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">null</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">            </span><span style="color: #7F848E; font-style: italic">// dataé…åˆ—ã‹ã‚‰é¸æŠã•ã‚ŒãŸIDã«ä¸€è‡´ã™ã‚‹è¦ç´ ã‚’æ¢ã™</span></span>
<span class="line"><span style="color: #ABB2BF">            </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">selectedData</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">data</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">find</span><span style="color: #ABB2BF">((</span><span style="color: #E06C75; font-style: italic">item</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">any</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">item</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">id</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">===</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">selectedId</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">            </span><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75">selectedData</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">                </span><span style="color: #61AFEF">setText</span><span style="color: #ABB2BF">(</span><span style="color: #E5C07B">selectedData</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">text</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">                </span><span style="color: #61AFEF">setEmotion</span><span style="color: #ABB2BF">(</span><span style="color: #E5C07B">selectedData</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">emotion</span><span style="color: #ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">            } </span><span style="color: #C678DD">else</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">                </span><span style="color: #61AFEF">setText</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">""</span><span style="color: #ABB2BF">); </span><span style="color: #7F848E; font-style: italic">// ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã¯ç©ºã«è¨­å®š</span></span>
<span class="line"><span style="color: #ABB2BF">            }</span></span>
<span class="line"><span style="color: #ABB2BF">        } </span><span style="color: #C678DD">else</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">            </span><span style="color: #61AFEF">setText</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">""</span><span style="color: #ABB2BF">); </span><span style="color: #7F848E; font-style: italic">// selectedNaiseiIdãŒnullã®å ´åˆã‚‚ç©ºã«è¨­å®š</span></span>
<span class="line"><span style="color: #ABB2BF">        }</span></span></code></pre>
<p>Lexicalã®ã‚¨ãƒ‡ã‚£ã‚¿ã«ãƒ†ã‚­ã‚¹ãƒˆã‚’æ¸¡ã—ã¾ã™ã€‚
ãƒ†ã‚­ã‚¹ãƒˆãŒnullã®å ´åˆã«ã¯ä½•ã‚‚è¡¨ç¤ºã•ã›ã¾ã›ã‚“ã€‚->ã“ã®ã‚³ãƒ¼ãƒ‰æ›¸ã‹ãªã„ã¨undifindã¨ãªã‚Š Json.paese ã‚¨ãƒ©ãƒ¼ã«ãªã‚Šã¾ã™ã€‚</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #ABB2BF"> </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">editorConfig</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">	</span><span style="color: #E06C75">editorState</span><span style="color: #ABB2BF">: </span><span style="color: #E06C75">text</span><span style="color: #ABB2BF"> </span><span style="color: #7F848E; font-style: italic">//è¿½åŠ </span></span>
<span class="line"><span style="color: #ABB2BF">    };</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #56B6C2">!</span><span style="color: #E06C75">text</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> &#x3C;>&#x3C;/> </span><span style="color: #7F848E; font-style: italic">//è¿½åŠ </span></span></code></pre>
<p>ã“ã‚Œã§ã‚¨ãƒ‡ã‚£ã‚¿ã«ãƒ‡ãƒ¼ã‚¿ãŒå…¥ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚
<img src="https://storage.googleapis.com/zenn-user-upload/607a4e60e5c8-20230929.png" alt=""></p>
<br>
<br>
<h2 id="apiã‚’å©ã„ã¦ãƒ‡ãƒ¼ã‚¿ã®æ›´æ–°ã¨å‰Šé™¤ã®ãƒœã‚¿ãƒ³ã‚’ä½œã‚Šã¾ã™">APIã‚’å©ã„ã¦ãƒ‡ãƒ¼ã‚¿ã®æ›´æ–°ã¨å‰Šé™¤ã®ãƒœã‚¿ãƒ³ã‚’ä½œã‚Šã¾ã™ã€‚</h2>
<p>ä»Šå›ã¯ã€text-editor.tsxã«ãƒœã‚¿ãƒ³ã‚’ç›´æ¥æ›¸ã„ã¦ã„ãã¾ã™ã€‚</p>
<h2 id="ãƒ‡ãƒ¼ã‚¿ã®æ›´æ–°">ãƒ‡ãƒ¼ã‚¿ã®æ›´æ–°</h2>
<p>app/components/Editor/text-editor.tsx</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #7F848E; font-style: italic">//è¿½åŠ </span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">axios</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"axios"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">useGetTextById</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"@/app/hooks/useGetTextById"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">useGetAllText</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"@/app/hooks/useGetAllText"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">useToggleEditor</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"@/app/hooks/useToggleEditor"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">export</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">Editor</span><span style="color: #ABB2BF">() {</span></span>
<span class="line"><span style="color: #7F848E; font-style: italic">//è¿½åŠ </span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">selectedId</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">useGetTextById</span><span style="color: #ABB2BF">((</span><span style="color: #E06C75; font-style: italic">state</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">state</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">selectedId</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> { </span><span style="color: #E5C07B">data</span><span style="color: #ABB2BF">, </span><span style="color: #E5C07B">fetch</span><span style="color: #ABB2BF"> }: </span><span style="color: #E5C07B">any</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">useGetAllText</span><span style="color: #ABB2BF">()</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> { </span><span style="color: #E5C07B">onClose</span><span style="color: #ABB2BF"> } </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">useToggleEditor</span><span style="color: #ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="color: #61AFEF">useEffect</span><span style="color: #ABB2BF">({...})</span></span>
<span class="line"><span style="color: #7F848E; font-style: italic">//è¿½åŠ </span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">handleUpdate</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75; font-style: italic">e</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">SyntheticEvent</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #E5C07B">e</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">preventDefault</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #61AFEF">onClose</span><span style="color: #ABB2BF">()</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #61AFEF">setText</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">""</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">apiUrl</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">`/api/analysis/</span><span style="color: #C678DD">${</span><span style="color: #E06C75">selectedId</span><span style="color: #C678DD">}</span><span style="color: #98C379">`</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">updatedData</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">            </span><span style="color: #7F848E; font-style: italic">// ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£ã«é€ä¿¡ã™ã‚‹ãƒ‡ãƒ¼ã‚¿</span></span>
<span class="line"><span style="color: #ABB2BF">            </span><span style="color: #E06C75">text</span><span style="color: #ABB2BF">: </span><span style="color: #E06C75">text</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">        };</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #E5C07B">axios</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">put</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">apiUrl</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">updatedData</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">            .</span><span style="color: #61AFEF">then</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">response</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">                </span><span style="color: #E5C07B">toast</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">success</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'Updated!!!!'</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">                </span><span style="color: #61AFEF">fetch</span><span style="color: #ABB2BF">()</span></span>
<span class="line"><span style="color: #ABB2BF">                </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">response</span></span>
<span class="line"><span style="color: #ABB2BF">            })</span></span>
<span class="line"><span style="color: #ABB2BF">            .</span><span style="color: #61AFEF">catch</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">error</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">                </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">error</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'Error fetching data:'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">error</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">            });</span></span>
<span class="line"><span style="color: #ABB2BF">    }</span></span>
<span class="line"><span style="color: #C678DD">return</span><span style="color: #ABB2BF">(</span></span>
<span class="line"><span style="color: #ABB2BF">{</span><span style="color: #7F848E; font-style: italic">/* ... */</span><span style="color: #ABB2BF">}</span></span>
<span class="line"><span style="color: #ABB2BF">    &#x3C;</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">className</span><span style="color: #56B6C2">=</span><span style="color: #98C379">"flex justify-end"</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">{</span><span style="color: #7F848E; font-style: italic">/* è¿½åŠ  */</span><span style="color: #C678DD">}</span></span>
<span class="line"><span style="color: #ABB2BF">	&#x3C;</span><span style="color: #E06C75">button</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">className</span><span style="color: #56B6C2">=</span><span style="color: #98C379">'mx-4 mb-2 mt-2 text-md cursor-pointer rounded-lg border-none px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white'</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">onClick</span><span style="color: #56B6C2">=</span><span style="color: #C678DD">{</span><span style="color: #E06C75">handleUpdate</span><span style="color: #C678DD">}</span><span style="color: #ABB2BF">>Update&#x3C;/</span><span style="color: #E06C75">button</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">	&#x3C;</span><span style="color: #E5C07B">GenarateButton</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">textData</span><span style="color: #56B6C2">=</span><span style="color: #C678DD">{</span><span style="color: #E06C75">textData</span><span style="color: #C678DD">}</span><span style="color: #ABB2BF"> /></span></span>
<span class="line"><span style="color: #ABB2BF">    &#x3C;/</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">{</span><span style="color: #7F848E; font-style: italic">/* ... */</span><span style="color: #ABB2BF">}</span></span>
<span class="line"><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span></code></pre>
<p>ã€€#### ã‚³ãƒ¼ãƒ‰ã®è§£èª¬
ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨handleUpdateé–¢æ•°ãŒå®Ÿè¡Œã•ã‚Œã¾ã™ã€‚
ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆå¾Œã¯ä¸€è¦§ç”»é¢ã«æˆ»ã‚ŠãŸã„ã®ã§ã‚¨ãƒ‡ã‚£ã‚¿ã‚’é–‰ã˜ã¾ã™ã€‚
apiã‚’å‘¼ã³å‡ºã—ã€ãƒ†ã‚­ã‚¹ãƒˆã®æ›´æ–°ã‚’ã—ã¾ã™ã€‚</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #61AFEF">onClose</span><span style="color: #ABB2BF">()ã€€</span><span style="color: #7F848E; font-style: italic">//é–‹ã„ã¦ã„ã‚‹ã‚¨ãƒ‡ã‚£ã‚¿ã‚’é–‰ã˜ã‚‹</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">//æ›´æ–°ã™ã‚‹ãƒ†ã‚­ã‚¹ãƒˆ(useStateã®å€¤)ã‚’axiosã‚’ä½¿ã„ã€apiã‚’å‘¼ã³å‡ºã—ã¾ã™ã€‚</span></span>
<span class="line"><span style="color: #ABB2BF"> </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">updatedData</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">           </span><span style="color: #7F848E; font-style: italic">// ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£ã«é€ä¿¡ã™ã‚‹ãƒ‡ãƒ¼ã‚¿</span></span>
<span class="line"><span style="color: #ABB2BF">           </span><span style="color: #E06C75">text</span><span style="color: #ABB2BF">: </span><span style="color: #E06C75">text</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">       };</span></span>
<span class="line"><span style="color: #ABB2BF">       </span><span style="color: #E5C07B">axios</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">put</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">apiUrl</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">updatedData</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">           .</span><span style="color: #61AFEF">then</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">response</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">               </span><span style="color: #E5C07B">toast</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">success</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'Updated!!!!'</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">               </span><span style="color: #61AFEF">fetch</span><span style="color: #ABB2BF">()</span></span>
<span class="line"><span style="color: #ABB2BF">               </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">response</span></span>
<span class="line"><span style="color: #ABB2BF">           })</span></span>
<span class="line"><span style="color: #ABB2BF">           .</span><span style="color: #61AFEF">catch</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">error</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">               </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">error</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'Error fetching data:'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">error</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">           });</span></span></code></pre>
<p>ã“ã‚Œã§ä»¥ä¸‹ã®ã‚ˆã†ã«æ›´æ–°ã—ãŸãƒ‡ãƒ¼ã‚¿ãŒè¡¨ç¤ºã•ã‚Œã‚Œã°OKã§ã™ã€‚
<img src="https://storage.googleapis.com/zenn-user-upload/c75d92541b2a-20230929.png" alt="">
<img src="https://storage.googleapis.com/zenn-user-upload/7ecd0f3ddff0-20230929.png" alt=""></p>
<h2 id="ãƒ‡ãƒ¼ã‚¿ã®å‰Šé™¤">ãƒ‡ãƒ¼ã‚¿ã®å‰Šé™¤</h2>
<p>axios.deleteã¨ã™ã‚‹ã“ã¨ã§ãƒ‡ãƒ¼ã‚¿ã®å‰Šé™¤ãŒã§ãã¾ã™ã€‚
app/components/Editor/text-editor.tsx</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">export</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">Editor</span><span style="color: #ABB2BF">() {</span></span>
<span class="line"><span style="color: #61AFEF">useEffect</span><span style="color: #ABB2BF">({...})</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">//è¿½åŠ </span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">handleDelete</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75; font-style: italic">e</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">SyntheticEvent</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #E5C07B">e</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">preventDefault</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #61AFEF">onClose</span><span style="color: #ABB2BF">()</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">apiUrl</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">`/api/analysis/</span><span style="color: #C678DD">${</span><span style="color: #E06C75">selectedId</span><span style="color: #C678DD">}</span><span style="color: #98C379">`</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #E5C07B">axios</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">delete</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">apiUrl</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">            .</span><span style="color: #61AFEF">then</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">response</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">                </span><span style="color: #61AFEF">fetch</span><span style="color: #ABB2BF">()</span></span>
<span class="line"><span style="color: #ABB2BF">                </span><span style="color: #C678DD">return</span></span>
<span class="line"><span style="color: #ABB2BF">            })</span></span>
<span class="line"><span style="color: #ABB2BF">            .</span><span style="color: #61AFEF">catch</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">error</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">                </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">error</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'Error fetching data:'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">error</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">            });</span></span>
<span class="line"><span style="color: #ABB2BF">    }</span></span>
<span class="line"><span style="color: #C678DD">return</span><span style="color: #ABB2BF">(</span></span>
<span class="line"><span style="color: #ABB2BF">{</span><span style="color: #7F848E; font-style: italic">/* ... */</span><span style="color: #ABB2BF">}</span></span>
<span class="line"><span style="color: #ABB2BF">    &#x3C;</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">className</span><span style="color: #56B6C2">=</span><span style="color: #98C379">"flex justify-end"</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">{</span><span style="color: #7F848E; font-style: italic">/* è¿½åŠ  */</span><span style="color: #C678DD">}</span></span>
<span class="line"><span style="color: #ABB2BF">&#x3C;</span><span style="color: #E06C75">button</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">className</span><span style="color: #56B6C2">=</span><span style="color: #98C379">'mx-4 mb-2 mt-2 text-md cursor-pointer rounded-lg border-none px-4 py-2 bg-red-600 hover:bg-red-700 text-white'</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">onClick</span><span style="color: #56B6C2">=</span><span style="color: #C678DD">{</span><span style="color: #E06C75">handleDelete</span><span style="color: #C678DD">}</span><span style="color: #ABB2BF">>Delete&#x3C;/</span><span style="color: #E06C75">button</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">	&#x3C;</span><span style="color: #E5C07B">GenarateButton</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66; font-style: italic">textData</span><span style="color: #56B6C2">=</span><span style="color: #C678DD">{</span><span style="color: #E06C75">textData</span><span style="color: #C678DD">}</span><span style="color: #ABB2BF"> /></span></span>
<span class="line"><span style="color: #ABB2BF">    &#x3C;/</span><span style="color: #E06C75">div</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">{</span><span style="color: #7F848E; font-style: italic">/* ... */</span><span style="color: #ABB2BF">}</span></span>
<span class="line"><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span></code></pre>
<p>å…ˆã»ã©æ›´æ–°ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã—ã¾ã™ã€‚
<img src="https://storage.googleapis.com/zenn-user-upload/d7d1af9beee0-20230929.png" alt=""></p>
<p>ã“ã‚Œã§ã‚¨ãƒ‡ã‚£ã‚¿æ©Ÿèƒ½ã®ä½œæˆã¯çµ‚äº†ã§ã™ã€‚</p>
<br>
<br>
<h2 id="emotionã‚’æ›´æ–°">Emotionã‚’æ›´æ–°</h2>
<p>æ„Ÿæƒ…åˆ†æã¯GenarateButtonã§ã—ã¦ã„ã¾ã™ã®ã§ã€ã“ã‚Œã«APIã®PUTãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¿½åŠ ã—ã¦ã„ãã¾ã™ã€‚
app/components/GenarateButton/index.tsx</p>
<pre class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #98C379">"use client"</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">//è¿½åŠ </span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">axios</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"axios"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">useGetTextById</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"@/app/hooks/useGetTextById"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">export</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">GenarateButton</span><span style="color: #ABB2BF">({</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75; font-style: italic">textData</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">}: {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">textData</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span></span>
<span class="line"><span style="color: #ABB2BF">}) {</span></span>
<span class="line"><span style="color: #7F848E; font-style: italic">//è¿½åŠ </span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">selectedId</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">useGetTextById</span><span style="color: #ABB2BF">((</span><span style="color: #E06C75; font-style: italic">state</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">state</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">selectedId</span><span style="color: #ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">handleSubmit</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75; font-style: italic">e</span><span style="color: #ABB2BF">: { </span><span style="color: #61AFEF">preventDefault</span><span style="color: #ABB2BF">: () </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">void</span><span style="color: #ABB2BF"> }) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  ...</span></span>
<span class="line"><span style="color: #ABB2BF">    }) : [];</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">//è¿½åŠ </span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">apiUrl</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">`/api/openai/</span><span style="color: #C678DD">${</span><span style="color: #E06C75">selectedId</span><span style="color: #C678DD">}</span><span style="color: #98C379">`</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">updatedData</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #E06C75">emotion</span><span style="color: #ABB2BF">: </span><span style="color: #E06C75">filterData</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">    };</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E5C07B">axios</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">put</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">apiUrl</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">updatedData</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">      .</span><span style="color: #61AFEF">then</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">response</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #E5C07B">toast</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">success</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'Generated!!!!'</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #7F848E; font-style: italic">// fetchIsNaisei()</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">response</span></span>
<span class="line"><span style="color: #ABB2BF">      })</span></span>
<span class="line"><span style="color: #ABB2BF">      .</span><span style="color: #61AFEF">catch</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">error</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">error</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'Error fetching data:'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">error</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">      });</span></span>
<span class="line"><span style="color: #ABB2BF">  };</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> (</span></span>
<span class="line"><span style="color: #ABB2BF">    &#x3C;></span></span>
<span class="line"><span style="color: #ABB2BF">      &#x3C;</span><span style="color: #E06C75">button</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #D19A66; font-style: italic">onClick</span><span style="color: #56B6C2">=</span><span style="color: #C678DD">{</span><span style="color: #E06C75">handleSubmit</span><span style="color: #C678DD">}</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #D19A66; font-style: italic">className</span><span style="color: #56B6C2">=</span><span style="color: #98C379">"mx-4 mb-2 mt-2 text-md cursor-pointer rounded-lg border-none px-4 py-2 bg-lime-600 hover:bg-lime-700 text-white"</span></span>
<span class="line"><span style="color: #ABB2BF">      ></span></span>
<span class="line"><span style="color: #ABB2BF">        Generate</span></span>
<span class="line"><span style="color: #ABB2BF">      &#x3C;/</span><span style="color: #E06C75">button</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #C678DD">{</span><span style="color: #7F848E; font-style: italic">/* å‰Šé™¤ */</span><span style="color: #C678DD">}</span></span>
<span class="line"><span style="color: #C678DD">{</span><span style="color: #7F848E; font-style: italic">/* &#x3C;div className="text-2xl">{generateData}&#x3C;/div> */</span><span style="color: #C678DD">}</span></span>
<span class="line"><span style="color: #ABB2BF">    &#x3C;/ ></span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  )</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span></code></pre>
<p>ã“ã‚Œã§emotionã®æ›´æ–°ãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚ãƒ‡ãƒ¼ã‚¿ãŒä¿å­˜ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã—ã¾ã™ã€‚
<img src="https://storage.googleapis.com/zenn-user-upload/c020c2f63766-20230929.png" alt="">
ã“ã‚Œã‚’Generateã—ã¾ã™ã€‚
<img src="https://storage.googleapis.com/zenn-user-upload/da53b0ea90eb-20230929.png" alt="">
Supabaseã®emotionã‚«ãƒ©ãƒ ã«ãƒ‡ãƒ¼ã‚¿ãŒå…¥ã£ã¦ã„ã¾ã™ã€‚</p>
<br>
<br></article><ul class="tags-container astro-vj4tpspi"><li class="inline-block my-1 underline-offset-4 astro-blwjyjpt"><a href="/tags/nextjs" class="text-sm pr-2 group astro-blwjyjpt" data-astro-transition-scope="astro-36ssibgs-2"><svg xmlns="http://www.w3.org/2000/svg" class=" scale-75 astro-blwjyjpt"><path d="M16.018 3.815 15.232 8h-4.966l.716-3.815-1.964-.37L8.232 8H4v2h3.857l-.751 4H3v2h3.731l-.714 3.805 1.965.369L8.766 16h4.966l-.714 3.805 1.965.369.783-4.174H20v-2h-3.859l.751-4H21V8h-3.733l.716-3.815-1.965-.37zM14.106 14H9.141l.751-4h4.966l-.752 4z" class="astro-blwjyjpt"></path></svg>
&nbsp;<span class="astro-blwjyjpt">nextjs</span></a></li><li class="inline-block my-1 underline-offset-4 astro-blwjyjpt"><a href="/tags/openai" class="text-sm pr-2 group astro-blwjyjpt" data-astro-transition-scope="astro-36ssibgs-3"><svg xmlns="http://www.w3.org/2000/svg" class=" scale-75 astro-blwjyjpt"><path d="M16.018 3.815 15.232 8h-4.966l.716-3.815-1.964-.37L8.232 8H4v2h3.857l-.751 4H3v2h3.731l-.714 3.805 1.965.369L8.766 16h4.966l-.714 3.805 1.965.369.783-4.174H20v-2h-3.859l.751-4H21V8h-3.733l.716-3.815-1.965-.37zM14.106 14H9.141l.751-4h4.966l-.752 4z" class="astro-blwjyjpt"></path></svg>
&nbsp;<span class="astro-blwjyjpt">openai</span></a></li><li class="inline-block my-1 underline-offset-4 astro-blwjyjpt"><a href="/tags/prisma" class="text-sm pr-2 group astro-blwjyjpt" data-astro-transition-scope="astro-36ssibgs-4"><svg xmlns="http://www.w3.org/2000/svg" class=" scale-75 astro-blwjyjpt"><path d="M16.018 3.815 15.232 8h-4.966l.716-3.815-1.964-.37L8.232 8H4v2h3.857l-.751 4H3v2h3.731l-.714 3.805 1.965.369L8.766 16h4.966l-.714 3.805 1.965.369.783-4.174H20v-2h-3.859l.751-4H21V8h-3.733l.716-3.815-1.965-.37zM14.106 14H9.141l.751-4h4.966l-.752 4z" class="astro-blwjyjpt"></path></svg>
&nbsp;<span class="astro-blwjyjpt">prisma</span></a></li><li class="inline-block my-1 underline-offset-4 astro-blwjyjpt"><a href="/tags/supabase" class="text-sm pr-2 group astro-blwjyjpt" data-astro-transition-scope="astro-36ssibgs-5"><svg xmlns="http://www.w3.org/2000/svg" class=" scale-75 astro-blwjyjpt"><path d="M16.018 3.815 15.232 8h-4.966l.716-3.815-1.964-.37L8.232 8H4v2h3.857l-.751 4H3v2h3.731l-.714 3.805 1.965.369L8.766 16h4.966l-.714 3.805 1.965.369.783-4.174H20v-2h-3.859l.751-4H21V8h-3.733l.716-3.815-1.965-.37zM14.106 14H9.141l.751-4h4.966l-.752 4z" class="astro-blwjyjpt"></path></svg>
&nbsp;<span class="astro-blwjyjpt">supabase</span></a></li><li class="inline-block my-1 underline-offset-4 astro-blwjyjpt"><a href="/tags/clerk" class="text-sm pr-2 group astro-blwjyjpt" data-astro-transition-scope="astro-36ssibgs-6"><svg xmlns="http://www.w3.org/2000/svg" class=" scale-75 astro-blwjyjpt"><path d="M16.018 3.815 15.232 8h-4.966l.716-3.815-1.964-.37L8.232 8H4v2h3.857l-.751 4H3v2h3.731l-.714 3.805 1.965.369L8.766 16h4.966l-.714 3.805 1.965.369.783-4.174H20v-2h-3.859l.751-4H21V8h-3.733l.716-3.815-1.965-.37zM14.106 14H9.141l.751-4h4.966l-.752 4z" class="astro-blwjyjpt"></path></svg>
&nbsp;<span class="astro-blwjyjpt">clerk</span></a></li></ul></main><footer class="mt-auto astro-sz7xmlte"><div class="max-w-3xl mx-auto px-0"><hr class="border-skin-line" aria-hidden="true"></div><div class="footer-wrapper astro-sz7xmlte"><a href="/contact" tabindex="0" class="group inline-block undefined astro-5eunqzkt">
ãŠå•ã„åˆã‚ã›
</a><a href="/privacy" tabindex="0" class="group inline-block  astro-sz7xmlte astro-5eunqzkt">ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼</a></div><div class="footer-wrapper astro-sz7xmlte"><div class="social-icons flex astro-upu6fzxr"><a href="https://github.com/ryotarofr" tabindex="0" class="group inline-block link-button astro-upu6fzxr astro-5eunqzkt" title=" ã‚«ãƒ—ã‚³ãƒ¼ãƒ‰ on Github"><svg
    xmlns="http://www.w3.org/2000/svg"
    class="icon-tabler"
    stroke-linecap="round"
    stroke-linejoin="round"
  >
    <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
    <path
      d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5"
    ></path>
  </svg></a><a href="https://www.instagram.com/" tabindex="0" class="group inline-block link-button astro-upu6fzxr astro-5eunqzkt" title="ã‚«ãƒ—ã‚³ãƒ¼ãƒ‰ on Instagram"><svg
    xmlns="http://www.w3.org/2000/svg"
    class="icon-tabler"
    stroke-linecap="round"
    stroke-linejoin="round"
  >
    <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
    <rect x="4" y="4" width="16" height="16" rx="4"></rect>
    <circle cx="12" cy="12" r="3"></circle>
    <line x1="16.5" y1="7.5" x2="16.5" y2="7.501"></line>
  </svg></a></div><div class="copyright-wrapper astro-sz7xmlte"><span class="astro-sz7xmlte">Copyright &#169; 2023</span><span class="separator astro-sz7xmlte">&nbsp;|&nbsp;</span><span class="astro-sz7xmlte">All rights reserved.</span></div></div></footer><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5112185578414045" crossorigin="anonymous"></script><!-- footer --><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-5112185578414045" data-ad-slot="9364325523" data-ad-format="auto" data-full-width-responsive="true"></ins></body></html>